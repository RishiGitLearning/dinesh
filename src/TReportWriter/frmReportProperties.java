/*
 * frmTextProperties.java
 *
 * Created on July 10, 2007, 3:44 PM
 */

package TReportWriter;

/**
 *
 * @author  root
 */
import javax.swing.*;
import java.awt.*;
import TReportWriter.*;
import java.util.*;


public class frmReportProperties extends javax.swing.JApplet {

    public TReport objTReport;
    public boolean cancelled=false;
    
    private JDialog aDialog;
    
    public frmReportProperties()
    {
        setSize(424,320);
        initComponents();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        opgAlignments = new javax.swing.ButtonGroup();
        cmdOK = new javax.swing.JButton();
        cmdCancel = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        txtWidth = new javax.swing.JTextField();
        txtHeight = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        txtTop = new javax.swing.JTextField();
        txtLeft = new javax.swing.JTextField();
        txtRight = new javax.swing.JTextField();
        txtBottom = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        cmdOK.setText("OK");
        cmdOK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdOKActionPerformed(evt);
            }
        });

        getContentPane().add(cmdOK);
        cmdOK.setBounds(319, 14, 88, 25);

        cmdCancel.setText("Cancel");
        cmdCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdCancelActionPerformed(evt);
            }
        });

        getContentPane().add(cmdCancel);
        cmdCancel.setBounds(319, 47, 88, 25);

        jPanel1.setLayout(null);

        jPanel1.setBorder(new javax.swing.border.EtchedBorder());
        jLabel7.setText("Paper Size (Text Columns)");
        jPanel1.add(jLabel7);
        jLabel7.setBounds(13, 14, 180, 15);

        jLabel1.setText("Width");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(26, 52, 36, 15);

        jPanel1.add(txtWidth);
        txtWidth.setBounds(75, 50, 70, 19);

        jPanel1.add(txtHeight);
        txtHeight.setBounds(76, 76, 70, 19);

        jLabel2.setText("Height");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(25, 78, 50, 15);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(8, 11, 300, 110);

        jPanel3.setLayout(null);

        jPanel3.setBorder(new javax.swing.border.EtchedBorder());
        jLabel3.setText("Report Margins");
        jPanel3.add(jLabel3);
        jLabel3.setBounds(7, 4, 110, 15);

        jPanel3.add(txtTop);
        txtTop.setBounds(111, 40, 50, 19);

        jPanel3.add(txtLeft);
        txtLeft.setBounds(52, 71, 50, 19);

        jPanel3.add(txtRight);
        txtRight.setBounds(170, 71, 50, 19);

        jPanel3.add(txtBottom);
        txtBottom.setBounds(111, 102, 50, 19);

        jLabel4.setText("Left");
        jPanel3.add(jLabel4);
        jLabel4.setBounds(8, 72, 30, 15);

        jLabel5.setText("Top");
        jPanel3.add(jLabel5);
        jLabel5.setBounds(113, 23, 30, 15);

        jLabel6.setText("Right");
        jPanel3.add(jLabel6);
        jLabel6.setBounds(226, 73, 50, 15);

        jLabel8.setText("Bottom");
        jPanel3.add(jLabel8);
        jLabel8.setBounds(112, 125, 50, 15);

        getContentPane().add(jPanel3);
        jPanel3.setBounds(8, 125, 300, 150);

    }//GEN-END:initComponents

    private void cmdCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdCancelActionPerformed
        // TODO add your handling code here:
        cancelled=true;
        aDialog.dispose();
    }//GEN-LAST:event_cmdCancelActionPerformed

    private void cmdOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdOKActionPerformed
        // TODO add your handling code here:
        try {
            
            objTReport.objReportPage.PageHeight=Integer.parseInt(txtHeight.getText());
            objTReport.objReportPage.PageWidth=Integer.parseInt(txtWidth.getText());
            objTReport.objReportPage.TopMargin=Integer.parseInt(txtTop.getText());
            objTReport.objReportPage.LeftMargin=Integer.parseInt(txtLeft.getText());
            objTReport.objReportPage.RightMargin=Integer.parseInt(txtRight.getText());
            objTReport.objReportPage.BottomMargin=Integer.parseInt(txtBottom.getText());
            
            cancelled=false;
            aDialog.dispose();
        }
        catch(Exception e) {
            
        }
        
    }//GEN-LAST:event_cmdOKActionPerformed

    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
        
    }//GEN-LAST:event_formMouseClicked
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cmdCancel;
    private javax.swing.JButton cmdOK;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel3;
    private javax.swing.ButtonGroup opgAlignments;
    private javax.swing.JTextField txtBottom;
    private javax.swing.JTextField txtHeight;
    private javax.swing.JTextField txtLeft;
    private javax.swing.JTextField txtRight;
    private javax.swing.JTextField txtTop;
    private javax.swing.JTextField txtWidth;
    // End of variables declaration//GEN-END:variables


    private Frame findParentFrame(JApplet pApplet) {
        Container c = (Container) pApplet;
        while(c != null){
            if (c instanceof Frame)
                return (Frame)c;
            
            c = c.getParent();
        }
        return (Frame)null;
    }
    
    
    public void ShowDialog() {
        setSize(424,320);
        
        LoadProperties();
        
        Frame f=findParentFrame(this);
        
        aDialog=new JDialog(f,"Page Properties",true);
        
        aDialog.getContentPane().add("Center",this);
        Dimension appletSize = this.getSize();
        aDialog.setSize(appletSize);
        aDialog.setResizable(false);
        
        //Place it to center of the screen
        Dimension screenSize=Toolkit.getDefaultToolkit().getScreenSize();
        aDialog.setLocation((int)(screenSize.getWidth()-appletSize.getWidth())/2,(int)(screenSize.getHeight()-appletSize.getHeight())/2);
        
        aDialog.setDefaultCloseOperation(javax.swing.JDialog.DISPOSE_ON_CLOSE);
        aDialog.show();
    }

    private void LoadProperties() {
        try {
            
            txtHeight.setText(Integer.toString(objTReport.objReportPage.PageHeight));
            txtWidth.setText(Integer.toString(objTReport.objReportPage.PageWidth));
            
            txtTop.setText(Integer.toString(objTReport.objReportPage.TopMargin));
            txtLeft.setText(Integer.toString(objTReport.objReportPage.LeftMargin));
            txtRight.setText(Integer.toString(objTReport.objReportPage.RightMargin));
            txtBottom.setText(Integer.toString(objTReport.objReportPage.BottomMargin));
            
        }
        catch(Exception e) {
            
        }
    }
    
}
