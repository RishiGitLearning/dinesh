/*
 * frmEditBands.java
 *
 * Created on July 10, 2007, 1:17 PM
 */

package TReportWriter;

/**
 *
 * @author  root
 */
import javax.swing.*;
import java.awt.*;
import TReportWriter.*;
import java.util.*;

public class frmEditBands extends javax.swing.JApplet {
    
    public TReport objTReport=new TReport();
    public HashMap colGroups=new HashMap();
    public boolean cancelled=false;
    private TEITLComboModel objComboModel=new TEITLComboModel();
    
    private JDialog aDialog;
    
    
    public frmEditBands() {
        setSize(588,285);
        initComponents();
        
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jScrollPane1 = new javax.swing.JScrollPane();
        Bands = new javax.swing.JList();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        txtBandHeight = new javax.swing.JTextField();
        chkSplit = new javax.swing.JCheckBox();
        cmdUpdate = new javax.swing.JButton();
        cmdOK = new javax.swing.JButton();
        cmdCancel = new javax.swing.JButton();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        Bands.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
                BandsValueChanged(evt);
            }
        });

        jScrollPane1.setViewportView(Bands);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(5, 4, 230, 240);

        jPanel1.setLayout(null);

        jPanel1.setBorder(new javax.swing.border.EtchedBorder());
        jLabel1.setText("Band Height");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(9, 13, 90, 15);

        txtBandHeight.addInputMethodListener(new java.awt.event.InputMethodListener() {
            public void caretPositionChanged(java.awt.event.InputMethodEvent evt) {
            }
            public void inputMethodTextChanged(java.awt.event.InputMethodEvent evt) {
                txtBandHeightInputMethodTextChanged(evt);
            }
        });
        txtBandHeight.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtBandHeightKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtBandHeightKeyTyped(evt);
            }
        });

        jPanel1.add(txtBandHeight);
        txtBandHeight.setBounds(95, 12, 90, 19);

        chkSplit.setText("Split Allowed");
        chkSplit.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                chkSplitItemStateChanged(evt);
            }
        });

        jPanel1.add(chkSplit);
        chkSplit.setBounds(11, 48, 140, 23);

        cmdUpdate.setText("Update");
        cmdUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdUpdateActionPerformed(evt);
            }
        });

        jPanel1.add(cmdUpdate);
        cmdUpdate.setBounds(125, 89, 88, 25);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(239, 5, 230, 238);

        cmdOK.setText("OK");
        cmdOK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdOKActionPerformed(evt);
            }
        });
        cmdOK.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                cmdOKMouseClicked(evt);
            }
        });

        getContentPane().add(cmdOK);
        cmdOK.setBounds(478, 6, 80, 25);

        cmdCancel.setText("Cancel");
        cmdCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdCancelActionPerformed(evt);
            }
        });

        getContentPane().add(cmdCancel);
        cmdCancel.setBounds(478, 37, 80, 25);

    }//GEN-END:initComponents

    private void cmdUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdUpdateActionPerformed
        // TODO add your handling code here:
                        try {
            int bandIndex=TGLOBAL.getComboCode(Bands);
            TBand objBand=(TBand)colGroups.get(Integer.toString(bandIndex));
            objBand.BandHeight=Integer.parseInt(txtBandHeight.getText());
            colGroups.remove(Integer.toString(bandIndex));
            colGroups.put(Integer.toString(bandIndex),objBand);
        }
        catch(Exception e) {
            
        }
    }//GEN-LAST:event_cmdUpdateActionPerformed

    private void txtBandHeightKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtBandHeightKeyTyped
        // TODO add your handling code here:

    }//GEN-LAST:event_txtBandHeightKeyTyped
    
    private void txtBandHeightKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtBandHeightKeyPressed
        // TODO add your handling code here:

    }//GEN-LAST:event_txtBandHeightKeyPressed
    
    private void BandsValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_BandsValueChanged
        // TODO add your handling code here:
        try {
            int bandIndex=TGLOBAL.getComboCode(Bands);
            TBand objBand=(TBand)colGroups.get(Integer.toString(bandIndex));
            
            txtBandHeight.setText(Integer.toString(objBand.BandHeight));
            chkSplit.setSelected(objBand.SplitBand);
            
        }
        catch(Exception e) {
            
        }
        
    }//GEN-LAST:event_BandsValueChanged
    
    private void chkSplitItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_chkSplitItemStateChanged
        // TODO add your handling code here:
        try {
            int bandIndex=TGLOBAL.getComboCode(Bands);
            TBand objBand=(TBand)colGroups.get(Integer.toString(bandIndex));
            objBand.SplitBand=chkSplit.isSelected();
            colGroups.remove(Integer.toString(bandIndex));
            colGroups.put(Integer.toString(bandIndex),objBand);
        }
        catch(Exception e) {
            
        }
        
    }//GEN-LAST:event_chkSplitItemStateChanged
    
    private void txtBandHeightInputMethodTextChanged(java.awt.event.InputMethodEvent evt) {//GEN-FIRST:event_txtBandHeightInputMethodTextChanged
        // TODO add your handling code here:
        
    }//GEN-LAST:event_txtBandHeightInputMethodTextChanged
    
    private void cmdCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdCancelActionPerformed
        // TODO add your handling code here:
        cancelled=true;
        aDialog.dispose();
    }//GEN-LAST:event_cmdCancelActionPerformed
    
    private void cmdOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdOKActionPerformed
        // TODO add your handling code here:
        try {
            objTReport.colBands.clear();
            
            for(int i=1;i<=colGroups.size();i++) {
                TBand objBand=(TBand)colGroups.get(Integer.toString(i));
                objTReport.colBands.put(Integer.toString(i),objBand);
            }
            
            cancelled=false;
            aDialog.dispose();
        }
        catch(Exception e) {
            
        }
    }//GEN-LAST:event_cmdOKActionPerformed
    
    private void cmdOKMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_cmdOKMouseClicked
        // TODO add your handling code here:
        
    }//GEN-LAST:event_cmdOKMouseClicked
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JList Bands;
    private javax.swing.JCheckBox chkSplit;
    private javax.swing.JButton cmdCancel;
    private javax.swing.JButton cmdOK;
    private javax.swing.JButton cmdUpdate;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextField txtBandHeight;
    // End of variables declaration//GEN-END:variables
    
    private Frame findParentFrame(JApplet pApplet) {
        Container c = (Container) pApplet;
        while(c != null){
            if (c instanceof Frame)
                return (Frame)c;
            
            c = c.getParent();
        }
        return (Frame)null;
    }
    
    
    public void ShowDialog() {
        setSize(588,285);
        
        LoadBands();
        GenerateList();
        
        Frame f=findParentFrame(this);
        
        aDialog=new JDialog(f,"Report Groups",true);
        
        aDialog.getContentPane().add("Center",this);
        Dimension appletSize = this.getSize();
        aDialog.setSize(appletSize);
        aDialog.setResizable(false);
        
        //Place it to center of the screen
        Dimension screenSize=Toolkit.getDefaultToolkit().getScreenSize();
        aDialog.setLocation((int)(screenSize.getWidth()-appletSize.getWidth())/2,(int)(screenSize.getHeight()-appletSize.getHeight())/2);
        
        aDialog.setDefaultCloseOperation(javax.swing.JDialog.DISPOSE_ON_CLOSE);
        aDialog.show();
    }
    
    private void GenerateList() {
        try {
            
            objComboModel=new TEITLComboModel();
            Bands.removeAll();
            Bands.setModel(objComboModel);
            
            for(int i=1;i<=colGroups.size();i++) {
                TBand objBand=(TBand)colGroups.get(Integer.toString(i));
                TComboData objComboData=new TComboData();
                objComboData.Text=objBand.BandName;
                objComboData.Code=i;
                objComboModel.addElement(objComboData);
            }
            
        }
        catch(Exception e) {
            
        }
    }
    
    
    
    private void LoadBands() {
        try {
            
            colGroups.clear();
            
            for(int i=1;i<=objTReport.colBands.size();i++) {
                TBand objBand=(TBand)objTReport.colBands.get(Integer.toString(i));
                
                colGroups.put(Integer.toString(colGroups.size()+1),objBand);
            }
            
            GenerateList();
        }
        catch(Exception e) {
            
        }
    }
    
    
}
