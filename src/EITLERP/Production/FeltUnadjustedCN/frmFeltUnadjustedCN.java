/*
 * frmLegacyVouchers.java
 *
 * Created on August 23, 2008, 11:18 AM
 */

package EITLERP.Production.FeltUnadjustedCN;

/**
 *
 * @author  root
 */


import EITLERP.*;
import EITLERP.Finance.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.net.*;
import java.util.*;
import TReportWriter.*;



import java.util.HashMap;
import java.sql.Connection;
import java.sql.Statement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.net.URL;
import javax.swing.JOptionPane;

import EITLERP.EITLERPGLOBAL;
import EITLERP.EITLComboModel;
import EITLERP.EITLTableModel;
import EITLERP.data;
import EITLERP.ComboData;


public class frmFeltUnadjustedCN extends javax.swing.JApplet {
    
    //private EITLTableModel DataModel=new EITLTableModel();
    
    EITLComboModel IntervalComboModel;
    EITLTableModel DataModel;
    
    private ResultSet rsResultSet,rsResultSet1;
    private Connection Conn;
    private Statement Stmt;
    private clsVoucher objVoucher;
    //  private EITLComboModel cmbReceiptTypeModel;
    //  private EITLComboModel cmbReportTypeModel;
    private TReportEngine objEngine=new TReportEngine();
    private TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
    
    
    
    /** Initializes the applet frmLegacyVouchers */
    public void init() {
        setSize(675,500);
        initComponents();
        generateIntervalCombo();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        bgVoucher = new javax.swing.ButtonGroup();
        lblTitle = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        txtFromDate = new javax.swing.JTextField();
        txtToDate = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        lblBookName = new javax.swing.JLabel();
        jProgressBar1 = new javax.swing.JProgressBar();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        cmbIntervalCombo = new javax.swing.JComboBox();
        jLabel4 = new javax.swing.JLabel();
        Processcash = new javax.swing.JButton();
        txtInterval = new javax.swing.JTextField();
        txtVoucherNo = new javax.swing.JTextField();
        jButton5 = new javax.swing.JButton();
        jTextField1 = new javax.swing.JTextField();

        getContentPane().setLayout(null);

        lblTitle.setBackground(new java.awt.Color(0, 102, 153));
        lblTitle.setForeground(java.awt.Color.white);
        lblTitle.setText("FELT UNADJUSTED CREDIT NOTE PROCESS & PRINTING FORM");
        lblTitle.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        lblTitle.setOpaque(true);
        getContentPane().add(lblTitle);
        lblTitle.setBounds(0, 2, 666, 25);

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("From Date :");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(5, 67, 85, 15);

        jLabel2.setText("Felt Unadjusted Credit Note Process");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(6, 39, 350, 15);

        txtFromDate.setNextFocusableComponent(txtToDate);
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(95, 66, 100, 19);

        getContentPane().add(txtToDate);
        txtToDate.setBounds(263, 67, 100, 19);

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("To Date :");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(200, 68, 60, 15);

        Table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        Table.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                mouseDBLClicked(evt);
            }
        });

        jScrollPane1.setViewportView(Table);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(10, 190, 648, 200);

        lblBookName.setText(".");
        getContentPane().add(lblBookName);
        lblBookName.setBounds(204, 119, 280, 15);

        getContentPane().add(jProgressBar1);
        jProgressBar1.setBounds(390, 70, 148, 14);

        jButton3.setText("3. Felt Unadjusted Detail  Draft");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton3);
        jButton3.setBounds(340, 150, 240, 25);

        jButton4.setText("2. Felt Unadjusted  Summary");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton4);
        jButton4.setBounds(20, 150, 250, 25);

        cmbIntervalCombo.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cmbIntervalComboItemStateChanged(evt);
            }
        });
        cmbIntervalCombo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbIntervalComboActionPerformed(evt);
            }
        });

        getContentPane().add(cmbIntervalCombo);
        cmbIntervalCombo.setBounds(120, 120, 390, 24);

        jLabel4.setText("Select Period : ");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(10, 130, 130, 15);

        Processcash.setText("1. Process Felt Unadjusted Discount ");
        Processcash.setEnabled(false);
        Processcash.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ProcesscashActionPerformed(evt);
            }
        });

        getContentPane().add(Processcash);
        Processcash.setBounds(10, 90, 290, 25);

        getContentPane().add(txtInterval);
        txtInterval.setBounds(550, 120, 90, 19);

        txtVoucherNo.setEnabled(false);
        txtVoucherNo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtVoucherNoActionPerformed(evt);
            }
        });
        txtVoucherNo.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtVoucherNoFocusLost(evt);
            }
        });

        getContentPane().add(txtVoucherNo);
        txtVoucherNo.setBounds(240, 400, 140, 19);

        jButton5.setText("3. Credit Note Draft");
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton5);
        jButton5.setBounds(20, 400, 200, 25);

        jTextField1.setText("jTextField1");
        getContentPane().add(jTextField1);
        jTextField1.setBounds(500, 400, 69, 19);

    }//GEN-END:initComponents

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        LCCreditDraftReport();
    }//GEN-LAST:event_jButton5ActionPerformed
    
    private void txtVoucherNoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtVoucherNoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtVoucherNoActionPerformed
    
    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
     GenerateCreditNoteSummary();
          
    
    }//GEN-LAST:event_jButton4ActionPerformed
    
    private void txtVoucherNoFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtVoucherNoFocusLost
       
    }//GEN-LAST:event_txtVoucherNoFocusLost
        
    private void cmbIntervalComboItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cmbIntervalComboItemStateChanged
        txtInterval.setText((String)cmbIntervalCombo.getSelectedItem());
        
    }//GEN-LAST:event_cmbIntervalComboItemStateChanged
    
    private void cmbIntervalComboActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbIntervalComboActionPerformed
     //   if(EITLERPGLOBAL.getComboCode(cmbIntervalCombo)!=""){
            formatGrid();
            try{
                ResultSet rs=data.getResult("SELECT CND_SUB_ACCOUNT_CODE,CND_LC_OPENER,CND_DAYS,CND_INVOICE_NO,CND_LINK_NO,CND_INVOICE_DATE,CND_CHARGE_CODE,CND_INVOICE_AMOUNT,CND_PERCENT,CND_INTERVAL_CAPTION,CASE WHEN CND_LC_OPENER - CND_SUB_ACCOUNT_CODE = 0 THEN '' ELSE CONCAT('LC_OPENER','(',CND_LC_OPENER,')') END AS LC_OPENER,CND_MAIN_ACCOUNT_NAME,CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE  CND_YEAR_MON_ID =SUBSTRING('" +txtInterval.getText()+"',1,12) AND CND_EFFECT='D' AND CND_TYPE='FELTCASH' ORDER BY CND_SUB_ACCOUNT_CODE,CND_INVOICE_DATE,CND_LINK_NO+0");
                while(!rs.isAfterLast()){
                    Object[] rowData=new Object[13];
                
                    rowData[0]=rs.getString("CND_MAIN_ACCOUNT_NAME");
                    rowData[1]=rs.getString("CND_LC_OPENER");
                    rowData[2]=rs.getString("CND_SUB_ACCOUNT_CODE");
                    rowData[3]=rs.getString("CND_LINK_NO");
                    rowData[4]=rs.getString("CND_INVOICE_DATE");
                    rowData[5]=rs.getString("CND_INVOICE_AMOUNT");
                    rowData[6]=rs.getString("CND_PERCENT");
                    rowData[7]=rs.getString("CND_BOOK_CODE");
                    rowData[8]=rs.getString("CND_DAYS");
                    rowData[9]=rs.getString("CND_DEBIT_AMOUNT");
                    rowData[10]=rs.getString("CND_CREDIT_AMOUNT");
                    rowData[11]=rs.getString("CND_LC_OPENER");
                    
                    
                    
                    DataModel.addRow(rowData);
                    rs.next();
                }
                rs.close();
          
            }catch(SQLException sqe){sqe.printStackTrace();

        }
        
        
  
    }//GEN-LAST:event_cmbIntervalComboActionPerformed
    
    private void ProcesscashActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ProcesscashActionPerformed
        if ( ! Validate()) {
            return;
        }
        processLCQTRDiscount();
        // TODO add your handling code here:
    }//GEN-LAST:event_ProcesscashActionPerformed
    
    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
    
       DraftReport();     // TODO add your handling code here:
    }//GEN-LAST:event_jButton3ActionPerformed
        
    private void mouseDBLClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_mouseDBLClicked
        
    }//GEN-LAST:event_mouseDBLClicked
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton Processcash;
    private javax.swing.JTable Table;
    private javax.swing.ButtonGroup bgVoucher;
    private javax.swing.JComboBox cmbIntervalCombo;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JProgressBar jProgressBar1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JLabel lblBookName;
    private javax.swing.JLabel lblTitle;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtInterval;
    private javax.swing.JTextField txtToDate;
    private javax.swing.JTextField txtVoucherNo;
    // End of variables declaration//GEN-END:variables
    
    private void GenerateReport() {
        try {
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            objReportData.AddColumn("CND_MAIN_ACCOUNT_NAME");
            objReportData.AddColumn("CND_MAIN_ACCOUNT_CODE");
            objReportData.AddColumn("CND_SUB_ACCOUNT_CODE");
            objReportData.AddColumn("CND_LINK_NO");
            objReportData.AddColumn("CND_INVOICE_DATE");
            objReportData.AddColumn("CND_INVOICE_AMOUNT");
            objReportData.AddColumn("CND_PERCENT");
            objReportData.AddColumn("CND_BOOK_CODE");
            objReportData.AddColumn("CND_RC_VOUCHER_NO");
            objReportData.AddColumn("CND_RC_VOUCHER_DATE");
            objReportData.AddColumn("CND_RC_FIN_VOUCHER_NO");
            objReportData.AddColumn("CND_DAYS");
            objReportData.AddColumn("CND_DEBIT_AMOUNT");
            objReportData.AddColumn("CND_CREDIT_AMOUNT");
            objReportData.AddColumn("CND_INTERVAL_CAPTION");
            
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("CND_MAIN_ACCOUNT_NAME","");
            objOpeningRow.setValue("CND_MAIN_ACCOUNT_CODE","");
            objOpeningRow.setValue("CND_SUB_ACCOUNT_CODE","");
            objOpeningRow.setValue("CND_LINK_NO","");
            objOpeningRow.setValue("CND_INVOICE_DATE","");
            objOpeningRow.setValue("CND_INVOICE_AMOUNT","");
            objOpeningRow.setValue("CND_PERCENT","");
            objOpeningRow.setValue("CND_BOOK_CODE","");
            objOpeningRow.setValue("CND_RC_VOUCHER_NO","");
            objOpeningRow.setValue("CND_RC_VOUCHER_DATE","");
            objOpeningRow.setValue("CND_RC_FIN_VOUCHER_NO","");
            objOpeningRow.setValue("CND_DAYS","");
            objOpeningRow.setValue("CND_DEBIT_AMOUNT","");
            objOpeningRow.setValue("CND_CREDIT_AMOUNT","");
            objOpeningRow.setValue("CND_INTERVAL_CAPTION","");
            
            String strSQL = "SELECT * FROM D_CREDIT_NOTE_DETAIL WHERE CND_TYPE='FELTCASH'";
        
            
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();
                    
                    objRow.setValue("CND_MAIN_ACCOUNT_NAME",UtilFunctions.getString(rsTmp,"CND_MAIN_ACCOUNT_NAME",""));
                    objRow.setValue("CND_MAIN_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CND_MAIN_ACCOUNT_CODE",""));
                    objRow.setValue("CND_SUB_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CND_SUB_ACCOUNT_CODE",""));
                    objRow.setValue("CND_LINK_NO",UtilFunctions.getString(rsTmp,"CND_LINK_NO",""));
                    objRow.setValue("CND_INVOICE_DATE",UtilFunctions.getString(rsTmp,"CND_CHARGE_CODE",""));
                    objRow.setValue("CND_INVOICE_AMOUNT",UtilFunctions.getString(rsTmp,"CND_INVOICE_AMOUNT",""));
                    objRow.setValue("CND_PERCENT",UtilFunctions.getString(rsTmp,"CND_PERCENT",""));
                    objRow.setValue("CND_BOOK_CODE",UtilFunctions.getString(rsTmp,"CND_BOOK_CODE",""));
                    objRow.setValue("CND_RC_VOUCHER_NO",UtilFunctions.getString(rsTmp,"CND_RC_VOUCHER_NO",""));
                    objRow.setValue("CND_RC_VOUCHER_DATE",UtilFunctions.getString(rsTmp,"CND_RC_VOUCHER_DATE",""));
                    objRow.setValue("CND_RC_FIN_VOUCHER_NO",UtilFunctions.getString(rsTmp,"CND_RC_FIN_VOUCHER_NO",""));
                    objRow.setValue("CND_DAYS",UtilFunctions.getString(rsTmp,"CND_DAYS",""));
                    objRow.setValue("CND_DEBIT_AMOUNT",UtilFunctions.getString(rsTmp,"CND_DEBIT_AMOUNT",""));
                    objRow.setValue("CND_CREDIT_AMOUNT",UtilFunctions.getString(rsTmp,"CND_CREDIT_AMOUNT",""));
                    objRow.setValue("CND_INTERVAL_CAPTION",UtilFunctions.getString(rsTmp,"CND_INTERVAL_CAPTION",""));
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
                }
            }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
            //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
            // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            //Parameters.put("FROM_DATE",txtFromDate.getText().trim());
            // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
       //     objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/sales/LC.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
    public String getStrQuery(String SubAccountCode,String MainAccountCode) {
        
        String strQuery;
        if(!MainAccountCode.trim().equals("")) {
            strQuery=" AND CND_MAIN_ACCOUNT_CODE ="+MainAccountCode;
            //    if(!MainAccountCode.trim().equals("")) {
            //      strQuery=strQuery+" AND MAIN_ACCOUNT_CODE ="+MainAccountCode;
        }
        // }
        else {
            strQuery = " AND CND_MAIN_ACCOUNT_CODE ="+MainAccountCode ;
        }
        
        return strQuery;
    }
    
    
    private void DraftReportNonPayment() {
        try {
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            objReportData.AddColumn("CND_NO");
            objReportData.AddColumn("CND_MAIN_ACCOUNT_NAME");
            objReportData.AddColumn("CND_MAIN_ACCOUNT_CODE");
            objReportData.AddColumn("CND_BOOK_CODE");
            objReportData.AddColumn("CND_SUB_ACCOUNT_CODE");
            objReportData.AddColumn("CND_LINK_NO");
            objReportData.AddColumn("CND_LINK_YEAR");
            objReportData.AddColumn("CND_INVOICE_DATE");
            objReportData.AddColumn("CND_INVOICE_AMOUNT");
            objReportData.AddColumn("CND_CHARGE_CODE");
            objReportData.AddColumn("CND_PERCENT");
            objReportData.AddColumn("CND_DEBIT_AMOUNT");
            objReportData.AddColumn("CND_CREDIT_AMOUNT");
            objReportData.AddColumn("CND_VALUE_DATE");
            objReportData.AddColumn("CND_INTERVAL_CAPTION");
            objReportData.AddColumn("CND_LC_OPENER");
            objReportData.AddColumn("CND_RC_VOUCHER_NO");
            objReportData.AddColumn("CND_FIN_VOUCHER_NO");
            objReportData.AddColumn("CND_DAYS");
            
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("CND_NO","");
            objOpeningRow.setValue("CND_MAIN_ACCOUNT_NAME","");
            objOpeningRow.setValue("CND_MAIN_ACCOUNT_CODE","");
            objOpeningRow.setValue("CND_BOOK_CODE","");
            objOpeningRow.setValue("CND_SUB_ACCOUNT_CODE","");
            objOpeningRow.setValue("CND_LINK_NO","");
            objOpeningRow.setValue("CND_LINK_YEAR","");
            objOpeningRow.setValue("CND_INVOICE_DATE","");
            objOpeningRow.setValue("CND_INVOICE_AMOUNT","");
            objOpeningRow.setValue("CND_CHARGE_CODE","");
            objOpeningRow.setValue("CND_PERCENT","");
            objOpeningRow.setValue("CND_DEBIT_AMOUNT","");
            objOpeningRow.setValue("CND_CREDIT_AMOUNT","");
            objOpeningRow.setValue("CND_VALUE_DATE","");
            objOpeningRow.setValue("CND_INTERVAL_CAPTION","");
            objOpeningRow.setValue("CND_LC_OPENER","");
            objOpeningRow.setValue("CND_RC_VOUCHER_NO","");
            objOpeningRow.setValue("CND_FIN_VOUCHER_NO","");
            objOpeningRow.setValue("CND_DAYS","");
            
            
            //         String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO, CND_LINK_YEAR, CND_INVOICE_DATE,CND_INVOICE_AMOUNT,CND_CHARGE_CODE,CND_PERCENT, CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_INVOICE_DATE>='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' AND CND_INVOICE_DATE<='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"'ORDER BY CND_VALUE_DATE,CND_NO,CND_EFFECT DESC,CND_LINK_NO+0";
            // String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_BOOK_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO,CND_LINK_YEAR,CND_INVOICE_DATE,CASE WHEN CND_EFFECT ='D' THEN 0 ELSE CND_INVOICE_AMOUNT END AS CND_INVOICE_AMOUNT,CASE WHEN CND_EFFECT ='D' THEN 0 ELSE CND_CHARGE_CODE END AS CND_CHARGE_CODE,CASE WHEN CND_EFFECT ='D' THEN 0 CND_PERCENT ELSE END AS CND_PERCENT,CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE,CND_INTERVAL_CAPTION FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_YEAR_MON_ID =SUBSTRING('" +txtInterval.getText()+"',1,8) ORDER BY SUBSTRING(CND_NO,9,6)+0,CND_SUB_ACCOUNT_CODE,CND_NO,CND_VALUE_DATE,CND_EFFECT DESC,CND_LINK_NO+0";
            //  System.out.println(strSQL);
            
            String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_LC_OPENER,CND_RC_VOUCHER_NO,CND_FIN_VOUCHER_NO,CND_DAYS,CND_SUB_ACCOUNT_CODE,CND_LINK_NO,CND_LINK_YEAR,CND_INVOICE_DATE, CND_INVOICE_AMOUNT , CND_CHARGE_CODE , CND_PERCENT,CND_BOOK_CODE, CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE,CND_INTERVAL_CAPTION FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_YEAR_MON_ID = SUBSTRING('" +txtInterval.getText()+"',1,12) AND CND_TYPE='FELTCASH' AND CND_CREDIT_AMOUNT = 0 ORDER BY  CND_NO,CND_SUB_ACCOUNT_CODE,CND_INVOICE_DATE,CND_INVOICE_NO,CND_VALUE_DATE,CND_EFFECT DESC,CND_LINK_NO+0";
            System.out.println(strSQL);
            
            //   String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO, CND_LINK_YEAR, CND_INVOICE_DATE,CND_INVOICE_AMOUNT,CND_CHARGE_CODE,CND_PERCENT, CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE ORDER BY CND_VALUE_DATE,CND_NO,CND_EFFECT DESC,CND_LINK_NO+0,CND_INVOICE_DATE>='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' AND CND_INVOICE_DATE<='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"'";
            
            
            // "WHERE (CND_INOVICE_DATE>= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText()) +"' "+"" +
            // "AND CND_INOVICE_DATE<= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText()) +"')"+
            // "ORDER BY CND_INOVICE_DATE";
            
            //"AND (A.RECEIPT_DATE>= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText()) +"' "+
            //"AND A.RECEIPT_DATE<= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText()) +"' ) ";  
            
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();
                    
                    objRow.setValue("CND_NO",UtilFunctions.getString(rsTmp,"CND_NO",""));
                    objRow.setValue("CND_MAIN_ACCOUNT_NAME",UtilFunctions.getString(rsTmp,"CND_MAIN_ACCOUNT_NAME",""));
                    objRow.setValue("CND_MAIN_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CND_MAIN_ACCOUNT_CODE",""));
                    objRow.setValue("CND_BOOK_CODE",UtilFunctions.getString(rsTmp,"CND_BOOK_CODE",""));
                    objRow.setValue("CND_SUB_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CND_SUB_ACCOUNT_CODE",""));
                    objRow.setValue("CND_LINK_NO",UtilFunctions.getString(rsTmp,"CND_LINK_NO",""));
                    // objRow.setValue("CND_INVOICE_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"CND_INVOICE_DATE","")));
                    objRow.setValue("CND_LINK_YEAR",UtilFunctions.getString(rsTmp,"CND_LINK_YEAR",""));
                    objRow.setValue("CND_INVOICE_DATE",UtilFunctions.getString(rsTmp,"CND_INVOICE_DATE",""));
                    objRow.setValue("CND_INVOICE_AMOUNT",UtilFunctions.getString(rsTmp,"CND_INVOICE_AMOUNT",""));
                    objRow.setValue("CND_CHARGE_CODE",UtilFunctions.getString(rsTmp,"CND_CHARGE_CODE",""));
                    objRow.setValue("CND_PERCENT",UtilFunctions.getString(rsTmp,"CND_PERCENT",""));
                    objRow.setValue("CND_DEBIT_AMOUNT",UtilFunctions.getString(rsTmp,"CND_DEBIT_AMOUNT",""));
                    objRow.setValue("CND_CREDIT_AMOUNT",UtilFunctions.getString(rsTmp,"CND_CREDIT_AMOUNT",""));
                    objRow.setValue("CND_VALUE_DATE",UtilFunctions.getString(rsTmp,"CND_VALUE_DATE",""));
                    objRow.setValue("CND_INTERVAL_CAPTION",UtilFunctions.getString(rsTmp,"CND_INTERVAL_CAPTION",""));
                    objRow.setValue("CND_LC_OPENER",UtilFunctions.getString(rsTmp,"CND_LC_OPENER",""));
                    objRow.setValue("CND_RC_VOUCHER_NO",UtilFunctions.getString(rsTmp,"CND_RC_VOUCHER_NO",""));
                    objRow.setValue("CND_FIN_VOUCHER_NO",UtilFunctions.getString(rsTmp,"CND_FIN_VOUCHER_NO",""));
                    objRow.setValue("CND_DAYS",UtilFunctions.getString(rsTmp,"CND_DAYS",""));
                    
                    
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
                }
            }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
            //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
            // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
            // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
         objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/sales/rptLCQTRnonpayment.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
    public String getStrQuery1(String SubAccountCode,String CndNo) {
        
        String strQuery;
        if(!CndNo.trim().equals("")) {
            strQuery=" AND CND_NO ="+CndNo;
            //    if(!MainAccountCode.trim().equals("")) {
            //      strQuery=strQuery+" AND MAIN_ACCOUNT_CODE ="+MainAccountCode;
        }
        // }
        else {
            strQuery = " AND CND_NO ="+CndNo;
        }
        
        return strQuery;
    }
    
    private boolean Validate() {
        //Form level validations
        
        if(txtFromDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter from date");
            return false;
        } else if(!EITLERPGLOBAL.isDate(txtFromDate.getText())) {
            JOptionPane.showMessageDialog(null,"Invalid From Date in DD/MM/YYYY format.");
            return false;
        }
        
        if(txtToDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter To date");
            return false;
        } else if(!EITLERPGLOBAL.isDate(txtToDate.getText())) {
            JOptionPane.showMessageDialog(null,"Invalid To Date in DD/MM/YYYY format.");
            return false;
        }
        
        
        return true;
    }
    
    
    private void generateIntervalCombo(){
        IntervalComboModel=new EITLComboModel();
        IntervalComboModel.removeAllElements();
        cmbIntervalCombo.setModel(IntervalComboModel);
        try{
            ComboData combodata=new ComboData();
            //combodata.Code=0;
            combodata.strCode="";
            combodata.Text="Select Date";
            
            IntervalComboModel.addElement(combodata);
            ResultSet rs=data.getResult("SELECT DISTINCT CND_YEAR_MON_ID,CND_INTERVAL_CAPTION FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_TYPE ='FELTCASH' ORDER BY CND_YEAR_MON_ID DESC ");
            while(!rs.isAfterLast()){
                combodata=new ComboData();
                combodata.strCode=rs.getString("CND_YEAR_MON_ID");
                // combodata.strCode=rs.getString("SCHEME_NAME");
                //  combodata.Text=rs.getString("CND_INTERVAL_CAPTION")+"-"+rs.getString("CND_YEAR_MON_ID");
                combodata.Text=rs.getString("CND_YEAR_MON_ID")+" : "+ rs.getString("CND_INTERVAL_CAPTION");
                
                IntervalComboModel.addElement(combodata);
                rs.next();
            }
        }catch(SQLException e){e.printStackTrace();}
    }
    
    private void processLCQTRDiscount(){
        try{
            Connection conn=data.getConn();
            Statement stmt=conn.createStatement();
            
            
            stmt.execute("TRUNCATE TABLE PRODUCTION.TMP_LC_CREDITNOTETEST");
            
            stmt.execute("INSERT INTO PRODUCTION.TMP_LC_CREDITNOTETEST SELECT A.VOUCHER_NO,VOUCHER_DATE,MAIN_ACCOUNT_CODE,SUB_ACCOUNT_CODE,EFFECT,INVOICE_NO,INVOICE_DATE,INVOICE_AMOUNT,AMOUNT,GRN_NO,GRN_DATE, '0000-00-00',A.LINK_NO,'0000-00-00','0000-00-00','0000-00-00',MATCHED_DATE,MATCHED,  '','','',    '','','',    '','','',    '','','',    '','','',    '','','',    '','','',  BOOK_CODE,'',0,0,0,0,0,LC_OPENER_CODE FROM FINANCE.D_FIN_VOUCHER_DETAIL A,FINANCE.D_FIN_VOUCHER_HEADER B,(SELECT PARTY_CODE,LC_OPENER_CODE,MAX(EXP_DATE) AS EXP_DATE  FROM  DINESHMILLS.D_SAL_POLICY_LC_MASTER A GROUP BY PARTY_CODE,LC_OPENER_CODE) AS C WHERE A.VOUCHER_NO = B.VOUCHER_NO AND B.CANCELLED =0 AND B.APPROVED =1 AND SUB_ACCOUNT_CODE =PARTY_CODE AND VOUCHER_DATE >='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"'  AND VOUCHER_DATE <='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"' AND SUBSTRING(A.VOUCHER_NO,1,2) = 'SJ' AND MAIN_ACCOUNT_CODE =210027");
            
            stmt.execute("DELETE FROM PRODUCTION.TMP_LC_CREDITNOTETEST WHERE LCN_SUB_ACCOUNT_CODE NOT IN  (619913,319907,549901,559901,279965,739901,739990,317707)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST ,DINESHMILLS.D_SAL_INVOICE_HEADER SET LCN_CHARGE_CODE = PAYMENT_TERM_CODE WHERE LCN_INVOICE_NO  = INVOICE_NO AND  LCN_INVOICE_DATE  = INVOICE_DATE");
            
            stmt.execute("DELETE FROM PRODUCTION.TMP_LC_CREDITNOTETEST WHERE SUBSTRING(LCN_CHARGE_CODE,1,1)  IN (1,2,3,4,5,6,8,9)");
            
            
            
            stmt.execute("TRUNCATE TABLE  TEMP_DATABASE.TM81");
            
            stmt.execute("INSERT INTO  TEMP_DATABASE.TM81 SELECT A.LINK_NO,SUB_ACCOUNT_CODE,VOUCHER_DATE,VALUE_DATE,A.VOUCHER_NO,LEGACY_NO,''FROM FINANCE.D_FIN_VOUCHER_DETAIL A, FINANCE.D_FIN_VOUCHER_HEADER B WHERE A.VOUCHER_NO = B.VOUCHER_NO AND B.CANCELLED =0 AND B.APPROVED =1  AND SUBSTRING(SUB_ACCOUNT_CODE,3,2) IN (99,77) AND VOUCHER_DATE >='2014-01-01' AND SUBSTRING(A.VOUCHER_NO,1,2) = 'RC' AND MAIN_ACCOUNT_CODE =210027  AND A.LINK_NO !=''  UNION ALL SELECT AGENT_SR,SUB_ACCOUNT_CODE,DOC_DATE,VOUCHER_DATE,VOUCHER_NO,A.DOC_NO,'' FROM FINANCE.D_FIN_DR_ADJ_DETAIL A,FINANCE.D_FIN_DR_ADJ_HEADER B  WHERE A.DOC_NO = B.DOC_NO  AND B.CANCELLED =0 AND B.APPROVED =1 AND DOC_DATE >='2014-01-01'  AND MAIN_ACCOUNT_CODE =210027 AND SUBSTRING(A.VOUCHER_NO,1,2) IN ('RC','CN','JV','CR','M1') AND B.REMARKS NOT LIKE ('%Debit Note%') AND AGENT_SR !='' AND SUBSTRING(SUB_ACCOUNT_CODE,3,2) IN (99,77) AND HIERARCHY_ID  !=1277");
            
            
            
            
            
            stmt.execute("TRUNCATE TABLE  TEMP_DATABASE.TM80");
            
            stmt.execute("INSERT INTO  TEMP_DATABASE.TM80 SELECT COL01,COUNT(*),MAX(COL04),'' FROM  TEMP_DATABASE.TM81 GROUP BY COL01 ");
            
            stmt.execute("UPDATE TEMP_DATABASE.TM80 A ,TEMP_DATABASE.TM81 B  SET B.COL07 =1  WHERE A.COL01 = B.COL01 AND A.COL03 = B.COL04");
            
            stmt.execute("DELETE FROM  TEMP_DATABASE.TM81 WHERE COL07 =''");
            
            
            
              stmt.execute("TRUNCATE TABLE  TEMP_DATABASE.TM80");
 
              stmt.execute("INSERT INTO  TEMP_DATABASE.TM80 SELECT COL01,COUNT(*),MAX(COL05),'' FROM  TEMP_DATABASE.TM81 GROUP BY COL01");
            
            stmt.execute("UPDATE TEMP_DATABASE.TM80 A ,TEMP_DATABASE.TM81 B  SET B.COL07 =2 WHERE A.COL01 = B.COL01 AND A.COL03 = B.COL05");

            stmt.execute("DELETE FROM  TEMP_DATABASE.TM81 WHERE COL07 =1");
            
         
            
            stmt.execute("UPDATE TEMP_DATABASE.TM81,PRODUCTION.TMP_LC_CREDITNOTETEST  SET LCN_RC_VOUCHER = COL05,LCN_RC_VALUE_DATE = COL04,EXT1=COL06,LCN_RC_VOU_DATE= COL03 WHERE COL01 = LCN_LINK_NO");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST  SET LCN_DAY = EXTRACT(DAY FROM LCN_VOUCHER_DATE), LCN_MONTH =EXTRACT(MONTH FROM LCN_VOUCHER_DATE), LCN_YEAR = EXTRACT(YEAR FROM LCN_VOUCHER_DATE)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_INTERVAL = CASE WHEN  LCN_MONTH IN (1,2,3)   THEN 'QTR01'WHEN LCN_MONTH IN (4,5,6)   THEN 'QTR02' WHEN LCN_MONTH IN (7,8,9)   THEN 'QTR03' WHEN LCN_MONTH IN (10,11,12)   THEN 'QTR04'  END");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET EXT2 = CASE WHEN  LCN_MONTH IN (4,5,6,7,8,9,10,11,12) THEN LCN_YEAR+1  WHEN LCN_MONTH IN (1,2,3)   THEN LCN_YEAR -1 END");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_YEAR_MON_ID = CONCAT(LCN_YEAR,LCN_INTERVAL)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_BANK_TR_CODE = SUBSTRING(LCN_RC_VOUCHER,5,2)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_BANK_TR_CODE = 88 WHERE SUBSTRING(LCN_RC_VOUCHER,1,2) ='CN'");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_NO = CONCAT(LCN_LC_OPENER,LCN_YEAR_MON_ID)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_INTERVAL_CAPTION = CASE WHEN  LCN_MONTH IN (1,2,3)   THEN CONCAT( 'FROM  01/01/',LCN_YEAR, '   TO 31/03/',LCN_YEAR) WHEN LCN_MONTH IN (4,5,6)   THEN CONCAT( 'FROM  01/04/',LCN_YEAR, '   TO 30/06/',LCN_YEAR)  WHEN LCN_MONTH IN (7,8,9)   THEN CONCAT( 'FROM  01/07/',LCN_YEAR, '   TO 30/09/',LCN_YEAR) WHEN LCN_MONTH IN (10,11,12)   THEN CONCAT( 'FROM  01/10/',LCN_YEAR, '   TO 31/12/',LCN_YEAR)     END ");
 
            
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET  LCN_DAY_DIFF  = DATEDIFF(LCN_RC_VALUE_DATE,LCN_INVOICE_DATE)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET  LCN_DAY_DIFF  = DATEDIFF(LCN_RC_VALUE_DATE,LCN_INVOICE_DATE)");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET  LCN_PER  = CASE WHEN LCN_DAY_DIFF <=15 THEN 3 WHEN LCN_DAY_DIFF >=16 AND LCN_DAY_DIFF <=30  THEN 1.5 WHEN LCN_DAY_DIFF >=31 AND LCN_DAY_DIFF <=45  THEN 0 WHEN LCN_DAY_DIFF >=46   THEN 0 END WHERE LCN_RC_VALUE_DATE !='0000-00-00'");
            
            stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST SET LCN_CREDIT_AMOUNT = ROUND((LCN_PER*LCN_AMOUNT)/100,0)");
            

            stmt.execute("UPDATE  PRODUCTION.TMP_LC_CREDITNOTETEST,DINESHMILLS.D_SAL_PARTY_MASTER SET LCN_LC_NAME = PARTY_NAME WHERE PARTY_CODE = LCN_SUB_ACCOUNT_CODE");
 
            stmt.execute("DELETE FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_TYPE = 'FELTCASH' AND CND_YEAR_MON_ID IN (SELECT DISTINCT LCN_YEAR_MON_ID FROM  PRODUCTION.TMP_LC_CREDITNOTETEST)");
             
            
            
            stmt.execute("INSERT INTO PRODUCTION.D_CREDIT_NOTE_DETAIL (CND_ID,CND_NO,CND_TYPE,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_EFFECT,CND_LINK_NO,CND_INVOICE_NO,CND_INVOICE_DATE,CND_INVOICE_AMOUNT,CND_PERCENT,CND_BOOK_CODE,CND_RC_VOUCHER_NO,CND_RC_VOUCHER_DATE,CND_DAYS,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_FIN_VOUCHER_NO,CND_FIN_VOUCHER_DATE,CND_FIN_ELIGIBLE,CND_LC_OPENER,CND_VALUE_DATE,CND_MAIN_ACCOUNT_NAME,CND_YEAR_MON_ID,CND_INTERVAL_CAPTION)  SELECT DISTINCT 3,LCN_NO,'FELTCASH',LCN_MAIN_ACCOUNT_CODE,LCN_SUB_ACCOUNT_CODE,LCN_EFFECT,LCN_LINK_NO,LCN_INVOICE_NO,LCN_INVOICE_DATE,LCN_AMOUNT,LCN_PER,LCN_BANK_TR_CODE,LCN_RC_VOUCHER,LCN_RC_VALUE_DATE,LCN_DAY_DIFF,LCN_DEBIT_AMOUNT,LCN_CREDIT_AMOUNT,EXT1,LCN_VOUCHER_DATE,'Y',LCN_LC_OPENER,LCN_RC_VALUE_DATE,LCN_LC_NAME,LCN_YEAR_MON_ID,LCN_INTERVAL_CAPTION FROM PRODUCTION.TMP_LC_CREDITNOTETEST  ORDER BY LCN_SUB_ACCOUNT_CODE,LCN_INVOICE_DATE,LCN_LINK_NO");
            
            stmt.execute("DELETE FROM PRODUCTION.D_CREDIT_NOTE_HEADER WHERE CNH_TYPE = 'FELTCASH' AND CNH_YEAR_MON_ID IN (SELECT DISTINCT LCN_YEAR_MON_ID FROM  PRODUCTION.TMP_LC_CREDITNOTETEST)") ;
  
            stmt.execute("INSERT INTO PRODUCTION.D_CREDIT_NOTE_HEADER (CNH_ID,CNH_NO,CNH_TYPE,CNH_MAIN_ACCOUNT_CODE,CNH_MAIN_CODE,CNH_SUB_ACCOUNT_CODE,CNH_PARTY_NAME,CNH_EFFECT,CNH_INVOICE_AMOUNT,CNH_DEBIT_AMOUNT,CNH_YEAR_MON_ID,CNH_INTERVAL_CAPTION,CNH_BOOK_CODE) SELECT CND_ID,CND_NO,CND_TYPE,435091,210027,CND_LC_OPENER,CND_MAIN_ACCOUNT_NAME,'D',SUM(CND_INVOICE_AMOUNT),SUM(CND_CREDIT_AMOUNT),CND_YEAR_MON_ID,CND_INTERVAL_CAPTION,'TR-14' FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_TYPE = 'FELTCASH' AND CND_YEAR_MON_ID IN (SELECT DISTINCT LCN_YEAR_MON_ID FROM  PRODUCTION.TMP_LC_CREDITNOTETEST) GROUP BY CND_ID,CND_NO,CND_TYPE,CND_LC_OPENER,CND_MAIN_ACCOUNT_NAME,CND_YEAR_MON_ID,CND_INTERVAL_CAPTION");
           
            generateIntervalCombo();
            
        }catch(SQLException e){e.printStackTrace();}
        
    }
    
    // private void DisplayData(){
    //   try {
    
    //      txtCheckList.setText(objVoucher.objPayment.getAttribute("VOUCHER_NO").getString());
    //DoNotEvaluate=true;
    //  }
    //   }
    //  catch(Exception e){
    
    //   }
    
    
    private void formatGrid(){
        DataModel=new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);
       // TableColumnModel ColModel=Table.getColumnModel();
        
        //  DataModel.addColumn("Sr.");
        DataModel.addColumn("Party Name");
        DataModel.addColumn("Main Code");
        DataModel.addColumn("Sub Code");
        DataModel.addColumn("Link No");
        DataModel.addColumn("Invoice Date");
        DataModel.addColumn("Invoice Amount");
        DataModel.addColumn("Percent");
        DataModel.addColumn("Book Code");
        //  DataModel.addColumn("RC Voucher No");
        //  DataModel.addColumn("RC Voucher Date");
        // DataModel.addColumn("RC Fin Voucher No");
        DataModel.addColumn("Days");
        DataModel.addColumn("Debit Amount");
        DataModel.addColumn("Credit Amount");
        
    //    Table.getColumnModel().getColumnModel(1).setMaxWidth(40);
      //  TableDesc.getColumnModel().getColumn(0).setMaxWidth(50);
    }
    
    
    
      private void LCCreditDraftReport() {
        try {
           
            
            
           
            
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            objReportData.AddColumn("CNH_NO");
            objReportData.AddColumn("CNH_MAIN_ACCOUNT_CODE");
            objReportData.AddColumn("CNH_MAIN_CODE");
            objReportData.AddColumn("CNH_SUB_ACCOUNT_CODE");
            objReportData.AddColumn("CNH_PARTY_NAME");
            objReportData.AddColumn("CNH_INVOICE_AMOUNT");
            objReportData.AddColumn("CNH_LINK_NO");
            objReportData.AddColumn("CNH_CREDIT_AMOUNT");
            objReportData.AddColumn("CNH_BOOK_CODE");
            objReportData.AddColumn("CNH_EXT1");
            objReportData.AddColumn("CNH_RESON_CODE");
            objReportData.AddColumn("CNH_PERCENT");
            objReportData.AddColumn("CNH_INTERVAL_CAPTION");
           
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("CNH_NO","");
            objOpeningRow.setValue("CNH_MAIN_ACCOUNT_CODE","");
            objOpeningRow.setValue("CNH_MAIN_CODE","");
            objOpeningRow.setValue("CNH_SUB_ACCOUNT_CODE","");
            objOpeningRow.setValue("CNH_PARTY_NAME","");
            objOpeningRow.setValue("CNH_INVOICE_AMOUNT","");
            objOpeningRow.setValue("CNH_LINK_NO","");
            objOpeningRow.setValue("CNH_CREDIT_AMOUNT","");
            objOpeningRow.setValue("CNH_BOOK_CODE","");
            objOpeningRow.setValue("CNH_INTERVAL_CAPTION","");
            objOpeningRow.setValue("CNH_REASON_CODEINTERVAL_CAPTION","");
            objOpeningRow.setValue("CNH_PERCENT","");
           
            String strSQL = "SELECT CNH_NO,CNH_MAIN_ACCOUNT_CODE,CNH_MAIN_CODE,CNH_REASON_CODE,CNH_PERCENT,CNH_SUB_ACCOUNT_CODE,CONCAT(CNH_PARTY_NAME,',',CNH_CITY) AS CNH_PARTY_NAME,CNH_INVOICE_AMOUNT,CNH_LINK_NO,CNH_CREDIT_AMOUNT,CNH_BOOK_CODE,CONCAT('FELT CASH DISCOUNT : ', CNH_INTERVAL_CAPTION) AS CNH_INTERVAL_CAPTION FROM PRODUCTION.D_CREDIT_NOTE_HEADER WHERE CNH_YEAR_MON_ID = SUBSTRING('" +txtInterval.getText()+"',1,12) AND CNH_TYPE='FELTCASH' ORDER BY CNH_SUB_ACCOUNT_CODE ";
            System.out.println(strSQL);
            
         
            
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();
                    
                    objRow.setValue("CNH_NO",UtilFunctions.getString(rsTmp,"CNH_NO",""));
                    objRow.setValue("CNH_MAIN_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CNH_MAIN_ACCOUNT_CODE",""));
                    objRow.setValue("CNH_MAIN_CODE",UtilFunctions.getString(rsTmp,"CNH_MAIN_CODE",""));
                    objRow.setValue("CNH_SUB_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CNH_SUB_ACCOUNT_CODE",""));
                    objRow.setValue("CNH_PARTY_NAME",UtilFunctions.getString(rsTmp,"CNH_PARTY_NAME",""));
                    objRow.setValue("CNH_INVOICE_AMOUNT",UtilFunctions.getString(rsTmp,"CNH_INVOICE_AMOUNT",""));
                    // objRow.setValue("CND_INVOICE_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"CND_INVOICE_DATE","")));
                    objRow.setValue("CNH_LINK_NO",UtilFunctions.getString(rsTmp,"CNH_LINK_NO",""));
                    objRow.setValue("CNH_CREDIT_AMOUNT",UtilFunctions.getString(rsTmp,"CNH_CREDIT_AMOUNT",""));
                    objRow.setValue("CNH_BOOK_CODE",UtilFunctions.getString(rsTmp,"CNH_BOOK_CODE",""));
                    objRow.setValue("CNH_INTERVAL_CAPTION",UtilFunctions.getString(rsTmp,"CNH_INTERVAL_CAPTION",""));
                    objRow.setValue("CNH_REASON_CODE",UtilFunctions.getString(rsTmp,"CNH_REASON_CODE",""));
                    objRow.setValue("CNH_PERCENT",UtilFunctions.getString(rsTmp,"CNH_PERCENT",""));
                 
                    
                    
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
                }
            }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
            //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
            // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
            // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
         objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/Felt_Credit_Note/rpt_CN_Draft.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
    
    
       
    private void ControlLCDiscount()
    {
        try{
            Connection conn=data.getConn();
            Statement stmt=conn.createStatement();
            
         stmt.execute("TRUNCATE TABLE PRODUCTION.TMP_LC_CREDITNOTETEST");
            
         stmt.execute("INSERT INTO PRODUCTION.TMP_LC_CREDITNOTETEST SELECT A.VOUCHER_NO,VOUCHER_DATE,MAIN_ACCOUNT_CODE,SUB_ACCOUNT_CODE,EFFECT,INVOICE_NO,INVOICE_DATE,INVOICE_AMOUNT,AMOUNT,GRN_NO,GRN_DATE, '0000-00-00',A.LINK_NO,'0000-00-00','0000-00-00','0000-00-00',MATCHED_DATE,MATCHED,  '','','',    '','','',    '','','',    '','','',    '','','',    '','','',    '','','',  BOOK_CODE,'',0,0,0,0,0,LC_OPENER_CODE FROM FINANCE.D_FIN_VOUCHER_DETAIL A,FINANCE.D_FIN_VOUCHER_HEADER B,(SELECT PARTY_CODE,LC_OPENER_CODE,MAX(EXP_DATE) AS EXP_DATE  FROM  DINESHMILLS.D_SAL_POLICY_LC_MASTER A GROUP BY PARTY_CODE,LC_OPENER_CODE) AS C WHERE A.VOUCHER_NO = B.VOUCHER_NO AND B.CANCELLED =0 AND B.APPROVED =1 AND SUB_ACCOUNT_CODE =PARTY_CODE AND VOUCHER_DATE >='2015-01-01' AND SUBSTRING(A.VOUCHER_NO,1,2) = 'SJ' AND MAIN_ACCOUNT_CODE =210027 LIMIT 10000000000");
            
         stmt.execute("DELETE FROM PRODUCTION.TMP_LC_CREDITNOTETEST WHERE SUBSTRING(LCN_SUB_ACCOUNT_CODE,3,2) = 99");
            
         stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST ,DINESHMILLS.D_SAL_INVOICE_HEADER SET LCN_CHARGE_CODE = PAYMENT_TERM_CODE WHERE LCN_INVOICE_NO  = INVOICE_NO AND  LCN_INVOICE_DATE  = INVOICE_DATE");
            
         stmt.execute("DELETE FROM PRODUCTION.TMP_LC_CREDITNOTETEST WHERE SUBSTRING(LCN_CHARGE_CODE,1,1)  IN (1,2,3,4,5,6,8,9)");
            
         stmt.execute("UPDATE PRODUCTION.TMP_LC_CREDITNOTETEST,PRODUCTION.D_CREDIT_NOTE_DETAIL SET LCN_RC_VOUCHER = CND_RC_VOUCHER_NO,LCN_YEAR_MON_ID = CND_YEAR_MON_ID  WHERE LCN_LINK_NO = CND_LINK_NO");
            
         stmt.execute("UPDATE  PRODUCTION.TMP_LC_CREDITNOTETEST,DINESHMILLS.D_SAL_PARTY_MASTER SET LCN_LC_NAME = PARTY_NAME WHERE PARTY_CODE = LCN_SUB_ACCOUNT_CODE");
  
         stmt.execute("UPDATE  PRODUCTION.TMP_LC_CREDITNOTETEST,DINESHMILLS.D_SAL_PARTY_MASTER SET EXT1 = PARTY_NAME WHERE PARTY_CODE = LCN_LC_OPENER");
         
   
         stmt.execute("DELETE FROM PRODUCTION.TMP_LC_CREDITNOTETEST WHERE LCN_YEAR_MON_ID!=''");
            
         stmt.execute("DELETE FROM PRODUCTION.TMP_LC_CREDITNOTETEST WHERE LCN_INVOICE_DATE <'2015-04-01' AND LCN_MATCHED =1");
         
                
     
          TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            objReportData.AddColumn("LCN_NO");
            objReportData.AddColumn("LCN_MAIN_ACCOUNT_CODE");
            objReportData.AddColumn("LCN_SUB_ACCOUNT_CODE");
            objReportData.AddColumn("LCN_LC_NAME");
            objReportData.AddColumn("EXT1");
             objReportData.AddColumn("LCN_LINK_NO");
            objReportData.AddColumn("LCN_INVOICE_NO");
            objReportData.AddColumn("LCN_INVOICE_DATE");
            objReportData.AddColumn("LCN_LC_OPENER");
            objReportData.AddColumn("LCN_AMOUNT");
            objReportData.AddColumn("LCN_MATCHED");
            objReportData.AddColumn("LCN_MATCHED_DATE");
    
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("LCN_NO","");
            objOpeningRow.setValue("LCN_MAIN_ACCOUNT_CODE","");
            objOpeningRow.setValue("LCN_SUB_ACCOUNT_CODE","");
            objOpeningRow.setValue("LCN_LC_NAME","");
            objOpeningRow.setValue("EXT1","");
            objOpeningRow.setValue("LCN_LC_OPENER","");
            objOpeningRow.setValue("LCN_LINK_NO","");
            objOpeningRow.setValue("LCN_INVOICE_NO","");
            objOpeningRow.setValue("LCN_INVOICE_DATE","");
            objOpeningRow.setValue("LCN_AMOUNT","");
            objOpeningRow.setValue("LCN_MATCHED","");
            objOpeningRow.setValue("CNH_MATCHED_DATE","");
           
            
            String strSQL = "SELECT LCN_MAIN_ACCOUNT_CODE,LCN_SUB_ACCOUNT_CODE,LCN_LC_NAME,LCN_LINK_NO,LCN_INVOICE_DATE,LCN_INVOICE_NO,LCN_LC_OPENER ,EXT1,LCN_AMOUNT,LCN_MATCHED,LCN_MATCHED_DATE,LCN_NO FROM PRODUCTION.TMP_LC_CREDITNOTETEST ORDER BY LCN_LC_OPENER,LCN_SUB_ACCOUNT_CODE,LCN_INVOICE_DATE,LCN_LINK_NO";
            System.out.println(strSQL);
            
         
            
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();
                    
                    objRow.setValue("LCN_NO",UtilFunctions.getString(rsTmp,"LCN_NO",""));
                    objRow.setValue("LCN_MAIN_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"LCN_MAIN_ACCOUNT_CODE",""));
                    objRow.setValue("LCN_SUB_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"LCN_SUB_ACCOUNT_CODE",""));
                    objRow.setValue("LCN_LC_NAME",UtilFunctions.getString(rsTmp,"LCN_LC_NAME",""));
                    objRow.setValue("LCN_LC_OPENER",UtilFunctions.getString(rsTmp,"LCN_LC_OPENER",""));
                    objRow.setValue("EXT1",UtilFunctions.getString(rsTmp,"EXT1",""));
  
                    objRow.setValue("LCN_LINK_NO",UtilFunctions.getString(rsTmp,"LCN_LINK_NO",""));
                    objRow.setValue("LCN_INVOICE_NO",UtilFunctions.getString(rsTmp,"LCN_INVOICE_NO",""));
                    objRow.setValue("LCN_INVOICE_DATE",UtilFunctions.getString(rsTmp,"LCN_INVOICE_DATE",""));
                    objRow.setValue("LCN_AMOUNT",UtilFunctions.getString(rsTmp,"LCN_AMOUNT",""));
                    objRow.setValue("LCN_MATCHED",UtilFunctions.getString(rsTmp,"LCN_MATCHED",""));
                    objRow.setValue("LCN_MATCHED_DATE",UtilFunctions.getString(rsTmp,"LCN_MATCHED_DATE",""));
                    
                    
                    
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
                }
            }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
            //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
            // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
            // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
         objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/sales/rptLCCONTROL.rpt",Parameters,objReportData);
            
             
         
         
         
         
         
         
         
         
         
         
         
         
         
         
                        
        }catch(SQLException e){e.printStackTrace();}
        
    }
    
    private void SetData() {
        
        if(txtVoucherNo.isEnabled()) {
            objVoucher.UseSpecificVoucherNo=true;
            objVoucher.SpecificVoucherNo=txtVoucherNo.getText();
        }
        else {
            objVoucher.UseSpecificVoucherNo=false;
        }
        objVoucher.setAttribute("VOUCHER_NO",txtVoucherNo.getText());
    }
    
    private void DraftReport() {
        try {
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            objReportData.AddColumn("CND_NO");
            objReportData.AddColumn("CND_MAIN_ACCOUNT_NAME");
            objReportData.AddColumn("CND_MAIN_ACCOUNT_CODE");
            objReportData.AddColumn("CND_SUB_ACCOUNT_CODE");
            objReportData.AddColumn("CND_LINK_NO");
            objReportData.AddColumn("CND_LINK_YEAR");
            objReportData.AddColumn("CND_INVOICE_DATE");
            objReportData.AddColumn("CND_INVOICE_AMOUNT");
            objReportData.AddColumn("CND_CHARGE_CODE");
            objReportData.AddColumn("CND_PERCENT");
            objReportData.AddColumn("CND_DEBIT_AMOUNT");
            objReportData.AddColumn("CND_CREDIT_AMOUNT");
            objReportData.AddColumn("CND_VALUE_DATE");
            objReportData.AddColumn("CND_INTERVAL_CAPTION");
            objReportData.AddColumn("CND_RC_VOUCHER_NO");
            objReportData.AddColumn("CND_RC_VOUCHER_DATE");
            objReportData.AddColumn("CND_DAYS");
            objReportData.AddColumn("CND_CATG");
            objReportData.AddColumn("CND_FIN_VOUCHER_NO");
            objReportData.AddColumn("CND_BOOK_CODE");
            objReportData.AddColumn("VL");
            objReportData.AddColumn("LL");
            
            
            
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("CND_NO","");
            objOpeningRow.setValue("CND_MAIN_ACCOUNT_NAME","");
            objOpeningRow.setValue("CND_MAIN_ACCOUNT_CODE","");
            objOpeningRow.setValue("CND_SUB_ACCOUNT_CODE","");
            objOpeningRow.setValue("CND_LINK_NO","");
            objOpeningRow.setValue("CND_LINK_YEAR","");
            objOpeningRow.setValue("CND_INVOICE_DATE","");
            objOpeningRow.setValue("CND_INVOICE_AMOUNT",""); 
            objOpeningRow.setValue("CND_CHARGE_CODE","");
            objOpeningRow.setValue("CND_PERCENT","");
            objOpeningRow.setValue("CND_DEBIT_AMOUNT","");
            objOpeningRow.setValue("CND_CREDIT_AMOUNT","");
            objOpeningRow.setValue("CND_VALUE_DATE","");
            objOpeningRow.setValue("CND_INTERVAL_CAPTION","");
            objOpeningRow.setValue("CND_RC_VOUCHER_NO","");
            objOpeningRow.setValue("CND_RC_VOUCHER_DATE","");
            objOpeningRow.setValue("CND_DAYS","");
            objOpeningRow.setValue("CND_CATG","");
             objOpeningRow.setValue("CND_FIN_VOUCHER_NO","");
             objOpeningRow.setValue("CND_BOOK_CODE","");
             objOpeningRow.setValue("VL","");
             objOpeningRow.setValue("LL","");
         
           
  //         String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO, CND_LINK_YEAR, CND_INVOICE_DATE,CND_INVOICE_AMOUNT,CND_CHARGE_CODE,CND_PERCENT, CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_INVOICE_DATE>='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' AND CND_INVOICE_DATE<='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"'ORDER BY CND_VALUE_DATE,CND_NO,CND_EFFECT DESC,CND_LINK_NO+0"; 
 //          String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO, CND_LINK_YEAR, CND_INVOICE_DATE,CND_INVOICE_AMOUNT,CND_CHARGE_CODE,CND_PERCENT, CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE,CND_INTERVAL_CAPTION FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_TYPE ='CASH' AND CND_YEAR_MON_ID =SUBSTRING('" +txtInterval.getText()+"',1,8) ORDER BY CND_VALUE_DATE,CND_NO,CND_EFFECT DESC,CND_LINK_NO+0"; 
           String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO, CND_LINK_YEAR, CND_INVOICE_DATE, CND_INVOICE_AMOUNT , CND_CHARGE_CODE , CND_PERCENT,CND_BOOK_CODE, CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE,CND_INTERVAL_CAPTION,CND_RC_VOUCHER_NO,CND_RC_VOUCHER_DATE,CND_DAYS,CND_FIN_VOUCHER_NO,RIGHT(CND_INTERVAL_CAPTION,10)AS VL,LEFT(CND_LINK_NO,2)AS LL,CND_CATG    FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE CND_TYPE ='FELTCASH' AND CND_YEAR_MON_ID = SUBSTRING('" +txtInterval.getText()+"',1,12)  AND CND_CREDIT_AMOUNT !=0 UNION ALL SELECT CNH_NO,'CASH/LC DISCOUNT',CNH_MAIN_ACCOUNT_CODE,'',CNH_LINK_NO, '','', '' , '' , 0.00,'', CNH_CREDIT_AMOUNT,CNH_DEBIT_AMOUNT,CNH_VALUE_DATE,CNH_INTERVAL_CAPTION,'','','','',RIGHT(CNH_INTERVAL_CAPTION,10),'',''   FROM PRODUCTION.D_CREDIT_NOTE_HEADER WHERE CNH_TYPE ='FELTCASH' AND CNH_YEAR_MON_ID = SUBSTRING('" +txtInterval.getText()+"',1,12)  ORDER BY  CND_NO,CND_LINK_NO"; 
           System.out.println(strSQL);
        //   String strSQL = "SELECT CND_NO,CND_MAIN_ACCOUNT_NAME,CND_MAIN_ACCOUNT_CODE,CND_SUB_ACCOUNT_CODE,CND_LINK_NO, CND_LINK_YEAR, CND_INVOICE_DATE,CND_INVOICE_AMOUNT,CND_CHARGE_CODE,CND_PERCENT, CND_BOOK_CODE,CND_DEBIT_AMOUNT,CND_CREDIT_AMOUNT,CND_VALUE_DATE FROM PRODUCTION.D_CREDIT_NOTE_DETAIL WHERE ORDER BY CND_VALUE_DATE,CND_NO,CND_EFFECT DESC,CND_LINK_NO+0,CND_INVOICE_DATE>='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' AND CND_INVOICE_DATE<='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"'"; 
           
           
           // "WHERE (CND_INOVICE_DATE>= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText()) +"' "+"" +
          // "AND CND_INOVICE_DATE<= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText()) +"')"+
          // "ORDER BY CND_INOVICE_DATE";
            
            //"AND (A.RECEIPT_DATE>= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText()) +"' "+
            //"AND A.RECEIPT_DATE<= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText()) +"' ) ";
            //System.out.println("sql="+strSQL);
            
       
           ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
          if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                   objRow=objReportData.newRow();
                    
                   objRow.setValue("CND_NO",UtilFunctions.getString(rsTmp,"CND_NO",""));
                   objRow.setValue("CND_MAIN_ACCOUNT_NAME",UtilFunctions.getString(rsTmp,"CND_MAIN_ACCOUNT_NAME",""));
                   objRow.setValue("CND_MAIN_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CND_MAIN_ACCOUNT_CODE",""));
                   objRow.setValue("CND_SUB_ACCOUNT_CODE",UtilFunctions.getString(rsTmp,"CND_SUB_ACCOUNT_CODE",""));
                   objRow.setValue("CND_LINK_NO",UtilFunctions.getString(rsTmp,"CND_LINK_NO",""));
                  // objRow.setValue("CND_INVOICE_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"CND_INVOICE_DATE","")));
                   objRow.setValue("CND_LINK_YEAR",UtilFunctions.getString(rsTmp,"CND_LINK_YEAR",""));
                   objRow.setValue("CND_INVOICE_DATE",UtilFunctions.getString(rsTmp,"CND_INVOICE_DATE",""));
                   objRow.setValue("CND_INVOICE_AMOUNT",UtilFunctions.getString(rsTmp,"CND_INVOICE_AMOUNT",""));
                   objRow.setValue("CND_CHARGE_CODE",UtilFunctions.getString(rsTmp,"CND_CHARGE_CODE",""));
                   objRow.setValue("CND_PERCENT",UtilFunctions.getString(rsTmp,"CND_PERCENT",""));
                   objRow.setValue("CND_DEBIT_AMOUNT",UtilFunctions.getString(rsTmp,"CND_DEBIT_AMOUNT",""));
                   objRow.setValue("CND_CREDIT_AMOUNT",UtilFunctions.getString(rsTmp,"CND_CREDIT_AMOUNT",""));
                   objRow.setValue("CND_VALUE_DATE",UtilFunctions.getString(rsTmp,"CND_VALUE_DATE",""));
                   objRow.setValue("CND_INTERVAL_CAPTION",UtilFunctions.getString(rsTmp,"CND_INTERVAL_CAPTION",""));
                   objRow.setValue("CND_CATG",UtilFunctions.getString(rsTmp,"CND_CATG",""));
             
                   objRow.setValue("CND_RC_VOUCHER_NO",UtilFunctions.getString(rsTmp,"CND_RC_VOUCHER_NO",""));
                   objRow.setValue("CND_RC_VOUCHER_DATE",UtilFunctions.getString(rsTmp,"CND_RC_VOUCHER_DATE",""));
                   objRow.setValue("CND_DAYS",UtilFunctions.getString(rsTmp,"CND_DAYS",""));
                   objRow.setValue("CND_FIN_VOUCHER_NO",UtilFunctions.getString(rsTmp,"CND_FIN_VOUCHER_NO",""));
                   objRow.setValue("CND_BOOK_CODE",UtilFunctions.getString(rsTmp,"CND_BOOK_CODE",""));
                   objRow.setValue("VL",UtilFunctions.getString(rsTmp,"VL",""));
                   objRow.setValue("LL",UtilFunctions.getString(rsTmp,"LL",""));
                                        
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
               }
           }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
         //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
           // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
           // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
           // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
            objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/Felt_Credit_Note/rptfeltcashdraft.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
  
    
     private void GenerateCreditNoteSummary() {
       String str=IntervalComboModel.getText(cmbIntervalCombo.getSelectedIndex()).substring(0,12);
       String strfrom=IntervalComboModel.getText(cmbIntervalCombo.getSelectedIndex()).substring(21,31);
       String strto=IntervalComboModel.getText(cmbIntervalCombo.getSelectedIndex()).substring(35,45);
        System.out.println(str);
        System.out.println(strfrom);
        System.out.println(strto);
        
        try {            
            TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
            
            objData.AddColumn("CNH_SUB_ACCOUNT_CODE");            
            objData.AddColumn("CNH_PARTY_NAME");                        
            objData.AddColumn("CNH_PERCENT");
            objData.AddColumn("CNH_CREDIT_AMOUNT");                                    
            objData.AddColumn("CNH_INVOICE_AMOUNT");
            
            String strSQL="SELECT CNH_ID,CNH_NO,CNH_TYPE,CNH_MAIN_ACCOUNT_CODE,CNH_MAIN_CODE,CNH_SUB_ACCOUNT_CODE,CNH_CITY,CONCAT(CNH_PARTY_NAME,',',CNH_CITY) AS CNH_PARTY_NAME,CNH_REASON_CODE,CNH_BOOK_CODE,CNH_PERCENT,CNH_CREDIT_AMOUNT,CNH_LINK_NO,CNH_YEAR_MON_ID,CNH_INTERVAL_CAPTION,CNH_INVOICE_AMOUNT FROM PRODUCTION.D_CREDIT_NOTE_HEADER WHERE CNH_YEAR_MON_ID='"+str+"' AND CNH_TYPE='FELTCASH' ORDER BY CNH_SUB_ACCOUNT_CODE";
            ResultSet  rsTemp =data.getResult(strSQL);                    
            rsTemp.first();            
            if(rsTemp.getRow()>0){
                while(!rsTemp.isAfterLast()){
                TReportWriter.SimpleDataProvider.TRow objRow=objData.newRow();               
                
                objRow.setValue("CNH_SUB_ACCOUNT_CODE", rsTemp.getString("CNH_SUB_ACCOUNT_CODE"));
                objRow.setValue("CNH_PARTY_NAME", rsTemp.getString("CNH_PARTY_NAME"));                                                
                objRow.setValue("CNH_PERCENT", rsTemp.getString("CNH_PERCENT"));
                objRow.setValue("CNH_CREDIT_AMOUNT", rsTemp.getString("CNH_CREDIT_AMOUNT"));
                objRow.setValue("CNH_INVOICE_AMOUNT", rsTemp.getString("CNH_INVOICE_AMOUNT"));
                objData.AddRow(objRow);                
                rsTemp.next(); 
                }
            }                            
                        
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();            
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            Parameters.put("FROM_DATE",strfrom);
            Parameters.put("TO_DATE",strto);
            objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/Felt_Credit_Note/rptfeltcashSummary.rpt",Parameters,objData);                       
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
    
    
    
}
