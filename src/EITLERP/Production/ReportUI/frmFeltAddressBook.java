/*
 * frmItemMapping.java
 *
 * Created on June 23, 2005, 12:20 PM
 */

package EITLERP.Production.ReportUI;

/**
 *
 * @author  root
 */
import EITLERP.Stores.*;
import EITLERP.Purchase.*;
import javax.swing.*;
import java.awt.*;
import java.util.*;
import EITLERP.EITLTableModel;
import EITLERP.EITLERPGLOBAL;

public class frmFeltAddressBook extends javax.swing.JApplet {
    
    private EITLTableModel DataModel=new EITLTableModel();
    
    /** Initializes the applet frmItemMapping */
    public void init() {
        setSize(499,504);
        initComponents();
        GenerateGrid();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        jPanel2 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txtFullName = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        txtEMail = new javax.swing.JTextField();
        txtPartycode = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        cmdAdd = new javax.swing.JButton();
        cmdRemove = new javax.swing.JButton();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jPanel1.setLayout(null);

        jPanel1.setBackground(new java.awt.Color(0, 153, 255));
        jPanel1.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel1.setText("EMAIL ADDRESS BOOK");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(7, 8, 229, 15);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(0, 2, 501, 32);

        Table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(Table);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(6, 203, 470, 266);

        jPanel2.setLayout(null);

        jPanel2.setBorder(new javax.swing.border.EtchedBorder());
        jLabel2.setText("Full Name ");
        jPanel2.add(jLabel2);
        jLabel2.setBounds(15, 16, 69, 15);

        jPanel2.add(txtFullName);
        txtFullName.setBounds(89, 13, 240, 21);

        jLabel3.setText("E Mail");
        jPanel2.add(jLabel3);
        jLabel3.setBounds(15, 48, 69, 15);

        jPanel2.add(txtEMail);
        txtEMail.setBounds(89, 45, 240, 21);

        jPanel2.add(txtPartycode);
        txtPartycode.setBounds(90, 80, 240, 19);

        jLabel4.setText("Party Code");
        jPanel2.add(jLabel4);
        jLabel4.setBounds(5, 80, 70, 15);

        getContentPane().add(jPanel2);
        jPanel2.setBounds(4, 39, 472, 125);

        cmdAdd.setText("Add ");
        cmdAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdAddActionPerformed(evt);
            }
        });

        getContentPane().add(cmdAdd);
        cmdAdd.setBounds(294, 171, 88, 25);

        cmdRemove.setText("Remove");
        cmdRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdRemoveActionPerformed(evt);
            }
        });

        getContentPane().add(cmdRemove);
        cmdRemove.setBounds(386, 171, 88, 25);

    }//GEN-END:initComponents
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
        
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdRemoveActionPerformed
        // TODO add your handling code here:
        if(Table.getRowCount()>0&&Table.getSelectedRow()>=0) {
            if(JOptionPane.showConfirmDialog(null,"Are you sure you wat to delete selected record ?","Confirmation",JOptionPane.YES_NO_OPTION)==JOptionPane.YES_OPTION) {
                int SrNo=Integer.parseInt((String)Table.getValueAt(Table.getSelectedRow(), 0));
                clsFeltAddressBook.Delete(EITLERPGLOBAL.gCompanyID,SrNo);
                GenerateGrid();
            }
        }
    }//GEN-LAST:event_cmdRemoveActionPerformed
    
    private void cmdAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdAddActionPerformed
        // TODO add your handling code here:

        
        if(txtFullName.getText().trim().equals(""))
        {
          JOptionPane.showMessageDialog(null,"Please enter the name");
          return;
        }
        
        if(txtEMail.getText().trim().equals(""))
        {
          JOptionPane.showMessageDialog(null,"Please enter email address");
          return;
        }
        
        clsFeltAddressBook ObjItem=new clsFeltAddressBook();
        ObjItem.setAttribute("PARTY_CODE",txtPartycode.getText().trim());
        ObjItem.setAttribute("CONTACT_PERSON",txtFullName.getText().trim());
        ObjItem.setAttribute("EMAIL",txtEMail.getText().trim());
                
        if(clsFeltAddressBook.Insert(ObjItem)) {
            GenerateGrid();
        }
        else {
            JOptionPane.showMessageDialog(null,"Error occured while saving");
        }
        
    }//GEN-LAST:event_cmdAddActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable Table;
    private javax.swing.JButton cmdAdd;
    private javax.swing.JButton cmdRemove;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextField txtEMail;
    private javax.swing.JTextField txtFullName;
    private javax.swing.JTextField txtPartycode;
    // End of variables declaration//GEN-END:variables
    
    private void FormatGrid() {
        DataModel=new EITLTableModel();
        
        Table.removeAll();
        
        Table.setModel(DataModel);
        Table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        
        DataModel.addColumn("Party Code"); //0
        DataModel.addColumn("Name"); //0
        DataModel.addColumn("E Mail"); //0
        
        DataModel.SetNumeric(0,true);
                        
        DataModel.TableReadOnly(true);
    }
    
    
    private void GenerateGrid() {
        HashMap List=new HashMap();
        
        FormatGrid();
        
        List=clsFeltAddressBook.getList();
        
        for(int i=1;i<=List.size();i++) {
            clsFeltAddressBook ObjItem=(clsFeltAddressBook)List.get(Integer.toString(i));
            Object[] rowData=new Object[3];
            
            //rowData[0]=Integer.toString((int)ObjItem.getAttribute("SR_NO").getVal());
            rowData[0]=(String)ObjItem.getAttribute("PARTY_CODE").getObj();
            rowData[1]=(String)ObjItem.getAttribute("CONTACT_PERSON").getObj();
            rowData[2]=(String)ObjItem.getAttribute("EMAIL").getObj();
            
            DataModel.addRow(rowData);
        }
        
    }
    
    
}
