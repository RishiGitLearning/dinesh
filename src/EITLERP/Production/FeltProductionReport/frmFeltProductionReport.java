/*
 * frmFeltProductionReport.java
 *
 * Created on March 7, 2014, 5:02 PM
 */

package EITLERP.Production.FeltProductionReport;

import javax.swing.JOptionPane;
import java.sql.ResultSet;
import java.util.HashMap;

import EITLERP.EITLERPGLOBAL;
import EITLERP.LOV;
import EITLERP.data;

/**
 *
 * @author  Vivek Kumar
 */
public class frmFeltProductionReport extends javax.swing.JApplet {
    
    private boolean correctParty=false;
    
    /** Initializes the applet frmFeltProductionReport */
    public void init() {
        initComponents();
        setSize(410,240);
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPopupMenu = new javax.swing.JPopupMenu();
        jMenuWeaving = new javax.swing.JMenuItem();
        jMenuMending = new javax.swing.JMenuItem();
        jMenuNeedling = new javax.swing.JMenuItem();
        jMenuFinishing = new javax.swing.JMenuItem();
        lblTitle = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        txtFromDate = new EITLERP.Production.SDMLTextField(10,"DD/MM/YYYY");
        jLabel3 = new javax.swing.JLabel();
        txtToDate = new EITLERP.Production.SDMLTextField(10,"DD/MM/YYYY");
        cmdReport = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        txtPartyCode = new EITLERP.Production.SDMLTextField(6,"PRESS F1");
        lblPartyName = new javax.swing.JLabel();

        jPopupMenu.setLightWeightPopupEnabled(false);
        jMenuWeaving.setText("Weaving");
        jMenuWeaving.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuWeavingActionPerformed(evt);
            }
        });

        jPopupMenu.add(jMenuWeaving);

        jMenuMending.setText("Mending");
        jMenuMending.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuMendingActionPerformed(evt);
            }
        });

        jPopupMenu.add(jMenuMending);

        jMenuNeedling.setText("Needling");
        jMenuNeedling.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuNeedlingActionPerformed(evt);
            }
        });

        jPopupMenu.add(jMenuNeedling);

        jMenuFinishing.setText("Finishing");
        jMenuFinishing.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuFinishingActionPerformed(evt);
            }
        });

        jPopupMenu.add(jMenuFinishing);

        getContentPane().setLayout(null);

        setBackground(new java.awt.Color(204, 204, 204));
        lblTitle.setBackground(new java.awt.Color(0, 102, 153));
        lblTitle.setForeground(java.awt.Color.white);
        lblTitle.setText("FELT PRODUCTION REPORT");
        lblTitle.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        lblTitle.setOpaque(true);
        getContentPane().add(lblTitle);
        lblTitle.setBounds(0, 0, 420, 25);

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("From Date");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(10, 41, 65, 20);

        txtFromDate.setFont(new java.awt.Font("Dialog", 1, 12));
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(80, 40, 100, 20);

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("To Date");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(210, 40, 50, 20);

        txtToDate.setFont(new java.awt.Font("Dialog", 1, 12));
        getContentPane().add(txtToDate);
        txtToDate.setBounds(265, 40, 100, 20);

        cmdReport.setText("View Report");
        cmdReport.setMargin(new java.awt.Insets(2, 2, 2, 2));
        cmdReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdReportActionPerformed(evt);
            }
        });

        getContentPane().add(cmdReport);
        cmdReport.setBounds(265, 70, 100, 25);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("Party code");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(10, 75, 65, 20);

        txtPartyCode.setFont(new java.awt.Font("Dialog", 1, 12));
        txtPartyCode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtPartyCodeKeyPressed(evt);
            }
        });

        getContentPane().add(txtPartyCode);
        txtPartyCode.setBounds(80, 75, 100, 20);

        lblPartyName.setFont(new java.awt.Font("Dialog", 1, 10));
        lblPartyName.setForeground(new java.awt.Color(51, 51, 255));
        getContentPane().add(lblPartyName);
        lblPartyName.setBounds(80, 100, 280, 20);

    }//GEN-END:initComponents
    
    private void txtPartyCodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPartyCodeKeyPressed
        try {
            if(evt.getKeyCode()==112){ //F1 Key pressed
                LOV aList=new LOV();
                aList.SQL="SELECT PARTY_CODE, PARTY_NAME FROM D_SAL_PARTY_MASTER WHERE MAIN_ACCOUNT_CODE=210010 AND APPROVED=1 AND CANCELLED=0";
                aList.ReturnCol=1;
                aList.SecondCol=2; //to get Second Value
                aList.ShowReturnCol=true;
                aList.DefaultSearchOn=1;
                
                if(aList.ShowLOV()) {
                    txtPartyCode.setText(aList.ReturnVal);
                    lblPartyName.setText(aList.SecondVal);
                }
            }
        }catch(Exception e){
            e.printStackTrace();
        }
    }//GEN-LAST:event_txtPartyCodeKeyPressed
    
    private void jMenuFinishingActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuFinishingActionPerformed
        new Thread(){
            public void run(){
                printFinishingReport(EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()),EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()), txtPartyCode.getText().trim());
            }}.start();
    }//GEN-LAST:event_jMenuFinishingActionPerformed
    
    private void jMenuNeedlingActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuNeedlingActionPerformed
        new Thread(){
            public void run(){
                printNeedlingReport(EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()),EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()), txtPartyCode.getText().trim());
            }}.start();
    }//GEN-LAST:event_jMenuNeedlingActionPerformed
    
    private void jMenuMendingActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuMendingActionPerformed
        new Thread(){
            public void run(){
                printMendingReport(EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()),EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()), txtPartyCode.getText().trim());
            }}.start();
    }//GEN-LAST:event_jMenuMendingActionPerformed
    
    private void jMenuWeavingActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuWeavingActionPerformed
        new Thread(){
            public void run(){
                printWeavingReport(EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()),EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()), txtPartyCode.getText().trim());
            }}.start();
    }//GEN-LAST:event_jMenuWeavingActionPerformed
    
    private void cmdReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdReportActionPerformed
        String fromDate=txtFromDate.getText().trim();
        String toDate=txtToDate.getText().trim();
        String partyCode=txtPartyCode.getText().trim();
        correctParty=false;
        
        if(!fromDate.equals("") && EITLERPGLOBAL.isDate(fromDate) && !toDate.equals("") && EITLERPGLOBAL.isDate(toDate) && java.sql.Date.valueOf(EITLERPGLOBAL.formatDateDB(fromDate)).compareTo(java.sql.Date.valueOf(EITLERPGLOBAL.formatDateDB(toDate)))<=0){
            if((!partyCode.equals(null) || !partyCode.equals("")) && partyCode.length()==6 && EITLERP.clsSales_Party.IsPartyExistEx(2,partyCode)){
                correctParty=true;
            }else if(partyCode.length()>=1) JOptionPane.showMessageDialog(this,"Enter Correct Party Code.","Wrong Party Code",JOptionPane.ERROR_MESSAGE);
            
            jPopupMenu.show(cmdReport, getX(),cmdReport.getHeight());
        } else JOptionPane.showMessageDialog(this,"Enter Correct Date.","Wrong Date",JOptionPane.ERROR_MESSAGE);
    }//GEN-LAST:event_cmdReportActionPerformed
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cmdReport;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JMenuItem jMenuFinishing;
    private javax.swing.JMenuItem jMenuMending;
    private javax.swing.JMenuItem jMenuNeedling;
    private javax.swing.JMenuItem jMenuWeaving;
    private javax.swing.JPopupMenu jPopupMenu;
    private javax.swing.JLabel lblPartyName;
    private javax.swing.JLabel lblTitle;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtPartyCode;
    private javax.swing.JTextField txtToDate;
    // End of variables declaration//GEN-END:variables
    
    private void printFinishingReport(String fromDate, String toDate, String partyCode){
        TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
        
        objData.AddColumn("SR_NO");
        objData.AddColumn("PRODUCTION_DATE");
        objData.AddColumn("PIECE_NO");
        objData.AddColumn("PRODUCT_CODE");
        objData.AddColumn("ITEM_DESC");
        objData.AddColumn("STYLE");
        objData.AddColumn("GROUP");
        objData.AddColumn("SYN_PER");
        objData.AddColumn("PARTY_CODE");
        objData.AddColumn("PARTY_NAME");
        objData.AddColumn("LENGTH");
        objData.AddColumn("WIDTH");
        objData.AddColumn("WEIGHT");
        
        try{
            TReportWriter.SimpleDataProvider.TRow objRow=objData.newRow();
            
            objRow=objData.newRow();
            objRow.setValue("SR_NO", "");
            objRow.setValue("PRODUCTION_DATE","0000-00-00");
            objRow.setValue("PIECE_NO", "");
            objRow.setValue("PRODUCT_CODE", "");
            objRow.setValue("ITEM_DESC", "");
            objRow.setValue("STYLE", "");
            objRow.setValue("GROUP", "");
            objRow.setValue("SYN_PER", "");
            objRow.setValue("PARTY_CODE", "");
            objRow.setValue("PARTY_NAME", "");
            objRow.setValue("LENGTH", "");
            objRow.setValue("WIDTH", "");
            objRow.setValue("WEIGHT", "");
            
            String condi="";
            if(correctParty) condi=" AND PROD_PARTY_CODE='"+txtPartyCode.getText().trim()+"'";
            
            String str ="SELECT PROD_DATE,PROD_PIECE_NO,SYN_PER,STYLE,GRUP,PRODUCT_CODE,ITEM_DESC,PROD_PARTY_CODE,PARTY_NAME,LENGTH,WIDTH,WEIGHT FROM "+
            "(SELECT PROD_DATE,REPLACE(PROD_PIECE_NO,' ','') PROD_PIECE_NO,PROD_PARTY_CODE,LENGTH,WIDTH,WEIGHT FROM PRODUCTION.FELT_PROD_DATA A WHERE PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"' AND PROD_DEPT='FINISHING' "+condi+") D "+ //AND APPROVED=1
            "LEFT JOIN (SELECT REPLACE(BALNK,' ','') AS STYLE,PRODUCT_CODE,PIECE_NO,PARTY_CD FROM PRODUCTION.FELT_ORDER_MASTER) O ON O.PARTY_CD = D.PROD_PARTY_CODE AND O.PIECE_NO +0 = D.PROD_PIECE_NO +0 "+
            "LEFT JOIN (SELECT PARTY_CODE,SUBSTRING(TRIM(PARTY_NAME),1,34) PARTY_NAME FROM DINESHMILLS.D_SAL_PARTY_MASTER) AS P ON P.PARTY_CODE = D.PROD_PARTY_CODE "+
            "LEFT JOIN (SELECT ITEM_CODE,ITEM_DESC,SYN_PER,GRUP FROM PRODUCTION.FELT_RATE_MASTER) AS R ON SUBSTRING(ITEM_CODE,1,6)=PRODUCT_CODE "+
            "ORDER BY PROD_DATE,PROD_PIECE_NO+0,PROD_PARTY_CODE";
            
            ResultSet  rsTemp =data.getResult(str);
            int counter=1;
            if(rsTemp.getRow()>0)
                while(!rsTemp.isAfterLast()){
                    objRow=objData.newRow();
                    objRow.setValue("SR_NO", String.valueOf(counter));
                    objRow.setValue("PRODUCTION_DATE", EITLERPGLOBAL.formatDate(rsTemp.getString("PROD_DATE")));
                    objRow.setValue("PIECE_NO", rsTemp.getString("PROD_PIECE_NO"));
                    objRow.setValue("PRODUCT_CODE", rsTemp.getString("PRODUCT_CODE"));
                    objRow.setValue("ITEM_DESC", rsTemp.getString("ITEM_DESC"));
                    objRow.setValue("STYLE", rsTemp.getString("STYLE"));
                    objRow.setValue("GROUP", rsTemp.getString("GRUP"));
                    objRow.setValue("SYN_PER", rsTemp.getString("SYN_PER"));
                    objRow.setValue("PARTY_CODE", rsTemp.getString("PROD_PARTY_CODE"));
                    objRow.setValue("PARTY_NAME", rsTemp.getString("PARTY_NAME"));
                    objRow.setValue("LENGTH", rsTemp.getString("LENGTH"));
                    objRow.setValue("WIDTH", rsTemp.getString("WIDTH"));
                    objRow.setValue("WEIGHT", rsTemp.getString("WEIGHT"));
                    
                    objData.AddRow(objRow);
                    counter++;
                    rsTemp.next();
                }
            
            HashMap param=new HashMap();
            param.put("FROM_DATE",EITLERPGLOBAL.formatDate(fromDate));
            param.put("TO_DATE",EITLERPGLOBAL.formatDate(toDate));
            
            EITLERPGLOBAL.PAGE_BREAK=true;
            if(!correctParty) new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltFinishingProduction.rpt",param,objData);
            else new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltFinishingProductionPartyWise.rpt",param,objData);
            
            correctParty=false;
        }catch(Exception e) {
            e.printStackTrace();
        }
    }
    
    private void printNeedlingReport(String fromDate, String toDate, String partyCode){
        TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
        
        objData.AddColumn("SR_NO");
        objData.AddColumn("PRODUCTION_DATE");
        objData.AddColumn("PIECE_NO");
        objData.AddColumn("PARTY_CODE");
        objData.AddColumn("PARTY_NAME");
        objData.AddColumn("WEIGHT");
        
        try{
            TReportWriter.SimpleDataProvider.TRow objRow=objData.newRow();
            
            objRow=objData.newRow();
            objRow.setValue("SR_NO", "");
            objRow.setValue("PRODUCTION_DATE","0000-00-00");
            objRow.setValue("PIECE_NO", "");
            objRow.setValue("PARTY_CODE", "");
            objRow.setValue("PARTY_NAME", "");
            objRow.setValue("WEIGHT", "");
            
            String condi="";
            if(correctParty) condi=" AND PROD_PARTY_CODE='"+txtPartyCode.getText().trim()+"'";
            
            String str ="SELECT PROD_DATE,PROD_PIECE_NO,PROD_PARTY_CODE,PARTY_NAME,WEIGHT FROM "+
            "(SELECT PROD_DATE,REPLACE(REPLACE(PROD_PIECE_NO,' ',''),'-','') PROD_PIECE_NO,PROD_PARTY_CODE,WEIGHT FROM PRODUCTION.FELT_PROD_DATA A WHERE PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"' AND PROD_DEPT='NEEDLING' AND APPROVED=1"+condi+") D "+
            "LEFT JOIN (SELECT PARTY_CODE,SUBSTRING(TRIM(PARTY_NAME),1,40) PARTY_NAME FROM DINESHMILLS.D_SAL_PARTY_MASTER) AS P ON P.PARTY_CODE = D.PROD_PARTY_CODE "+
            "ORDER BY PROD_DATE,PROD_PIECE_NO+0,PROD_PARTY_CODE";
            
            ResultSet  rsTemp =data.getResult(str);
            int counter=1;
            if(rsTemp.getRow()>0)
                while(!rsTemp.isAfterLast()){
                    objRow=objData.newRow();
                    objRow.setValue("SR_NO", String.valueOf(counter));
                    objRow.setValue("PRODUCTION_DATE", EITLERPGLOBAL.formatDate(rsTemp.getString("PROD_DATE")));
                    objRow.setValue("PIECE_NO", rsTemp.getString("PROD_PIECE_NO"));
                    objRow.setValue("PARTY_CODE", rsTemp.getString("PROD_PARTY_CODE"));
                    objRow.setValue("PARTY_NAME", rsTemp.getString("PARTY_NAME"));
                    objRow.setValue("WEIGHT", rsTemp.getString("WEIGHT"));
                    
                    objData.AddRow(objRow);
                    counter++;
                    rsTemp.next();
                }
            
            HashMap param=new HashMap();
            param.put("FROM_DATE",EITLERPGLOBAL.formatDate(fromDate));
            param.put("TO_DATE",EITLERPGLOBAL.formatDate(toDate));
            
            EITLERPGLOBAL.PAGE_BREAK=true;
            if(!correctParty) new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltNeedlingProduction.rpt",param,objData);
            else new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltNeedlingProductionPartyWise.rpt",param,objData);
            
            correctParty=false;
        }catch(Exception e) {
            e.printStackTrace();
        }
    }
    
    private void printMendingReport(String fromDate, String toDate, String partyCode){
        TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
        
        objData.AddColumn("SR_NO");
        objData.AddColumn("PRODUCTION_DATE");
        objData.AddColumn("PIECE_NO");
        objData.AddColumn("PARTY_CODE");
        objData.AddColumn("PARTY_NAME");
        objData.AddColumn("STYLE");
        objData.AddColumn("GROUP");
        objData.AddColumn("SYN_PER");
        objData.AddColumn("WEIGHT");
        objData.AddColumn("BASE_WEIGHT");
        objData.AddColumn("CLOTH_WEIGHT");
        
        try{
            TReportWriter.SimpleDataProvider.TRow objRow=objData.newRow();
            
            objRow=objData.newRow();
            objRow.setValue("SR_NO", "");
            objRow.setValue("PRODUCTION_DATE","0000-00-00");
            objRow.setValue("PIECE_NO", "");
            objRow.setValue("PARTY_CODE", "");
            objRow.setValue("PARTY_NAME", "");
            objRow.setValue("STYLE", "");
            objRow.setValue("GROUP", "");
            objRow.setValue("SYN_PER", "");
            objRow.setValue("WEIGHT", "");
            objRow.setValue("BASE_WEIGHT", "");
            objRow.setValue("CLOTH_WEIGHT", "");
            
            String condi="";
            if(correctParty) condi=" AND PROD_PARTY_CODE='"+txtPartyCode.getText().trim()+"'";
            
            String str ="SELECT PROD_DATE,PROD_PIECE_NO,STYLE,WEIGHT,GRUP,SYN_PER,PROD_PARTY_CODE,PARTY_NAME,BASE_WEIGHT,CLOTH_WEIGHT FROM "+
            "(SELECT PROD_DATE,REPLACE(PROD_PIECE_NO,' ','') PROD_PIECE_NO,PROD_PARTY_CODE,WEIGHT FROM PRODUCTION.FELT_PROD_DATA A WHERE PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"' AND PROD_DEPT='MENDING' AND APPROVED=1"+condi+") D "+
            "LEFT JOIN (SELECT REPLACE(BALNK,' ','') AS STYLE,PRODUCT_CODE,PIECE_NO,PARTY_CD FROM PRODUCTION.FELT_ORDER_MASTER) O ON O.PARTY_CD = D.PROD_PARTY_CODE AND O.PIECE_NO +0 = D.PROD_PIECE_NO +0 "+
            "LEFT JOIN (SELECT PARTY_CODE,SUBSTRING(TRIM(PARTY_NAME),1,57) PARTY_NAME FROM DINESHMILLS.D_SAL_PARTY_MASTER) AS P ON P.PARTY_CODE = D.PROD_PARTY_CODE "+
            "LEFT JOIN (SELECT COALESCE(SUM(WEIGHT),0) AS BASE_WEIGHT FROM (SELECT BALNK AS STYLE, A.WEIGHT FROM PRODUCTION.FELT_PROD_DATA A, PRODUCTION.FELT_ORDER_MASTER B WHERE PIECE_NO +0 = PROD_PIECE_NO +0 AND  PROD_DEPT='MENDING' AND PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"'  AND APPROVED=1"+condi+") AS O WHERE SUBSTRING(O.STYLE,1,3) IN('XY','XYA','Y')) AS BW ON O.PARTY_CD = D.PROD_PARTY_CODE "+
            "LEFT JOIN (SELECT COALESCE(SUM(WEIGHT),0) AS CLOTH_WEIGHT FROM (SELECT BALNK AS STYLE, A.WEIGHT FROM PRODUCTION.FELT_PROD_DATA A, PRODUCTION.FELT_ORDER_MASTER B WHERE PIECE_NO +0 = PROD_PIECE_NO +0 AND PROD_DEPT='MENDING' AND PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"'  AND APPROVED=1"+condi+") AS O WHERE SUBSTRING(O.STYLE,1,3) NOT IN('XY','XYA','Y')) AS CW ON O.PARTY_CD = D.PROD_PARTY_CODE "+
            "LEFT JOIN (SELECT ITEM_CODE,SYN_PER,GRUP FROM PRODUCTION.FELT_RATE_MASTER) AS R ON SUBSTRING(ITEM_CODE,1,6)=PRODUCT_CODE "+
            "ORDER BY PROD_DATE,PROD_PIECE_NO+0,PROD_PARTY_CODE";
            
            ResultSet  rsTemp =data.getResult(str);
            int counter=1;
            if(rsTemp.getRow()>0)
                while(!rsTemp.isAfterLast()){
                    objRow=objData.newRow();
                    objRow.setValue("SR_NO", String.valueOf(counter));
                    objRow.setValue("PRODUCTION_DATE", EITLERPGLOBAL.formatDate(rsTemp.getString("PROD_DATE")));
                    objRow.setValue("PIECE_NO", rsTemp.getString("PROD_PIECE_NO"));
                    objRow.setValue("PARTY_CODE", rsTemp.getString("PROD_PARTY_CODE"));
                    objRow.setValue("PARTY_NAME", rsTemp.getString("PARTY_NAME"));
                    objRow.setValue("STYLE", rsTemp.getString("STYLE"));
                    objRow.setValue("GROUP", rsTemp.getString("GRUP"));
                    objRow.setValue("SYN_PER", rsTemp.getString("SYN_PER"));
                    objRow.setValue("WEIGHT", rsTemp.getString("WEIGHT"));
                    objRow.setValue("BASE_WEIGHT", rsTemp.getString("BASE_WEIGHT"));
                    objRow.setValue("CLOTH_WEIGHT", rsTemp.getString("CLOTH_WEIGHT"));
                    
                    objData.AddRow(objRow);
                    counter++;
                    rsTemp.next();
                }
            
            HashMap param=new HashMap();
            param.put("FROM_DATE",EITLERPGLOBAL.formatDate(fromDate));
            param.put("TO_DATE",EITLERPGLOBAL.formatDate(toDate));
            
            EITLERPGLOBAL.PAGE_BREAK=true;
            if(!correctParty) new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltMendingProduction.rpt",param,objData);
            else new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltMendingProductionPartyWise.rpt",param,objData);
            
            correctParty=false;
        }catch(Exception e) {
            e.printStackTrace();
        }
    }
    
    private void printWeavingReport(String fromDate, String toDate, String partyCode){
        
        TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
        
        objData.AddColumn("SR_NO");
        objData.AddColumn("PRODUCTION_DATE");
        objData.AddColumn("PIECE_NO");
        objData.AddColumn("PARTY_CODE");
        objData.AddColumn("PARTY_NAME");
        objData.AddColumn("STYLE");
        objData.AddColumn("GROUP");
        objData.AddColumn("LENGTH");
        objData.AddColumn("WEIGHT");
        objData.AddColumn("PICKS_PER_10CMS");
        objData.AddColumn("REED_SPACE");
        objData.AddColumn("LOOM_NO");
        objData.AddColumn("BASE_WEIGHT");
        objData.AddColumn("CLOTH_WEIGHT");
        
        try{
            TReportWriter.SimpleDataProvider.TRow objRow=objData.newRow();
            
            objRow=objData.newRow();
            objRow.setValue("SR_NO", "");
            objRow.setValue("PRODUCTION_DATE","0000-00-00");
            objRow.setValue("PIECE_NO", "");
            objRow.setValue("PARTY_CODE", "");
            objRow.setValue("PARTY_NAME", "");
            objRow.setValue("STYLE", "");
            objRow.setValue("GROUP", "");
            objRow.setValue("SYN_PER", "");
            objRow.setValue("LENGTH", "");
            objRow.setValue("WEIGHT", "");
            objRow.setValue("PICKS_PER_10CMS", "");
            objRow.setValue("REED_SPACE", "");
            objRow.setValue("LOOM_NO", "");
            objRow.setValue("BASE_WEIGHT", "");
            objRow.setValue("CLOTH_WEIGHT", "");
            
            String condi="";
            if(correctParty) condi=" AND PROD_PARTY_CODE='"+txtPartyCode.getText().trim()+"'";
            
            String str ="SELECT PROD_DATE,PROD_PIECE_NO,STYLE,WEIGHT,PICKS_PER_10CMS,REED_SPACE,LENGTH,LOOM_NO,GRUP,PROD_PARTY_CODE,PARTY_NAME,BASE_WEIGHT,CLOTH_WEIGHT FROM "+
            "(SELECT PROD_DATE,REPLACE(PROD_PIECE_NO,' ','') PROD_PIECE_NO,PROD_PARTY_CODE,WEIGHT,PICKS_PER_10CMS,REED_SPACE,LENGTH,LOOM_NO FROM PRODUCTION.FELT_PROD_DATA A WHERE PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"' AND PROD_DEPT='WEAVING' AND APPROVED=1"+condi+") D "+
            "LEFT JOIN (SELECT REPLACE(BALNK,' ','') AS STYLE,GRUP, PRODUCT_CODE,PIECE_NO,PARTY_CD FROM PRODUCTION.FELT_ORDER_MASTER) O ON O.PARTY_CD = D.PROD_PARTY_CODE AND O.PIECE_NO +0 = D.PROD_PIECE_NO +0 "+
            "LEFT JOIN (SELECT PARTY_CODE,SUBSTRING(TRIM(PARTY_NAME),1,44) PARTY_NAME FROM DINESHMILLS.D_SAL_PARTY_MASTER) AS P ON P.PARTY_CODE = D.PROD_PARTY_CODE "+
            "LEFT JOIN (SELECT COALESCE(SUM(WEIGHT),0) AS BASE_WEIGHT FROM (SELECT BALNK AS STYLE, A.WEIGHT FROM PRODUCTION.FELT_PROD_DATA A, PRODUCTION.FELT_ORDER_MASTER B WHERE PIECE_NO +0 = PROD_PIECE_NO +0 AND  PROD_DEPT='WEAVING' AND PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"'  AND APPROVED=1"+condi+") AS O WHERE SUBSTRING(O.STYLE,1,3) IN('XY','XYA','Y')) AS BW ON O.PARTY_CD = D.PROD_PARTY_CODE "+
            "LEFT JOIN (SELECT COALESCE(SUM(WEIGHT),0) AS CLOTH_WEIGHT FROM  (SELECT BALNK AS STYLE, A.WEIGHT FROM PRODUCTION.FELT_PROD_DATA A, PRODUCTION.FELT_ORDER_MASTER B WHERE PIECE_NO +0 = PROD_PIECE_NO +0 AND PROD_DEPT='WEAVING' AND PROD_DATE >= '"+fromDate+"' AND PROD_DATE <= '"+toDate+"'  AND APPROVED=1"+condi+") AS O WHERE SUBSTRING(O.STYLE,1,3) NOT IN('XY','XYA','Y')) AS CW ON O.PARTY_CD = D.PROD_PARTY_CODE "+
            "ORDER BY PROD_DATE,PROD_PIECE_NO+0,PROD_PARTY_CODE";
            
            ResultSet  rsTemp =data.getResult(str);
            int counter=1;
            if(rsTemp.getRow()>0)
                while(!rsTemp.isAfterLast()){
                    objRow=objData.newRow();
                    objRow.setValue("SR_NO", String.valueOf(counter));
                    objRow.setValue("PRODUCTION_DATE", EITLERPGLOBAL.formatDate(rsTemp.getString("PROD_DATE")));
                    objRow.setValue("PIECE_NO", rsTemp.getString("PROD_PIECE_NO"));
                    objRow.setValue("PARTY_CODE", rsTemp.getString("PROD_PARTY_CODE"));
                    objRow.setValue("PARTY_NAME", rsTemp.getString("PARTY_NAME"));
                    objRow.setValue("STYLE", rsTemp.getString("STYLE"));
                    objRow.setValue("GROUP", rsTemp.getString("GRUP"));
                    objRow.setValue("LENGTH", rsTemp.getString("LENGTH"));
                    objRow.setValue("WEIGHT", rsTemp.getString("WEIGHT"));
                    objRow.setValue("PICKS_PER_10CMS",rsTemp.getString("PICKS_PER_10CMS"));
                    objRow.setValue("REED_SPACE",rsTemp.getString("REED_SPACE"));
                    objRow.setValue("LOOM_NO",rsTemp.getString("LOOM_NO"));
                    objRow.setValue("BASE_WEIGHT", rsTemp.getString("BASE_WEIGHT"));
                    objRow.setValue("CLOTH_WEIGHT", rsTemp.getString("CLOTH_WEIGHT"));
                    
                    objData.AddRow(objRow);
                    counter++;
                    rsTemp.next();
                }
            
            HashMap param=new HashMap();
            param.put("FROM_DATE",EITLERPGLOBAL.formatDate(fromDate));
            param.put("TO_DATE",EITLERPGLOBAL.formatDate(toDate));
            
            EITLERPGLOBAL.PAGE_BREAK=true;
            if(!correctParty) new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltWeavingProduction.rpt",param,objData);
            else new TReportWriter.TReportEngine().PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptFeltWeavingProductionPartyWise.rpt",param,objData);
            
            correctParty=false;
        }catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
}
