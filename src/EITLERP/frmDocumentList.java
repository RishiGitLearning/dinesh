/*
 * frmDocumentList.java
 *
 * Created on April 26, 2005, 1:34 PM
 */

package EITLERP;

/**
 *
 * @author  root
 */
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.util.*;
import EITLERP.Stores.*;
import EITLERP.Purchase.*;


public class frmDocumentList extends javax.swing.JApplet {
    
    public int ModuleID=0;
    public String strQuery="";
    public String strTitle="";
    
    private JDialog aDialog=null;
    private EITLTableModel DataModel=new EITLTableModel();
    
    
    
    /** Initializes the applet frmDocumentList */
    public void init() {
        initComponents();
    }
    
    public frmDocumentList()
    {
       initComponents();  
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel1 = new javax.swing.JPanel();
        lblTitle = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        cmdOpenDoc = new javax.swing.JButton();
        cmdExit = new javax.swing.JButton();
        
        getContentPane().setLayout(null);
        
        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });
        
        jPanel1.setLayout(null);
        
        jPanel1.setBackground(new java.awt.Color(153, 153, 255));
        jPanel1.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        lblTitle.setText(".");
        jPanel1.add(lblTitle);
        lblTitle.setBounds(8, 10, 499, 15);
        
        getContentPane().add(jPanel1);
        jPanel1.setBounds(2, 2, 521, 33);
        
        Table.setModel(new javax.swing.table.DefaultTableModel(
        new Object [][] {
            {null, null, null, null},
            {null, null, null, null},
            {null, null, null, null},
            {null, null, null, null}
        },
        new String [] {
            "Title 1", "Title 2", "Title 3", "Title 4"
        }
        ));
        jScrollPane1.setViewportView(Table);
        
        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(7, 39, 507, 286);
        
        cmdOpenDoc.setText("Open Document");
        cmdOpenDoc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdOpenDocActionPerformed(evt);
            }
        });
        
        getContentPane().add(cmdOpenDoc);
        cmdOpenDoc.setBounds(281, 338, 141, 25);
        
        cmdExit.setText("Exit");
        cmdExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdExitActionPerformed(evt);
            }
        });
        
        getContentPane().add(cmdExit);
        cmdExit.setBounds(427, 338, 88, 25);
        
    }//GEN-END:initComponents

    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
        JOptionPane.showMessageDialog(null,"H "+getHeight()+" W "+getWidth());
    }//GEN-LAST:event_formMouseClicked

    private void cmdExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdExitActionPerformed
        // TODO add your handling code here:
        aDialog.dispose();
    }//GEN-LAST:event_cmdExitActionPerformed

    private void cmdOpenDocActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdOpenDocActionPerformed
        // TODO add your handling code here:
       if(Table.getRowCount()<=0)
       {
         JOptionPane.showMessageDialog(null,"No documents found");
         return;
       }
       
       if(Table.getSelectedRow()<0)
       {
         JOptionPane.showMessageDialog(null,"Please select the document no. from the list");
         return;
       }
       
       
       
       
       
        String DocNo=(String)Table.getValueAt(Table.getSelectedRow(),0);
        if(ModuleID==21)
        {
          int POType=clsPOGen.getPOType(EITLERPGLOBAL.gCompanyID, DocNo);
          
          if(POType<=7)
          {
            ModuleID=20+POType;  
          }
          else
          {
            ModuleID=46;  
          }
        }
        
        
        if(Table.getRowCount()>0) {
            if(ModuleID==46) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Service Contract");
                aFrame.startAppletEx("EITLERP.Purchase.frmServiceContract","Service Contract");
                frmServiceContract ObjItem=(frmServiceContract) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            
            
            if(ModuleID==47) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Service Contract Amendment");
                aFrame.startAppletEx("EITLERP.Purchase.frmServiceContractAmend","Service Contract Amendment");
                frmServiceContractAmend ObjItem=(frmServiceContractAmend) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            

            if(ModuleID==48) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Job work entry");
                aFrame.startAppletEx("EITLERP.Stores.frmJobwork","Job work entry");
                frmJobwork ObjItem=(frmJobwork) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            

            if(ModuleID==50) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Supplier Master Updation");
                aFrame.startAppletEx("EITLERP.frmSupplierAmend","Supplier Master Updation");
                frmSupplierAmend ObjItem=(frmSupplierAmend) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            

            if(ModuleID==51) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Item Master Updation");
                aFrame.startAppletEx("EITLERP.frmItemAmend","Item Master Updation");
                frmItemAmend ObjItem=(frmItemAmend) aFrame.ObjApplet;
                ObjItem.FindEx(EITLERPGLOBAL.gCompanyID,Integer.parseInt(lItemID));
                
                
            }
            
            
            //-----*
            if(ModuleID==1) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Item");
                aFrame.startAppletEx("EITLERP.frmItem","Item Master");
                frmItem ObjItem=(frmItem) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            
            //-----*
            if(ModuleID==37) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Supplier");
                aFrame.startAppletEx("EITLERP.frmSupplier","Supplier");
                frmSupplier ObjItem=(frmSupplier) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            
            
            if(ModuleID==44) {
                String lItemID=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Document Cancel Request");
                aFrame.startAppletEx("EITLERP.frmDocCancel","Document Cancel Request");
                frmDocCancel ObjItem=(frmDocCancel) aFrame.ObjApplet;
                ObjItem.FindEx((int)EITLERPGLOBAL.gCompanyID,lItemID);
            }
            
            
            //----*
            if(ModuleID==2) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Material Requisition");
                aFrame.startAppletEx("EITLERP.Stores.frmMR","Material Requisition");
                frmMR ObjDoc=(frmMR) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //----*
            if(ModuleID==42) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Freight Comparison");
                aFrame.startAppletEx("EITLERP.Purchase.frmFreightComparison","Freight Comparison");
                frmFreightComparison ObjDoc=(frmFreightComparison) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //----*
            if(ModuleID==43) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Freight Calculation");
                aFrame.startAppletEx("EITLERP.Purchase.frmFreightCalculation","Freight Calculation");
                frmFreightCalculation ObjDoc=(frmFreightCalculation) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //-----*
            if(ModuleID==20) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Summary");
                aFrame.startAppletEx("EITLERP.Purchase.frmQuotApproval","Quot Approval");
                frmQuotApproval ObjDoc=(frmQuotApproval) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //------*
            if(ModuleID==11) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("NRGP");
                aFrame.startAppletEx("EITLERP.Stores.FrmNRGP_General","NRGP");
                FrmNRGP_General ObjDoc=(FrmNRGP_General) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //-----*
            if(ModuleID==12) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("RGP");
                aFrame.startAppletEx("EITLERP.Stores.FrmRGP_General","RGP");
                FrmRGP_General ObjDoc=(FrmRGP_General) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //======*
            if(ModuleID==14) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Issue");
                aFrame.startAppletEx("EITLERP.Stores.FrmIssue_General","Issue");
                FrmIssue_General ObjDoc=(FrmIssue_General) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //=====*
            if(ModuleID==15) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Issue");
                aFrame.startAppletEx("EITLERP.Stores.FrmIssue_Raw","Issue");
                FrmIssue_Raw ObjDoc=(FrmIssue_Raw) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //==*
            if(ModuleID==3) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Indent");
                aFrame.startAppletEx("EITLERP.Stores.FrmIndent","Indent");
                FrmIndent ObjDoc=(FrmIndent) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //========*
            if(ModuleID==40) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("RGP Return");
                aFrame.startAppletEx("EITLERP.Stores.frmRGPReturn","RGP Return");
                frmRGPReturn ObjDoc=(frmRGPReturn) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //=====*
            if(ModuleID==18) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Inquiry");
                aFrame.startAppletEx("EITLERP.Purchase.FrmInquiry","Inquiry");
                FrmInquiry ObjDoc=(FrmInquiry) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //------ *
            if(ModuleID==4) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Gatepass Requisition");
                aFrame.startAppletEx("EITLERP.Stores.frmGPR","Gatepass Requisition");
                frmGPR ObjDoc=(frmGPR) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //======*
            if(ModuleID==5) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("MIR General");
                aFrame.startAppletEx("EITLERP.Stores.frmMIRGen","MIR General");
                frmMIRGen ObjDoc=(frmMIRGen) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //======*
            if(ModuleID==6) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("MIR Raw Material");
                aFrame.startAppletEx("EITLERP.Stores.frmMIR","MIR Raw Material");
                frmMIR ObjDoc=(frmMIR) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=====*
            if(ModuleID==7) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("GRN General");
                aFrame.startAppletEx("EITLERP.Stores.frmGRNGen","GRN General");
                frmGRNGen ObjDoc=(frmGRNGen) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //==========*
            if(ModuleID==8) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("GRN Raw Material");
                aFrame.startAppletEx("EITLERP.Stores.frmGRN","GRN Raw Material");
                frmGRN ObjDoc=(frmGRN) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=====*
            if(ModuleID==9) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("RJN General");
                aFrame.startAppletEx("EITLERP.Stores.frmRJNGen","RJN General");
                frmRJNGen ObjDoc=(frmRJNGen) aFrame.ObjApplet;
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //======*
            if(ModuleID==10) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("RJN Raw Material");
                aFrame.startAppletEx("EITLERP.Stores.frmRJN","RJN Raw Material");
                frmRJN ObjDoc=(frmRJN) aFrame.ObjApplet;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //======*
            if(ModuleID==21) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=1;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            if(ModuleID==46) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmServiceContract","Service Contract");
                frmServiceContract ObjDoc=(frmServiceContract) aFrame.ObjApplet;
                ObjDoc.POType=8;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //===== *
            if(ModuleID==22) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=2;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //====*
            if(ModuleID==23) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=3;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //====*
            if(ModuleID==24) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=4;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=====*
            if(ModuleID==25) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=5;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //======*
            if(ModuleID==26) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=6;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=====*
            if(ModuleID==27) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOGen","Purchase Order");
                frmPOGen ObjDoc=(frmPOGen) aFrame.ObjApplet;
                ObjDoc.POType=7;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //Amendments
            //======*
            if(ModuleID==28) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=1;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            if(ModuleID==47) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmServiceContractAmend","Service Contract Amendment");
                frmServiceContractAmend ObjDoc=(frmServiceContractAmend) aFrame.ObjApplet;
                ObjDoc.POType=8;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            
            //=======*
            if(ModuleID==29) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=2;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //========*
            if(ModuleID==30) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=3;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=======*
            if(ModuleID==31) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=4;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //======*
            if(ModuleID==32) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=5;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=======*
            if(ModuleID==33) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=6;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //=======*
            if(ModuleID==34) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Purchase Order");
                aFrame.startAppletEx("EITLERP.Purchase.frmPOAmendGen","Purchase Order Amendment");
                frmPOAmendGen ObjDoc=(frmPOAmendGen) aFrame.ObjApplet;
                ObjDoc.POType=7;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
            //======*
            if(ModuleID==38) {
                DocNo=(String)Table.getValueAt(Table.getSelectedRow(), 0);
                AppletFrame aFrame=new AppletFrame("Rate Approval");
                aFrame.startAppletEx("EITLERP.Purchase.frmRateApproval","Rate Approval");
                frmRateApproval ObjDoc=(frmRateApproval) aFrame.ObjApplet;
                
                ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,DocNo);
            }
            
        }
       
       
        
    }//GEN-LAST:event_cmdOpenDocActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable Table;
    private javax.swing.JButton cmdExit;
    private javax.swing.JButton cmdOpenDoc;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblTitle;
    // End of variables declaration//GEN-END:variables
    
    
    public void ShowList(int pModuleID,String pstrQuery,String pTitle) {
        try {
            ModuleID=pModuleID;
            strQuery=pstrQuery;
            strTitle=pTitle;
            
            lblTitle.setText(strTitle);
            
            GenerateList();
            
            setSize(560,410);
            
            Frame f=findParentFrame(this);
            
            aDialog=new JDialog(f,"List",false);
            
            aDialog.getContentPane().add("Center",this);
            Dimension appletSize = this.getSize();
            aDialog.setSize(appletSize);
            aDialog.setResizable(true);
            
            //Place it to center of the screen
            Dimension screenSize=Toolkit.getDefaultToolkit().getScreenSize();
            aDialog.setLocation((int)(screenSize.width-appletSize.getWidth())/2,(int)(screenSize.height-appletSize.getHeight())/2);
            
            aDialog.setDefaultCloseOperation(javax.swing.JDialog.DISPOSE_ON_CLOSE);
            aDialog.show();
        }
        catch(Exception e) {
        }
        return;
        
    }
    
    //Recurses through the hierarchy of classes
    //until it finds Frame
    private Frame findParentFrame(JApplet pApplet) {
        Container c = (Container) pApplet;
        while(c != null) {
            if (c instanceof Frame)
                return (Frame)c;
            
            c = c.getParent();
        }
        return (Frame)null;
    }
    
    private void GenerateList() {
        
        ResultSet rsTmp=null;
        
        try {
            FormatGrid();
            
            rsTmp=data.getResult(strQuery);
            rsTmp.first();
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Object[] rowData=new Object[2];
                    
                    rowData[0]=rsTmp.getString("DOC_NO");
                    rowData[1]=EITLERPGLOBAL.formatDate(rsTmp.getString("DOC_DATE"));
                    
                    DataModel.addRow(rowData);
                    
                    rsTmp.next();
                }
            }
        }
        catch(Exception e) {
            
        }
        
    }
    
    
    private void FormatGrid() {
        DataModel=new EITLTableModel();
        
        Table.removeAll();
        
        Table.setModel(DataModel);
        Table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        
        DataModel.TableReadOnly(true);
        
        //Add Columns to it
        DataModel.addColumn("Document No."); //0 Selection
        DataModel.addColumn("Date"); //0 Selection
    }
    
}
