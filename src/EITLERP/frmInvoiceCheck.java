/*
 * frmRptGRNInfo.java
 *
 * Created on April 16, 2008, 12:01 PM
 */

package EITLERP;

/**
 *
 * @author  root
 */
import EITLERP.*;
import EITLERP.Sales.*;
import EITLERP.Finance.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.net.*;
import java.util.*;
import TReportWriter.*;

public class frmInvoiceCheck extends javax.swing.JApplet {
    
    private EITLComboModel cmbMainCodeTypeModel;
    
    
    /** Initializes the applet frmRptGRNInfo */
    public void init() {
        setSize(424,264);
        initComponents();
        GenerateCombo();
        
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel3 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        txtFromDate = new javax.swing.JTextField();
        cmdPreview = new javax.swing.JButton();
        jLabel25 = new javax.swing.JLabel();
        cmbMainCodeType = new javax.swing.JComboBox();
        txtToDate = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jPanel3.setLayout(null);

        jPanel3.setBackground(new java.awt.Color(0, 153, 204));
        jPanel3.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel6.setText("Sales Invoice AutoAdjust");
        jPanel3.add(jLabel6);
        jLabel6.setBounds(9, 8, 230, 15);

        getContentPane().add(jPanel3);
        jPanel3.setBounds(0, 2, 800, 30);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("From Date:-");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(10, 90, 80, 20);

        txtFromDate.setColumns(10);
        txtFromDate.setText("01/12/2010");
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(100, 90, 90, 19);

        cmdPreview.setText("Print");
        cmdPreview.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPreviewActionPerformed(evt);
            }
        });

        getContentPane().add(cmdPreview);
        cmdPreview.setBounds(40, 120, 130, 25);

        jLabel25.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel25.setText("Main Code Type :");
        getContentPane().add(jLabel25);
        jLabel25.setBounds(40, 50, 110, 15);

        cmbMainCodeType.setEditable(true);
        getContentPane().add(cmbMainCodeType);
        cmbMainCodeType.setBounds(160, 50, 155, 24);

        txtToDate.setColumns(10);
        txtToDate.setText("31/12/2010");
        getContentPane().add(txtToDate);
        txtToDate.setBounds(260, 90, 90, 19);

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("To:-");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(200, 90, 50, 20);

    }//GEN-END:initComponents
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdPreviewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPreviewActionPerformed
        // TODO add your handling code here:
        PrintData();
    }//GEN-LAST:event_cmdPreviewActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox cmbMainCodeType;
    private javax.swing.JButton cmdPreview;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtToDate;
    // End of variables declaration//GEN-END:variables
    
    private void PrintData() {
        try {
            
            String MainAccountCode = EITLERPGLOBAL.getCombostrCode(cmbMainCodeType);
            String InvoiceType = "";
            if(MainAccountCode.equals("210027"))
            {
                InvoiceType ="1";
            }
            else if(MainAccountCode.equals("210010"))
            {
                InvoiceType ="2";
            }
            else if(MainAccountCode.equals("210072"))
            {
                InvoiceType ="3";
            }
            String strSql="SELECT * FROM D_SAL_INVOICE_HEADER WHERE APPROVED =1 AND CANCELLED = 0 AND PAYMENT_TERM_CODE LIKE '9%' " +
            "AND INVOICE_TYPE = '" + InvoiceType + "' AND  APPROVED = 1 AND CANCELLED = 0 AND INVOICE_DATE >= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim())+ "' AND INVOICE_DATE <= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim())+ "' " +
            "ORDER BY INVOICE_DATE ";
            
            
            ResultSet rsInvoiceHeader =data.getResult(strSql);
            rsInvoiceHeader.first();
            
            int Counter = 0;
            String InvoiceNo="",InvoiceDate="",PartyCode="";
            //MainAccountCode="";
            if(rsInvoiceHeader.getRow()>0) {
                while(!rsInvoiceHeader.isAfterLast()) {
                    InvoiceNo=rsInvoiceHeader.getString("INVOICE_NO");
                    InvoiceDate=rsInvoiceHeader.getString("INVOICE_DATE");
                    PartyCode = rsInvoiceHeader.getString("PARTY_CODE");
                    //MainAccountCode=EITLERPGLOBAL.getCombostrCode(cmbMainCodeType);
                    double NetAmount = clsSalesInvoice.getInvoiceAmount(InvoiceNo,InvoiceDate);
                    
                    
                    strSql="SELECT SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL WHERE INVOICE_NO ='" + InvoiceNo + "' AND INVOICE_DATE = '" + InvoiceDate + "' "+
                    "AND EFFECT = 'C' AND MAIN_ACCOUNT_CODE = '" + MainAccountCode + "' AND SUB_ACCOUNT_CODE='"+ PartyCode  +"'  ";
                    double SJAmount = data.getDoubleValueFromDB(strSql,FinanceGlobal.FinURL);
                    
                        if(NetAmount != SJAmount ) {
                            System.out.println("Invoice No:-" + InvoiceNo + "Invoice Date:-" + InvoiceDate  );
                        }
                    
                    
                    rsInvoiceHeader.next();
                }
                System.out.println("Done..................");
            }
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
    private void GenerateCombo() {
        //-------Main Code Type --------//
        cmbMainCodeTypeModel=new EITLComboModel();
        cmbMainCodeType.removeAllItems();
        cmbMainCodeType.setModel(cmbMainCodeTypeModel);
        
        ComboData aData=new ComboData();
        aData.strCode="210027";
        aData.Text="Suiting";
        cmbMainCodeTypeModel.addElement(aData);
        
        
        aData=new ComboData();
        aData.strCode="210010";
        aData.Text="Felt";
        cmbMainCodeTypeModel.addElement(aData);
        
        aData=new ComboData();
        aData.strCode="210072";
        aData.Text="Filter";
        cmbMainCodeTypeModel.addElement(aData);
    }
    
    
}
