/* frmFeltSalesInfo.java 
 * 
 * 
 * Created on July 13, 2005, 10:47 AM
 */
package EITLERP.InvoiceMatching;

import EITLERP.*;
import EITLERP.Finance.FinanceGlobal;
import EITLERP.Finance.UtilFunctions;
import java.awt.Color;
import java.awt.Font;
import java.io.File;
import java.sql.*;
import javax.swing.*;
import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.HashMap;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumn;
import javax.swing.table.TableColumnModel;

/**
 *
 * @author ashutosh/RISHI
 */
public class frmGSTUnaccountedMatching extends javax.swing.JApplet {

    public boolean forceToChange = false;
    public boolean cancelled = false;
    private EITLTableModel[] DataModel;
    private EITLTableModel DataModelPJVList = new EITLTableModel();    
    private EITLTableModel DataModelInsertedList = new EITLTableModel();
    private EITLTableCellRenderer Render=new EITLTableCellRenderer();
    
    private EITLComboModel cmbCompanyTypeModel;
    private EITLComboModel cmbHierarchyModel;
    private clsGSTUnaccountedMatching ObjGSTPJVMatching=new clsGSTUnaccountedMatching();
    String strProductCode = "";
    private JDialog aDialog;
    DateFormat df = new SimpleDateFormat("dd-MMM-yy");
    HashMap hmListToUpload = new HashMap();
    String ORDER_BY = "";
    String Parameter="";
    private clsExcel_Exporter exp = new clsExcel_Exporter();

    public void init() {
        initComponents();
        file1.setVisible(false);
        FormatGrid();//780, 560
        FormatGridInserted();        
        setSize(780, 560);
        GenerateCombos();
        jLabel1.setForeground(Color.WHITE);
        //txtFromDate.setText("01/05/2018");
        //txtToDate.setText("31/05/2018");
    }

    /**
     * This method is called from within the init() method to initialize the
     * form. WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        lblStatus = new javax.swing.JLabel();
        buttonGroup1 = new javax.swing.ButtonGroup();
        file1 = new javax.swing.JFileChooser();
        mnuForGSTSelect = new javax.swing.JPopupMenu();
        jMenuItem1 = new javax.swing.JMenuItem();
        jMenuItem2 = new javax.swing.JMenuItem();
        mnuForGSTUpload = new javax.swing.JPopupMenu();
        jMenuItem5 = new javax.swing.JMenuItem();
        jMenuItem6 = new javax.swing.JMenuItem();
        jLabel2 = new javax.swing.JLabel();
        txtFromDate = new javax.swing.JTextField();
        txtToDate = new javax.swing.JTextField();
        CLR_BTN = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel10 = new javax.swing.JPanel();
        jScrollPane10 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        btnShowGST = new javax.swing.JButton();
        ExportExcel = new javax.swing.JButton();
        btnUpload = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane11 = new javax.swing.JScrollPane();
        TableInserted = new javax.swing.JTable();
        btnShowGSTReports = new javax.swing.JButton();
        ExportExcel1 = new javax.swing.JButton();
        jLabel6 = new javax.swing.JLabel();
        txtVoucherNo = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        cmbCompany = new javax.swing.JComboBox();

        lblStatus.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lblStatus.setForeground(new java.awt.Color(51, 51, 255));
        lblStatus.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jMenuItem1.setText("GST uploaded on partal amount matches");
        jMenuItem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem1ActionPerformed(evt);
            }
        });
        mnuForGSTSelect.add(jMenuItem1);

        jMenuItem2.setText("GST uploaded on portal but amount differs");
        jMenuItem2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem2ActionPerformed(evt);
            }
        });
        mnuForGSTSelect.add(jMenuItem2);

        jMenuItem5.setText("All");
        jMenuItem5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem5ActionPerformed(evt);
            }
        });
        mnuForGSTUpload.add(jMenuItem5);

        jMenuItem6.setText("GST not Uploaded");
        jMenuItem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem6ActionPerformed(evt);
            }
        });
        mnuForGSTUpload.add(jMenuItem6);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });
        getContentPane().setLayout(null);

        jLabel2.setBackground(new java.awt.Color(0, 102, 153));
        jLabel2.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel2.setOpaque(true);
        getContentPane().add(jLabel2);
        jLabel2.setBounds(10, 90, 780, 10);

        txtFromDate = new JTextFieldHint(new JTextField(),"DD/MM/YYYY");
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(110, 30, 100, 20);

        txtToDate = new JTextFieldHint(new JTextField(),"DD/MM/YYYY");
        txtToDate.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtToDateFocusGained(evt);
            }
        });
        getContentPane().add(txtToDate);
        txtToDate.setBounds(310, 30, 100, 20);

        CLR_BTN.setText("Clear");
        CLR_BTN.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        CLR_BTN.setMargin(new java.awt.Insets(2, 7, 2, 7));
        CLR_BTN.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CLR_BTNActionPerformed(evt);
            }
        });
        getContentPane().add(CLR_BTN);
        CLR_BTN.setBounds(670, 30, 80, 30);

        jLabel4.setFont(new java.awt.Font("Liberation Sans", 1, 13)); // NOI18N
        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel4.setText("Location :");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(210, 60, 90, 20);

        jLabel1.setBackground(new java.awt.Color(0, 102, 153));
        jLabel1.setFont(new java.awt.Font("Liberation Sans", 1, 13)); // NOI18N
        jLabel1.setText("GST Unaccounted Matching");
        jLabel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel1.setOpaque(true);
        getContentPane().add(jLabel1);
        jLabel1.setBounds(0, 0, 780, 25);

        jPanel10.setLayout(null);

        Table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        Table.setSelectionBackground(new java.awt.Color(208, 220, 234));
        Table.setSelectionForeground(new java.awt.Color(231, 16, 16));
        Table.getTableHeader().setFont(new Font("Plain", Font.BOLD, 12));
        Table.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                TableMouseClicked(evt);
            }
        });
        jScrollPane10.setViewportView(Table);

        jPanel10.add(jScrollPane10);
        jScrollPane10.setBounds(10, 60, 720, 270);

        btnShowGST.setText("Show List");
        btnShowGST.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnShowGSTActionPerformed(evt);
            }
        });
        jPanel10.add(btnShowGST);
        btnShowGST.setBounds(10, 20, 130, 30);

        ExportExcel.setText("EXPORT TO EXCEL");
        ExportExcel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ExportExcelActionPerformed(evt);
            }
        });
        jPanel10.add(ExportExcel);
        ExportExcel.setBounds(540, 20, 170, 27);

        btnUpload.setText("Upload");
        btnUpload.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUploadActionPerformed(evt);
            }
        });
        jPanel10.add(btnUpload);
        btnUpload.setBounds(260, 340, 90, 27);

        jTabbedPane1.addTab("GST Upload  Entry", jPanel10);

        jPanel1.setLayout(null);

        TableInserted.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        TableInserted.setSelectionBackground(new java.awt.Color(208, 220, 234));
        TableInserted.setSelectionForeground(new java.awt.Color(231, 16, 16));
        TableInserted.getTableHeader().setFont(new Font("Plain", Font.BOLD, 12));
        TableInserted.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                TableInsertedMouseClicked(evt);
            }
        });
        TableInserted.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                TableInsertedKeyPressed(evt);
            }
        });
        jScrollPane11.setViewportView(TableInserted);

        jPanel1.add(jScrollPane11);
        jScrollPane11.setBounds(10, 60, 720, 270);

        btnShowGSTReports.setText("Show List");
        btnShowGSTReports.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnShowGSTReportsActionPerformed(evt);
            }
        });
        jPanel1.add(btnShowGSTReports);
        btnShowGSTReports.setBounds(10, 20, 130, 30);

        ExportExcel1.setText("EXPORT TO EXCEL");
        ExportExcel1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ExportExcel1ActionPerformed(evt);
            }
        });
        jPanel1.add(ExportExcel1);
        ExportExcel1.setBounds(540, 20, 170, 27);

        jTabbedPane1.addTab("GST Uploaded", jPanel1);

        getContentPane().add(jTabbedPane1);
        jTabbedPane1.setBounds(10, 100, 760, 430);
        jTabbedPane1.getAccessibleContext().setAccessibleName("GST Upload  Entry");

        jLabel6.setFont(new java.awt.Font("Liberation Sans", 1, 13)); // NOI18N
        jLabel6.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel6.setText("From Date :");
        getContentPane().add(jLabel6);
        jLabel6.setBounds(0, 30, 100, 20);
        getContentPane().add(txtVoucherNo);
        txtVoucherNo.setBounds(110, 60, 100, 20);

        jLabel7.setFont(new java.awt.Font("Liberation Sans", 1, 13)); // NOI18N
        jLabel7.setText("To Date :");
        getContentPane().add(jLabel7);
        jLabel7.setBounds(240, 30, 70, 20);

        jLabel8.setFont(new java.awt.Font("Liberation Sans", 1, 13)); // NOI18N
        jLabel8.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel8.setText("MIR No :");
        getContentPane().add(jLabel8);
        jLabel8.setBounds(10, 60, 90, 20);

        cmbCompany.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        getContentPane().add(cmbCompany);
        cmbCompany.setBounds(310, 60, 100, 20);
    }// </editor-fold>//GEN-END:initComponents

    private void txtToDateFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtToDateFocusGained
        // TODO add your handling code here:
    }//GEN-LAST:event_txtToDateFocusGained

    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked

    }//GEN-LAST:event_formMouseClicked

    private void btnShowGSTActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnShowGSTActionPerformed
//    if (!Validate()) {
//            return;
//        }
//        data.Execute("UPDATE FINANCE.D_FIN_PARTY_MASTER FM ,DINESHMILLS.D_COM_SUPP_MASTER  SM \n" +
//"SET FM.GSTIN_NO= SM.GSTIN_NO,FM.STATE_GST_CODE= SM.STATE_GST_CODE,FM.STATE_CODE= SM.STATE_CODE,FM.STATE = SM.STATE \n" +
//"WHERE FM.PARTY_CODE = SM.SUPPLIER_CODE AND SM.GSTIN_NO != ''");
        FormatGrid();
        GenerateData(ORDER_BY);
        //mnuForGSTUpload.show(jPanel10, btnShowGST.getX(), btnShowGST.getY()+btnShowGST.getHeight());
    }//GEN-LAST:event_btnShowGSTActionPerformed

    private void ExportExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ExportExcelActionPerformed
        //        // TODO add your handling code here:
        //        try{
        //            exp.fillData(Table_b2b,new File("/root/Desktop/gstr1_B2B.xls"));
        //            exp.fillData(Table_b2b,new File("D://gstr1_B2B.xls"));
        //            JOptionPane.showMessageDialog(null, "Data saved at " +
        //                "'/root/Desktop/gstr1_B2B.xls' successfully in Linux PC or 'D://gstr1_B2B.xls' successfully in Windows PC    ", "Message",
        //                JOptionPane.INFORMATION_MESSAGE);
        //        }
        //        catch(Exception ex) {
        //            ex.printStackTrace();
        //        }
        // TODO add your handling code here:
        File file = null;
        file1.setVisible(true);
        try {
            int returnVal = file1.showOpenDialog(this);
            if (returnVal == file1.APPROVE_OPTION) {
                file = file1.getSelectedFile();
            }
            file1.setVisible(false);

            exp.fillData(Table, new File(file1.getSelectedFile().toString() + ".xls"), "GSTR2");
            JOptionPane.showMessageDialog(null, "Data saved at "
                    + file1.getSelectedFile().toString() + " successfully... ", "Message",
                    JOptionPane.INFORMATION_MESSAGE);
        } catch (Exception ex) {
            //ex.printStackTrace();
        }
    }//GEN-LAST:event_ExportExcelActionPerformed

    private void CLR_BTNActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CLR_BTNActionPerformed
        txtFromDate.setText("");
        txtToDate.setText("");
        txtVoucherNo.setText("");
        FormatGrid();
        FormatGridInserted();
    }//GEN-LAST:event_CLR_BTNActionPerformed

    private void btnUploadActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUploadActionPerformed
        for(int r=0;r<Table.getRowCount();r++) {
                if(Table.getValueAt(r,0).equals(new Boolean(true))) {
                    //DataModelPJVList.getValueAt(r,2).toString();
                    if(Table.getValueAt(r, 1).equals("")){
                        JOptionPane.showMessageDialog(null,"Uploaded month is not selected for "+Table.getValueAt(r, 7).toString());                                           
                        return;
                    }
                }
        }
        
        GenerateListToUpload();
       //ObjGSTPJVMatching =new clsGSTPJVMatching();
       if(ObjGSTPJVMatching.Insert()){
         JOptionPane.showMessageDialog(null,"Data are inserted successfully.");                                           
       }           
    }//GEN-LAST:event_btnUploadActionPerformed

    private void TableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_TableMouseClicked
        if(Table.getSelectedColumn()==0){
            if(Table.getValueAt(Table.getSelectedRow(),0).equals(new Boolean(false))){
                Table.setValueAt("", Table.getSelectedRow(), 1);
            }
        }
        if(Table.getSelectedColumn()==0){
            if(Table.getValueAt(Table.getSelectedRow(),0).equals(new Boolean(true))){
                 String voucherNo=Table.getValueAt(Table.getSelectedRow(),7).toString();
                 String mainAccountCode=Table.getValueAt(Table.getSelectedRow(),9).toString();
                 //System.out.println(voucherNo);
                 if(data.IsRecordExist("SELECT MIR_NO FROM FINANCE.D_FIN_UNACCOUNTED_GST_UPLOADED_DETAIL WHERE MIR_NO='"+voucherNo+"' AND MAIN_ACCOUNT_CODE='"+mainAccountCode+"'",FinanceGlobal.FinURL)) {
                     JOptionPane.showMessageDialog(null,"MIR No is already uploaded.");
                     Table.setValueAt(new Boolean(false),Table.getSelectedRow(), 0);                     
            }
            }
        }
    }//GEN-LAST:event_TableMouseClicked

    private void TableInsertedMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_TableInsertedMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_TableInsertedMouseClicked

    private void TableInsertedKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_TableInsertedKeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_TableInsertedKeyPressed

    private void btnShowGSTReportsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnShowGSTReportsActionPerformed
        FormatGridInserted();
        GenerateInsertedData(ORDER_BY);
        //mnuForGSTSelect.show(jPanel1, btnShowGSTReports.getX(), btnShowGSTReports.getY()+btnShowGSTReports.getHeight());
    }//GEN-LAST:event_btnShowGSTReportsActionPerformed

    private void ExportExcel1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ExportExcel1ActionPerformed
File file = null;
        file1.setVisible(true);
        try {
            int returnVal = file1.showOpenDialog(this);
            if (returnVal == file1.APPROVE_OPTION) {
                file = file1.getSelectedFile();
            }
            file1.setVisible(false);

            exp.fillData(TableInserted, new File(file1.getSelectedFile().toString() + ".xls"), "GSTR2");
            JOptionPane.showMessageDialog(null, "Data saved at "
                    + file1.getSelectedFile().toString() + " successfully... ", "Message",
                    JOptionPane.INFORMATION_MESSAGE);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }//GEN-LAST:event_ExportExcel1ActionPerformed

    private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem1ActionPerformed
        FormatGridInserted();
        Parameter="AMOUNT_MATCHES";
        GenerateInsertedData(Parameter);
    }//GEN-LAST:event_jMenuItem1ActionPerformed

    private void jMenuItem2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem2ActionPerformed
        FormatGridInserted();
        Parameter="AMOUNT_DIFFERS";
        GenerateInsertedData(Parameter);
    }//GEN-LAST:event_jMenuItem2ActionPerformed

    private void jMenuItem5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem5ActionPerformed
          if (!Validate()) {
            return;
        }
        data.Execute("UPDATE FINANCE.D_FIN_PARTY_MASTER FM ,DINESHMILLS.D_COM_SUPP_MASTER  SM \n" +
"SET FM.GSTIN_NO= SM.GSTIN_NO,FM.STATE_GST_CODE= SM.STATE_GST_CODE,FM.STATE_CODE= SM.STATE_CODE,FM.STATE = SM.STATE \n" +
"WHERE FM.PARTY_CODE = SM.SUPPLIER_CODE AND SM.GSTIN_NO != ''");
        FormatGrid();
        Parameter="";
        GenerateData(Parameter);  
    }//GEN-LAST:event_jMenuItem5ActionPerformed

    private void jMenuItem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem6ActionPerformed
    if (!Validate()) {
            return;
        }
        data.Execute("UPDATE FINANCE.D_FIN_PARTY_MASTER FM ,DINESHMILLS.D_COM_SUPP_MASTER  SM \n" +
"SET FM.GSTIN_NO= SM.GSTIN_NO,FM.STATE_GST_CODE= SM.STATE_GST_CODE,FM.STATE_CODE= SM.STATE_CODE,FM.STATE = SM.STATE \n" +
"WHERE FM.PARTY_CODE = SM.SUPPLIER_CODE AND SM.GSTIN_NO != ''");
        FormatGrid();
        Parameter="NOT_UPLOADED";
        GenerateData(Parameter);
    }//GEN-LAST:event_jMenuItem6ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton CLR_BTN;
    private javax.swing.JButton ExportExcel;
    private javax.swing.JButton ExportExcel1;
    private javax.swing.JTable Table;
    private javax.swing.JTable TableInserted;
    private javax.swing.JButton btnShowGST;
    private javax.swing.JButton btnShowGSTReports;
    private javax.swing.JButton btnUpload;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox cmbCompany;
    private javax.swing.JFileChooser file1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JMenuItem jMenuItem2;
    private javax.swing.JMenuItem jMenuItem5;
    private javax.swing.JMenuItem jMenuItem6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JScrollPane jScrollPane10;
    private javax.swing.JScrollPane jScrollPane11;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JLabel lblStatus;
    private javax.swing.JPopupMenu mnuForGSTSelect;
    private javax.swing.JPopupMenu mnuForGSTUpload;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtToDate;
    private javax.swing.JTextField txtVoucherNo;
    // End of variables declaration//GEN-END:variables

    private boolean Validate() {
        //Form level validations
        if (txtFromDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null, "Please Enter from Date");
            return false;
        } else if (!EITLERPGLOBAL.isDate(txtFromDate.getText())) {
            JOptionPane.showMessageDialog(null, "Invalid From Date in DD/MM/YYYY format.");
            return false;
        }

        if (txtToDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null, "Please Enter To Date");
            return false;
        } else if (!EITLERPGLOBAL.isDate(txtToDate.getText())) {
            JOptionPane.showMessageDialog(null, "Invalid To Date in DD/MM/YYYY format.");
            return false;
        }

        return true;
    }
    
    private void GenerateCombos() {
                     
        //-----------Company----------//
        cmbCompanyTypeModel=new EITLComboModel();
        cmbCompany.removeAllItems();
        cmbCompany.setModel(cmbCompanyTypeModel);
        ComboData aData=new ComboData();
        aData=new ComboData();
        aData.Code=2;
        aData.Text="Baroda";
        cmbCompanyTypeModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=3;
        aData.Text="Ankleshwar";
        cmbCompanyTypeModel.addElement(aData);        
        
        //-------------------------------//
              
        
        
    }

    private void FormatGrid() {
        try {
            DataModelPJVList= new EITLTableModel();
            Table.removeAll();

            Table.setModel(DataModelPJVList);
            TableColumnModel ColModel=Table.getColumnModel();
            Table.setAutoResizeMode(0);
            
            DataModelPJVList.addColumn("*"); //0            
            DataModelPJVList.addColumn("Month-Year"); //1
            DataModelPJVList.addColumn("Remarks");//2
            DataModelPJVList.addColumn("SrNo"); //3
            DataModelPJVList.addColumn("Party Code");//4
            DataModelPJVList.addColumn("Party Name");//5
            DataModelPJVList.addColumn("GSTIN");//6
            DataModelPJVList.addColumn("MIR No"); //7
            DataModelPJVList.addColumn("MIR Date"); //8
            DataModelPJVList.addColumn("Main A/c Code"); //9
            DataModelPJVList.addColumn("Main A/c Name");//10
            DataModelPJVList.addColumn("Cr/Dr"); //1
            DataModelPJVList.addColumn("Amount"); //11
            DataModelPJVList.addColumn("Differ Amount"); //11
            DataModelPJVList.addColumn("HSN SAC Code"); //12
            DataModelPJVList.addColumn("Invoice No");//13
            DataModelPJVList.addColumn("Invoice Date"); //14
            DataModelPJVList.addColumn("Book Code"); //15
            DataModelPJVList.addColumn("MIR Type"); //16
            DataModelPJVList.addColumn("Legacy No"); //17
            DataModelPJVList.addColumn("Legacy Date"); //18
            DataModelPJVList.addColumn("Company Id"); //20
            DataModelPJVList.addColumn("Sr No"); //10
//            DataModelPJVList.addColumn("Taxable Value"); //11
//            DataModelPJVList.addColumn("Integrated Tax Paid"); //12
//            DataModelPJVList.addColumn("Central Tax Paid"); //13
//            DataModelPJVList.addColumn("State/UT Tax Paid"); //14
//            DataModelPJVList.addColumn("Cess Paid"); //15
//            DataModelPJVList.addColumn("Eligibility For ITC"); //16
//            DataModelPJVList.addColumn("Availed ITC Integrated Tax"); //17
//            DataModelPJVList.addColumn("Availed ITC Central Tax"); //18
//            DataModelPJVList.addColumn("Availed ITC State/UT Tax"); //19
//            DataModelPJVList.addColumn("Availed ITC Cess");//20

              DataModelPJVList.SetVariable(0,"UPLOADED"); 
            DataModelPJVList.SetVariable(1,"UPLOADED_MONTH"); 
            DataModelPJVList.SetVariable(2,"REMARKS");
            DataModelPJVList.SetVariable(4, "SUB_ACCOUNT_CODE");
            DataModelPJVList.SetVariable(5,"SUB_ACCOUNT_NAME");
            DataModelPJVList.SetVariable(6,"GSTIN_NO");
            DataModelPJVList.SetVariable(7,"VOUCHER_NO");
            DataModelPJVList.SetVariable(8, "VOUCHER_DATE");
            DataModelPJVList.SetVariable(9, "MAIN_ACCOUNT_CODE");
            DataModelPJVList.SetVariable(10, "MAIN_ACCOUNT_NAME");
            DataModelPJVList.SetVariable(11, "EFFECT");
            DataModelPJVList.SetVariable(12, "AMOUNT");
            DataModelPJVList.SetVariable(13, "DIFFER_AMOUNT");
            DataModelPJVList.SetVariable(14, "HSN_SAC_CODE");
            DataModelPJVList.SetVariable(15, "INVOICE_NO");
            DataModelPJVList.SetVariable(16, "INVOICE_DATE");
            DataModelPJVList.SetVariable(17, "BOOK_CODE");
            DataModelPJVList.SetVariable(18, "VOUCHER_TYPE");
            DataModelPJVList.SetVariable(19, "LEGACY_NO");
            DataModelPJVList.SetVariable(20,"LEGACY_DATE");
            DataModelPJVList.SetVariable(21, "COMPANY_ID");
            DataModelPJVList.SetVariable(22, "VOUCHER_SR_NO");
            
            
            
            
//            DataModelPJVList.SetNumeric(7, true);
//            DataModelPJVList.SetNumeric(11, true);
//            DataModelPJVList.SetNumeric(12, true);
//            DataModelPJVList.SetNumeric(13, true);
//            DataModelPJVList.SetNumeric(14, true);
//            DataModelPJVList.SetNumeric(15, true);
//            DataModelPJVList.SetNumeric(16, true);
//            

//            for (int i = 0; i <= 21; i++) {
//                DataModelPJVList.SetReadOnly(i);
//            }

//            Table.getColumnModel().getColumn(0).setMinWidth(30);
//            for (int i = 1; i <= 21; i++) {
//                Table.getColumnModel().getColumn(i).setMinWidth(100);
//            }
            Table.getColumnModel().getColumn(0).setMaxWidth(20);
            Table.getColumnModel().getColumn(1).setMinWidth(100);
            Table.getColumnModel().getColumn(3).setMaxWidth(40);
            
            Render.setCustomComponent(0,"CheckBox");
            Table.getColumnModel().getColumn(0).setCellRenderer(Render);
            Table.getColumnModel().getColumn(0).setCellEditor(new DefaultCellEditor(new JCheckBox()));
            
            TableColumn dateColumn = Table.getColumnModel().getColumn(1);

            JComboBox monthbox = new JComboBox();
            String month_name = "";
            java.util.Date date = new java.util.Date();
            int month=0;
            //int month = date.getMonth();
            //int year = date.getYear() + 1900;
            int year=2018;
            for (int i = 0; i < 40; i++) {
                month = month + 1;

                if (month >= 13) {
                    month = 1;
                    year = year + 1;
                }

                if (month == 1) {
                    month_name = "Jan";
                } else if (month == 2) {
                    month_name = "Feb";
                } else if (month == 3) {
                    month_name = "Mar";
                } else if (month == 4) {
                    month_name = "Apr";
                } else if (month == 5) {
                    month_name = "May";
                } else if (month == 6) {
                    month_name = "Jun";
                } else if (month == 7) {
                    month_name = "Jul";
                } else if (month == 8) {
                    month_name = "Aug";
                } else if (month == 9) {
                    month_name = "Sep";
                } else if (month == 10) {
                    month_name = "Oct";
                } else if (month == 11) {
                    month_name = "Nov";
                } else if (month == 12) {
                    month_name = "Dec";
                }
                monthbox.addItem(month_name + " - " + year);
            }

            dateColumn.setCellEditor(new DefaultCellEditor(monthbox));

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, "Enter Correct Details in Table. Error is : " + e.getMessage(), "ERROR", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    private void FormatGridInserted() {
        try {
            DataModelInsertedList= new EITLTableModel();
            TableInserted.removeAll();

            TableInserted.setModel(DataModelInsertedList);
            TableColumnModel ColModel=TableInserted.getColumnModel();
            TableInserted.setAutoResizeMode(0);
            
            DataModelInsertedList.addColumn("SrNo"); //0            
            DataModelInsertedList.addColumn("Month-Year"); //1
            DataModelInsertedList.addColumn("Remarks");//2            
            DataModelInsertedList.addColumn("Party Code");//3
            DataModelInsertedList.addColumn("Party Name");//4
            DataModelInsertedList.addColumn("GSTIN");//5
            DataModelInsertedList.addColumn("MIR No"); //6
            DataModelInsertedList.addColumn("MIR Date"); //7
            DataModelInsertedList.addColumn("Main A/c Code"); //8
            DataModelInsertedList.addColumn("Main A/c Name");//9            
            DataModelInsertedList.addColumn("Cr/Dr");//9            
            DataModelInsertedList.addColumn("Amount"); //11
            DataModelInsertedList.addColumn("Differ Amount"); //11
            DataModelInsertedList.addColumn("HSN SAC Code"); //12
            DataModelInsertedList.addColumn("Invoice No");//13
            DataModelInsertedList.addColumn("Invoice Date"); //14
            DataModelInsertedList.addColumn("Book Code"); //15
            DataModelInsertedList.addColumn("MIR Type"); //16
            DataModelInsertedList.addColumn("Legacy No"); //17
            DataModelInsertedList.addColumn("Legacy Date"); //18
            DataModelInsertedList.addColumn("Company Id"); //20
//            DataModelPJVList.addColumn("Rate"); //10
//            DataModelPJVList.addColumn("Taxable Value"); //11
//            DataModelPJVList.addColumn("Integrated Tax Paid"); //12
//            DataModelPJVList.addColumn("Central Tax Paid"); //13
//            DataModelPJVList.addColumn("State/UT Tax Paid"); //14
//            DataModelPJVList.addColumn("Cess Paid"); //15
//            DataModelPJVList.addColumn("Eligibility For ITC"); //16
//            DataModelPJVList.addColumn("Availed ITC Integrated Tax"); //17
//            DataModelPJVList.addColumn("Availed ITC Central Tax"); //18
//            DataModelPJVList.addColumn("Availed ITC State/UT Tax"); //19
//            DataModelPJVList.addColumn("Availed ITC Cess");//20
/*
              DataModelPJVList.SetVariable(0,"UPLOADED"); 
            DataModelPJVList.SetVariable(1,"UPLOADED_MONTH"); 
            DataModelPJVList.SetVariable(2,"REMARKS");
            DataModelPJVList.SetVariable(4, "SUB_ACCOUNT_CODE");
            DataModelPJVList.SetVariable(5,"SUB_ACCOUNT_NAME");
            DataModelPJVList.SetVariable(6,"GSTIN_NO");
            DataModelPJVList.SetVariable(7,"VOUCHER_NO");
            DataModelPJVList.SetVariable(8, "VOUCHER_DATE");
            DataModelPJVList.SetVariable(9, "MAIN_ACCOUNT_CODE");
            DataModelPJVList.SetVariable(10, "MAIN_ACCOUNT_NAME");
            DataModelPJVList.SetVariable(11, "AMOUNT");
            DataModelPJVList.SetVariable(12, "HSN_SAC_CODE");
            DataModelPJVList.SetVariable(13, "INVOICE_NO");
            DataModelPJVList.SetVariable(14, "INVOICE_DATE");
            DataModelPJVList.SetVariable(15, "BOOK_CODE");
            DataModelPJVList.SetVariable(16, "VOUCHER_TYPE");
            DataModelPJVList.SetVariable(17, "LEGACY_NO");
            DataModelPJVList.SetVariable(18,"LEGACY_DATE");
            DataModelPJVList.SetVariable(19, "COMPANY_ID");
            
     */       
            
            
//            DataModelPJVList.SetNumeric(7, true);
//            DataModelPJVList.SetNumeric(11, true);
//            DataModelPJVList.SetNumeric(12, true);
//            DataModelPJVList.SetNumeric(13, true);
//            DataModelPJVList.SetNumeric(14, true);
//            DataModelPJVList.SetNumeric(15, true);
//            DataModelPJVList.SetNumeric(16, true);
//            

//            for (int i = 0; i <= 21; i++) {
//                DataModelPJVList.SetReadOnly(i);
//            }

//            Table.getColumnModel().getColumn(0).setMinWidth(30);
//            for (int i = 1; i <= 21; i++) {
//                Table.getColumnModel().getColumn(i).setMinWidth(100);
//            }
//            TableInserted.getColumnModel().getColumn(0).setMaxWidth(20);
//            TableInserted.getColumnModel().getColumn(1).setMinWidth(100);
//            TableInserted.getColumnModel().getColumn(3).setMaxWidth(40);
//            
        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, "Enter Correct Details in Table. Error is : " + e.getMessage(), "ERROR", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    
    public void GenerateData(String Parameter) {
        double IGSTAmt = 0, CGSTAmt = 0, SGSTAmt = 0;
        try {
            String strCondition="";
            if(!txtFromDate.getText().trim().equals("")){
                strCondition+=" AND MIR_DATE>='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' ";
            }
            if(!txtToDate.getText().trim().equals("")){
                strCondition+=" AND MIR_DATE<='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"' ";
            }
            if(!txtVoucherNo.getText().trim().equals("")){
                strCondition+=" AND D.MIR_NO LIKE '"+txtVoucherNo.getText()+"' ";
            }
            /*String strSQL = "SELECT H.INVOICE_NO,H.INVOICE_DATE,H.INVOICE_AMOUNT,H.SUPP_ID,H.PARTY_NAME, D.* "
                    + "FROM DINESHMILLS23008022019.D_INV_MIR_HEADER H,"
                    + "DINESHMILLS23008022019.D_INV_MIR_DETAIL D WHERE D.MIR_NO=H.MIR_NO AND"
                    + "H.COMPANY_ID=D.COMPANY_ID AND H.APPROVED=1 AND H.CANCELLED=0 AND D.MIR_TYPE=3";
            */
            String strSQL="SELECT H.INVOICE_NO,H.INVOICE_DATE,H.INVOICE_AMOUNT,H.SUPP_ID,H.PARTY_NAME,H.MIR_DATE, D.* "
                    + "FROM DINESHMILLS23008022019.D_INV_MIR_HEADER H, "
                    + "DINESHMILLS23008022019.D_INV_MIR_DETAIL D WHERE D.MIR_NO=H.MIR_NO AND "
                    + "H.COMPANY_ID=D.COMPANY_ID AND H.APPROVED=1 AND H.CANCELLED=0 AND D.MIR_TYPE=3 "
                    +" AND D.COMPANY_ID="+cmbCompanyTypeModel.getCode((long) cmbCompany.getSelectedIndex())+" "
                    +strCondition
                    +" ORDER BY INVOICE_NO,INVOICE_DATE,H.MIR_NO,H.MIR_DATE";
            System.out.println("QUERY : "+strSQL);
            ResultSet rs = data.getResult(strSQL);
            int cnt = 1;
            String pName = "";
            while (!rs.isAfterLast()) {

                Object[] rowData = new Object[25];
                // rowData[0]=rs.getString("");
                /*if(Parameter.equals("NOT_UPLOADED")){
                String voucherNo=UtilFunctions.getString(rs, "VOUCHER_NO", "");
                Date voucherDate=rs.getDate("VOUCHER_DATE");
                System.out.println(voucherDate);
                String mainAccCode=UtilFunctions.getString(rs, "MAIN_ACCOUNT_CODE", "");
                int srNo=UtilFunctions.getInt(rs, "SR_NO", 0);
                int datafound=data.getIntValueFromDB("SELECT COUNT(*) FROM FINANCE.D_FIN_GST_UPLOADED_DETAIL WHERE VOUCHER_NO='"+voucherNo+"' AND VOUCHER_DATE='"+voucherDate+"' "
                        + " AND VOUCHER_SR_NO="+srNo+" AND MAIN_ACCOUNT_CODE='"+mainAccCode+"'"); 
                if(datafound>0){
                    rs.next();
                    continue;
                }
                }
                */
                IGSTAmt = Double.parseDouble(UtilFunctions.getString(rs, "COLUMN_5_AMT", ""));
                CGSTAmt = Double.parseDouble(UtilFunctions.getString(rs, "COLUMN_3_AMT", ""));
                SGSTAmt = Double.parseDouble(UtilFunctions.getString(rs, "COLUMN_4_AMT", ""));
                
                if(IGSTAmt>0){
                rowData[0]=new Boolean(false);
                rowData[3] = cnt++;                
                String PartyCode=UtilFunctions.getString(rs, "SUPP_ID", "");
                rowData[4] =PartyCode;             
                String PartyName=data.getStringValueFromDB("SELECT DISTINCT SUPP_NAME FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
                String GSTINNo=data.getStringValueFromDB("SELECT DISTINCT GSTIN_NO FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
                rowData[5]=PartyName;
                rowData[6]=GSTINNo;                
                rowData[7] = UtilFunctions.getString(rs, "MIR_NO", "");
                rowData[8] = EITLERPGLOBAL.formatDate(rs.getDate("MIR_DATE"));
                rowData[9] = "231758";
                String MainAccountName=data.getStringValueFromDB("SELECT DISTINCT ACCOUNT_NAME FROM FINANCE.D_FIN_GL WHERE APPROVED=1 AND MAIN_ACCOUNT_CODE='231758'");
                rowData[10] = MainAccountName;                
                rowData[11]="";               
                           
                rowData[12] = IGSTAmt;
                rowData[14] = UtilFunctions.getString(rs, "HSN_SAC_CODE", "");
                //if (rs.getString("INVOICE_DATE").equals("") || rs.getString("INVOICE_DATE")==null || rs.getString("INVOICE_DATE").equals("0000-00-00")) {
                //    rowData[6] = "";
                //} else {
                //    rowData[6] = df.format(rs.getDate("INVOICE_DATE"));
                //}
                rowData[15]=UtilFunctions.getString(rs, "INVOICE_NO", "");
                rowData[16] = EITLERPGLOBAL.formatDate(UtilFunctions.getString(rs, "INVOICE_DATE", ""));
                rowData[17]="";//BOOK CODE
                rowData[18] = UtilFunctions.getString(rs, "MIR_TYPE", "");//VOUCHER TYPE
                rowData[19] = "";//LEGACY NO
                rowData[20] = ""; //LEGACY DATE
                rowData[21] = UtilFunctions.getInt(rs, "COMPANY_ID", 0);
                rowData[22] = UtilFunctions.getInt(rs, "SR_NO", 0);
                DataModelPJVList.addRow(rowData);
                    
                }
                if(CGSTAmt>0){
                    rowData[0]=new Boolean(false);
                rowData[3] = cnt++;                
                String PartyCode=UtilFunctions.getString(rs, "SUPP_ID", "");
                rowData[4] =PartyCode;             
                String PartyName=data.getStringValueFromDB("SELECT DISTINCT SUPP_NAME FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
                String GSTINNo=data.getStringValueFromDB("SELECT DISTINCT GSTIN_NO FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
                rowData[5]=PartyName;
                rowData[6]=GSTINNo;                
                rowData[7] = UtilFunctions.getString(rs, "MIR_NO", "");
                rowData[8] = EITLERPGLOBAL.formatDate(rs.getDate("MIR_DATE"));
                rowData[9] = "231756";
                String MainAccountName=data.getStringValueFromDB("SELECT DISTINCT ACCOUNT_NAME FROM FINANCE.D_FIN_GL WHERE APPROVED=1 AND MAIN_ACCOUNT_CODE='231756'");
                rowData[10] = MainAccountName;                
                rowData[11]="";               
                           
                rowData[12] = CGSTAmt;
                rowData[14] = UtilFunctions.getString(rs, "HSN_SAC_CODE", "");
                //if (rs.getString("INVOICE_DATE").equals("") || rs.getString("INVOICE_DATE")==null || rs.getString("INVOICE_DATE").equals("0000-00-00")) {
                //    rowData[6] = "";
                //} else {
                //    rowData[6] = df.format(rs.getDate("INVOICE_DATE"));
                //}
                rowData[15]=UtilFunctions.getString(rs, "INVOICE_NO", "");
                rowData[16] = EITLERPGLOBAL.formatDate(UtilFunctions.getString(rs, "INVOICE_DATE", ""));
                rowData[17]="";//BOOK CODE
                rowData[18] = UtilFunctions.getString(rs, "MIR_TYPE", "");//VOUCHER TYPE
                rowData[19] = "";//LEGACY NO
                rowData[20] = ""; //LEGACY DATE
                rowData[21] = UtilFunctions.getInt(rs, "COMPANY_ID", 0);
                rowData[22] = UtilFunctions.getInt(rs, "SR_NO", 0);
                DataModelPJVList.addRow(rowData);
                }
                if(SGSTAmt>0){
                 rowData[0]=new Boolean(false);
                rowData[3] = cnt++;                
                String PartyCode=UtilFunctions.getString(rs, "SUPP_ID", "");
                rowData[4] =PartyCode;             
                String PartyName=data.getStringValueFromDB("SELECT DISTINCT SUPP_NAME FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
                String GSTINNo=data.getStringValueFromDB("SELECT DISTINCT GSTIN_NO FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
                rowData[5]=PartyName;
                rowData[6]=GSTINNo;                
                rowData[7] = UtilFunctions.getString(rs, "MIR_NO", "");
                rowData[8] = EITLERPGLOBAL.formatDate(rs.getDate("MIR_DATE"));
                rowData[9] = "231757";
                String MainAccountName=data.getStringValueFromDB("SELECT DISTINCT ACCOUNT_NAME FROM FINANCE.D_FIN_GL WHERE APPROVED=1 AND MAIN_ACCOUNT_CODE='231757'");
                rowData[10] = MainAccountName;                
                rowData[11]="";               
                           
                rowData[12] = SGSTAmt;
                rowData[14] = UtilFunctions.getString(rs, "HSN_SAC_CODE", "");
                //if (rs.getString("INVOICE_DATE").equals("") || rs.getString("INVOICE_DATE")==null || rs.getString("INVOICE_DATE").equals("0000-00-00")) {
                //    rowData[6] = "";
                //} else {
                //    rowData[6] = df.format(rs.getDate("INVOICE_DATE"));
                //}
                rowData[15]=UtilFunctions.getString(rs, "INVOICE_NO", "");
                rowData[16] = EITLERPGLOBAL.formatDate(UtilFunctions.getString(rs, "INVOICE_DATE", ""));
                rowData[17]="";//BOOK CODE
                rowData[18] = UtilFunctions.getString(rs, "MIR_TYPE", "");//VOUCHER TYPE
                rowData[19] = "";//LEGACY NO
                rowData[20] = ""; //LEGACY DATE
                rowData[21] = UtilFunctions.getInt(rs, "COMPANY_ID", 0);
                rowData[22] = UtilFunctions.getInt(rs, "SR_NO", 0);
                DataModelPJVList.addRow(rowData);    
                }
//                rowData[0]=new Boolean(false);
//                rowData[3] = cnt++;                
//                String partyCode=UtilFunctions.getString(rs, "SUPP_ID", "");
//                rowData[4] =partyCode;             
//                String PartyName=data.getStringValueFromDB("SELECT DISTINCT SUPP_NAME FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
//                String GSTINNo=data.getStringValueFromDB("SELECT DISTINCT GSTIN_NO FROM D_COM_SUPP_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND BLOCKED='N' AND APPROVED=1 AND SUPPLIER_CODE='"+PartyCode+"'");
//                rowData[5]=PartyName;
//                rowData[6]=GSTINNo;                
//                rowData[7] = UtilFunctions.getString(rs, "MIR_NO", "");
//                rowData[8] = EITLERPGLOBAL.formatDate(rs.getDate("MIR_DATE"));
//                rowData[9] = UtilFunctions.getString(rs, "MAIN_ACCOUNT_CODE", "");
//                String MainAccountName=data.getStringValueFromDB("SELECT DISTINCT ACCOUNT_NAME FROM FINANCE.D_FIN_GL WHERE APPROVED=1 AND MAIN_ACCOUNT_CODE='"+UtilFunctions.getString(rs, "MAIN_ACCOUNT_CODE", "")+"'");
//                rowData[10] = "";                
//                rowData[11]="";               
//                           
//                rowData[12] = UtilFunctions.getString(rs, "AMOUNT", "");
//                rowData[14] = UtilFunctions.getString(rs, "HSN_SAC_CODE", "");
//                //if (rs.getString("INVOICE_DATE").equals("") || rs.getString("INVOICE_DATE")==null || rs.getString("INVOICE_DATE").equals("0000-00-00")) {
//                //    rowData[6] = "";
//                //} else {
//                //    rowData[6] = df.format(rs.getDate("INVOICE_DATE"));
//                //}
//                rowData[15]=UtilFunctions.getString(rs, "INVOICE_NO", "");
//                rowData[16] = EITLERPGLOBAL.formatDate(UtilFunctions.getString(rs, "INVOICE_DATE", ""));
//                rowData[17]="";//BOOK CODE
//                rowData[18] = "";//VOUCHER TYPE
//                rowData[19] = "";//LEGACY NO
//                rowData[20] = ""; //LEGACY DATE
//                rowData[21] = UtilFunctions.getInt(rs, "COMPANY_ID", 0);
//                rowData[22] = UtilFunctions.getInt(rs, "SR_NO", 0);
//                DataModelPJVList.addRow(rowData);
                rs.next();
            }
            rs.close();

        } catch (SQLException sqe) {
            sqe.printStackTrace();
        }
        

    }   
    
    
    public void GenerateInsertedData(String Parameter) {
        double IGSTAmt = 0, CGSTAmt = 0, SGSTAmt = 0;
        try {
            String strCondition="";
            if(!txtFromDate.getText().trim().equals("")){
                strCondition+=" AND MIR_DATE>='"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' ";
            }
            if(!txtToDate.getText().trim().equals("")){
                strCondition+=" AND MIR_DATE<='"+EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"' ";
            }
            if(Parameter.equals("AMOUNT_MATCHES")){
                strCondition+= " AND DIFFER_AMOUNT=0.00 ";                
            }
            if(Parameter.equals("AMOUNT_DIFFERS")){
                strCondition+= " AND DIFFER_AMOUNT!=0.00 ";                
            }
        
            String strSQL = "SELECT * FROM FINANCE.D_FIN_UNACCOUNTED_GST_UPLOADED_DETAIL WHERE UPLOADED=1 AND MAIN_ACCOUNT_CODE IN ('231756','231757','231758') "+strCondition                    
                          + "ORDER BY INVOICE_NO,INVOICE_DATE,MIR_NO,MIR_DATE";
                    
            
            /*String strSQL = "SELECT D.VOUCHER_NO AS VOUCHER_NO,EFFECT,MAIN_ACCOUNT_CODE,AMOUNT,D.REMARKS,PO_NO,PO_DATE,INVOICE_NO,INVOICE_DATE,"
                    + "GRN_NO,GRN_DATE,INVOICE_AMOUNT,D.LINK_NO,REF_VOUCHER_NO,HSN_SAC_CODE,ITEM_DESCRIPTION,"
                    + "VOUCHER_DATE,BOOK_CODE,CHEQUE_NO,CHEQUE_DATE,CHEQUE_AMOUNT,VOUCHER_TYPE,"
                    + "LEGACY_NO,LEGACY_DATE,D.COMPANY_ID AS COMPANY_ID FROM FINANCE.D_FIN_VOUCHER_HEADER H,FINANCE.D_FIN_VOUCHER_DETAIL D WHERE "
                    + "H.COMPANY_ID=D.COMPANY_ID AND H.VOUCHER_NO=D.VOUCHER_NO AND H.APPROVED=1 AND "
                    + "H.CANCELLED=0 AND H.COMPANY_ID="+cmbCompanyTypeModel.getCode((long) cmbCompany.getSelectedIndex())+" "
                    + "AND D.COMPANY_ID="+cmbCompanyTypeModel.getCode((long) cmbCompany.getSelectedIndex())+" AND D.MAIN_ACCOUNT_CODE IN "
                    + "('231756','231757','231758') "+strCondition
                    +" ORDER BY VOUCHER_DATE";
                    */
            System.out.println("QUERY : "+strSQL);
            ResultSet rs = data.getResult(strSQL);
            int cnt = 1;
            String pName = "";
            while (!rs.isAfterLast()) {

                Object[] rowData = new Object[25];
                // rowData[0]=rs.getString("");
                rowData[0]=cnt++;
                rowData[1]=UtilFunctions.getString(rs, "UPLOADED_MONTH", "");
                rowData[2] = UtilFunctions.getString(rs, "REMARKS", "");
                rowData[3] =UtilFunctions.getString(rs, "SUB_ACCOUNT_CODE", "");                                
                rowData[4]=UtilFunctions.getString(rs, "SUB_ACCOUNT_NAME", "");
                rowData[5]=UtilFunctions.getString(rs, "GSTIN_NO", "");                
                rowData[6] = UtilFunctions.getString(rs, "MIR_NO", "");
                rowData[7] = EITLERPGLOBAL.formatDate(rs.getDate("MIR_DATE"));
                rowData[8] = UtilFunctions.getString(rs, "MAIN_ACCOUNT_CODE", "");                
                rowData[9] = UtilFunctions.getString(rs, "MAIN_ACCOUNT_NAME", "");                
//                if(UtilFunctions.getString(rs,"EFFECT","").equals("C")){
//                    rowData[10]="Cr";
//                }else{
//                rowData[10]="Dr";
//                }
                rowData[10]="";
                rowData[11] = UtilFunctions.getString(rs, "AMOUNT", "");
                rowData[12] = UtilFunctions.getString(rs, "DIFFER_AMOUNT", "");
                rowData[13] = UtilFunctions.getString(rs, "HSN_SAC_CODE", "");
                //if (rs.getString("INVOICE_DATE").equals("") || rs.getString("INVOICE_DATE")==null || rs.getString("INVOICE_DATE").equals("0000-00-00")) {
                //    rowData[6] = "";
                //} else {
                //    rowData[6] = df.format(rs.getDate("INVOICE_DATE"));
                //}
                rowData[14]=UtilFunctions.getString(rs, "INVOICE_NO", "");
                rowData[15] = EITLERPGLOBAL.formatDate(UtilFunctions.getString(rs, "INVOICE_DATE", ""));
                rowData[16]=UtilFunctions.getString(rs, "BOOK_CODE", "");
                rowData[17] = UtilFunctions.getString(rs, "MIR_TYPE", "");
                rowData[18] = UtilFunctions.getString(rs, "LEGACY_NO", "");
                rowData[19] = EITLERPGLOBAL.formatDate(UtilFunctions.getString(rs, "LEGACY_DATE", ""));
                rowData[20] = UtilFunctions.getInt(rs, "COMPANY_ID", 0);
//                rowData[10] = "R";
//                rowData[11] = UtilFunctions.getInt(rs, "TAX_RATE", 0);
//                rowData[12] = UtilFunctions.getInt(rs, "TAXABLE_AMOUNT", 0);
//                rowData[13] = UtilFunctions.getInt(rs, "IGST_AMOUNT", 0);
//                IGSTAmt += UtilFunctions.getDouble(rs, "IGST_AMOUNT", 0);
//                rowData[14] = UtilFunctions.getInt(rs, "CGST_AMOUNT", 0);
//                CGSTAmt += UtilFunctions.getDouble(rs, "CGST_AMOUNT", 0);
//                rowData[15] = UtilFunctions.getInt(rs, "SGST_AMOUNT", 0);
//                SGSTAmt += UtilFunctions.getDouble(rs, "SGST_AMOUNT", 0);
//                rowData[16] = UtilFunctions.getInt(rs, "CESS_AMOUNT", 0);
//                rowData[17] = "0";
//                rowData[18] = "0";
//                rowData[19] = "0";
//                rowData[20] = "0";
//                rowData[21] = "0";

                DataModelInsertedList.addRow(rowData);
                rs.next();
            }
            rs.close();

        } catch (SQLException sqe) {
            sqe.printStackTrace();
        }
        

    }
    
    
    
 private void GenerateListToUpload(){
      try { 
            
            ObjGSTPJVMatching.hmListItems.clear();
            //hmListToUpload.clear();            
            for(int r=0;r<Table.getRowCount();r++) {
                if(Table.getValueAt(r,0).equals(new Boolean(true))) {
                    clsGSTUnaccountedMatching objItem=new clsGSTUnaccountedMatching();
                    
                    objItem.setAttribute("MIR_NO",DataModelPJVList.getValueAt(r, 7).toString());
                    objItem.setAttribute("MIR_DATE",DataModelPJVList.getValueAt(r,8).toString());
                    objItem.setAttribute("COMPANY_ID",Integer.parseInt(DataModelPJVList.getValueAt(r,21).toString()));
                    objItem.setAttribute("MIR_SR_NO",Integer.parseInt(DataModelPJVList.getValueAt(r,22).toString()));
                    System.out.println(DataModelPJVList.getValueAt(r,0));
                    int Uploaded = (Boolean)DataModelPJVList.getValueAt(r,0) ? 1 : 0;
                    //objItem.setAttribute("UPLOADED",DataModelPJVList.getValueAt(r,0));
                    objItem.setAttribute("UPLOADED", Uploaded);
                    objItem.setAttribute("UPLOADED_MONTH",DataModelPJVList.getValueAt(r,1).toString());
                    objItem.setAttribute("REMARKS",DataModelPJVList.getValueAt(r,2).toString());
                    objItem.setAttribute("SUB_ACCOUNT_CODE",DataModelPJVList.getValueAt(r,4).toString());
                    objItem.setAttribute("SUB_ACCOUNT_NAME",DataModelPJVList.getValueAt(r,5).toString());
                    objItem.setAttribute("GSTIN_NO",DataModelPJVList.getValueAt(r,6).toString());
                    objItem.setAttribute("MAIN_ACCOUNT_CODE", DataModelPJVList.getValueAt(r, 9).toString());
                    objItem.setAttribute("MAIN_ACCOUNT_NAME", DataModelPJVList.getValueAt(r, 10).toString());                                   
                    objItem.setAttribute("AMOUNT",Double.parseDouble(DataModelPJVList.getValueAt(r,12).toString()));
                    //if(DataModelPJVList.getValueAt(r,13).toString().equals("")){
                        objItem.setAttribute("DIFFER_AMOUNT",0.00);
                    //}else{
                    //objItem.setAttribute("DIFFER_AMOUNT",Double.parseDouble(DataModelPJVList.getValueAt(r,13).toString()));
                    //}
                    //objItem.setAttribute("DIFFER_AMOUNT",DataModelPJVList.getValueAt(r,13).toString());
                    objItem.setAttribute("HSN_SAC_CODE", DataModelPJVList.getValueAt(r, 14).toString());
                    objItem.setAttribute("INVOICE_NO",DataModelPJVList.getValueAt(r,15).toString());
                    objItem.setAttribute("INVOICE_DATE",DataModelPJVList.getValueAt(r,16).toString());
                    objItem.setAttribute("BOOK_CODE", 0);
                    objItem.setAttribute("MIR_TYPE", Integer.parseInt(DataModelPJVList.getValueAt(r, 18).toString()));
                    objItem.setAttribute("LEGACY_NO","");
                    objItem.setAttribute("LEGACY_DATE","");
                    
//                    if(DataModelPJVList.getValueAt(r,11).equals("Cr")) {
//                objItem.setAttribute("EFFECT","C");
//            }
//            else {
//                objItem.setAttribute("EFFECT","D");
//            }
                    objItem.setAttribute("EFFECT","");
                    //objItem.setAttribute("COMPANY_ID",UtilFunctions.CInt(DataModelPJVList.getValueByVariable("COMPANY_ID",r)));
                    
                    //hmListToUpload.put(Integer.toString(hmListToUpload.size()+1),objItem);
                    ObjGSTPJVMatching.hmListItems.put(Integer.toString(ObjGSTPJVMatching.hmListItems.size()+1), objItem);
                    System.out.println(ObjGSTPJVMatching.hmListItems.size());
                }
            }            
            //Cancelled=false;
            //aDialog.dispose();            
        }
        catch(Exception e) {
            //Cancelled=true;
            //aDialog.dispose();
            e.printStackTrace();
        }
        
}
  
 
}
