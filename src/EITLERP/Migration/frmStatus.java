/*
 * frmStatus.java
 *
 * Created on July 9, 2004, 11:18 AM
 */

package EITLERP.Migration;

/*<APPLET CODE=frmStatus.class HEIGHT=113 WIDTH=400></APPLET>*/
/**
 * 
 * @author  root
 */
import EITLERP.*;
import javax.swing.*;
import java.awt.*;
import java.awt.Frame;
import java.sql.*;
import java.net.*;
import EITLERP.JavaMail.*;


public class frmStatus extends javax.swing.JApplet {

    private JDialog aDialog;
    public int MaxVal=0;
    public int MinVal=0;

    
    /** Initializes the applet frmStatus */
    public void init() {
        setSize(400,113);
        initComponents();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        lblStatus = new javax.swing.JLabel();
        Bar = new javax.swing.JProgressBar();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        
        getContentPane().setLayout(null);
        
        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });
        
        lblStatus.setText("...");
        getContentPane().add(lblStatus);
        lblStatus.setBounds(7, 13, 367, 15);
        
        getContentPane().add(Bar);
        Bar.setBounds(9, 48, 366, 14);
        
        jButton1.setText("Change Resolution");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        
        getContentPane().add(jButton1);
        jButton1.setBounds(22, 105, 180, 25);
        
        jButton2.setText("jButton2");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        
        getContentPane().add(jButton2);
        jButton2.setBounds(222, 106, 88, 25);
        
    }//GEN-END:initComponents

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        
        JOptionPane.showMessageDialog(null,"Sending Message");
        
        try {
            JMail.SendMail(EITLERPGLOBAL.SMTPHostIP, "Andrews Smith <andrews@microsoft.com>", "ankit2280@yahoo.co.in",  "Dear Candidate \n\nI got the knowledge about you from our sources. I have read your resume and I am deeply impressed by your biodata and work you have done. We are in search of technical people who can work in Visual Basic and have passion for innovating new things. I found you suitable for the same post. If you are interested to work with microsoft, urgently reply and send your detailed resume.\n\nRegards\n\nAndrews\n\nMicrosoft India. ","Contact Urgently " ,"");
            
            //nv@essar.com
            
            JOptionPane.showMessageDialog(null,"Message Sent ok");
        }
        catch(Exception e) {
            JOptionPane.showMessageDialog(null,"Send error "+e.getMessage());
        }

        
            //setCursor(new Cursor(Cursor.WAIT_CURSOR));
            /*try
            {
              Connection tmpConn;
              Statement stTmp;
              ResultSet rsTmp;
              
              tmpConn=data.getConn();
              stTmp=tmpConn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE ,ResultSet.CONCUR_UPDATABLE);
              rsTmp=stTmp.executeQuery("SELECT * FROM D_INV_GRN_DETAIL LIMIT 2500");
              rsTmp.first();
                            
              rsTmp.refreshRow();
              
            }
            catch(Exception e)
            {
                //JOptionPane.showMessageDialog(null,e.getMessage());
            }*/
        
            
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
    setCursor(new Cursor(Cursor.DEFAULT_CURSOR));        
    }//GEN-LAST:event_jButton1ActionPerformed

    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JProgressBar Bar;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel lblStatus;
    // End of variables declaration//GEN-END:variables

public void SetStatusText(String pText)    
{
   lblStatus.setText(pText);
}

public void InitBar(int pMax,int pMin)
{
   Bar.setMaximum(pMax);
   Bar.setMinimum(pMin);
   Bar.setValue(0);
}

public void SetValue(int pValue)
{
    Bar.setValue(pValue);
}

//Recurses through the hierarchy of classes 
//until it finds Frame 
private Frame findParentFrame(JApplet pApplet)
{ 
    Container c = (Container) pApplet; 
    while(c != null)
    { 
      if (c instanceof Frame) 
        return (Frame)c; 

      c = c.getParent(); 
    } 
    return (Frame)null; 
}


    public boolean ShowDialog()
    {
        try
        {
          setSize(400,113);
          initComponents();
          
          Frame f=findParentFrame(this);              
          
          aDialog=new JDialog(f,"Process Status",false);
          
          aDialog.getContentPane().add("Center",this);
          Dimension appletSize = this.getSize();
          aDialog.setSize(appletSize);
          aDialog.setResizable(false);
                
          //Place it to center of the screen
          Dimension screenSize=Toolkit.getDefaultToolkit().getScreenSize();
          aDialog.setLocation((int)(screenSize.width-appletSize.getWidth())/2,(int)(screenSize.height-appletSize.getHeight())/2);
          
          aDialog.setDefaultCloseOperation(javax.swing.JDialog.DISPOSE_ON_CLOSE);
          aDialog.show();  
        }
        catch(Exception e)
        {
        }
          return false;
    }
    
    
public void CloseDialog()    
{
    aDialog.dispose();
    

    
}
}
