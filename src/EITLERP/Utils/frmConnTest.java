/*
 * frmConnTest.java
 *
 * Created on September 30, 2005, 3:15 PM
 */

package EITLERP.Utils;

import java.sql.*;
import javax.swing.*;
import java.awt.*;
import EITLERP.*;
import EITLERP.Sales.*;
import EITLERP.Finance.*;


/**
 *
 * @author  root
 */
public class frmConnTest extends javax.swing.JApplet {
    
    /** Initializes the applet frmConnTest */
    public void init() {
        initComponents();
        setSize(400, 300);
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        txtSJPost = new javax.swing.JButton();
        cmdCurrpttedVoucher = new javax.swing.JButton();
        lblVoucherNo = new javax.swing.JLabel();
        btnAddress = new javax.swing.JButton();
        txtPartyCode = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();

        getContentPane().setLayout(null);

        jButton1.setText("jButton1");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton1);
        jButton1.setBounds(30, 30, 88, 25);

        jButton2.setText("ADD PARTY TO FINANCE");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton2);
        jButton2.setBounds(190, 60, 200, 25);

        jButton3.setText("ProcessStock");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton3);
        jButton3.setBounds(30, 140, 160, 25);

        txtSJPost.setText("SJ post");
        txtSJPost.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSJPostActionPerformed(evt);
            }
        });

        getContentPane().add(txtSJPost);
        txtSJPost.setBounds(40, 180, 78, 25);

        cmdCurrpttedVoucher.setText("Find Curptted Voucher");
        cmdCurrpttedVoucher.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdCurrpttedVoucherActionPerformed(evt);
            }
        });

        getContentPane().add(cmdCurrpttedVoucher);
        cmdCurrpttedVoucher.setBounds(30, 220, 203, 25);

        lblVoucherNo.setText("...");
        getContentPane().add(lblVoucherNo);
        lblVoucherNo.setBounds(20, 260, 370, 15);

        btnAddress.setText("ADD ADDRESS IN FIN PARTY");
        btnAddress.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddressActionPerformed(evt);
            }
        });

        getContentPane().add(btnAddress);
        btnAddress.setBounds(30, 90, 240, 25);

        txtPartyCode.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPartyCodeActionPerformed(evt);
            }
        });

        getContentPane().add(txtPartyCode);
        txtPartyCode.setBounds(230, 30, 160, 19);

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("Party Code :");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(130, 30, 90, 15);

    }//GEN-END:initComponents

    private void txtPartyCodeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPartyCodeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtPartyCodeActionPerformed

    private void btnAddressActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddressActionPerformed
        // TODO add your handling code here:
        
        new Thread() {
            public void run() {
                try {
                    ResultSet rsResult;
                    ResultSet rsData = data.getResult("SELECT DISTINCT A.PARTY_CODE FROM FINANCE.D_FIN_PARTY_MASTER A, DINESHMILLS.D_COM_SUPP_MASTER B " +
                    "WHERE A.PARTY_CODE=B.SUPPLIER_CODE AND A.ADDRESS ='' AND A.PARTY_CODE<>'' AND B.ADD1<>'' ORDER BY A.PARTY_CODE",FinanceGlobal.FinURL);
                    while(!rsData.isAfterLast()) 
                    {
                        String PartyCode = UtilFunctions.getString(rsData,"PARTY_CODE", "");
                        if(data.IsRecordExist("SELECT * FROM D_COM_SUPP_MASTER WHERE SUPPLIER_CODE ='"+PartyCode+"'",EITLERPGLOBAL.DatabaseURL))
                        {    
                            
                             String StrQry = "SELECT * FROM D_COM_SUPP_MASTER WHERE SUPPLIER_CODE ='"+PartyCode+"'";
                            rsResult = data.getResult(StrQry,EITLERPGLOBAL.DatabaseURL);
                            rsResult.first();
                           while(!rsResult.isAfterLast())
                           {
                               String Add1 = rsResult.getString("ADD1");
                               String Add2 = rsResult.getString("ADD2");
                               String Add3 = rsResult.getString("ADD3");
                               String Pincode =rsResult.getString("PINCODE");
                               String City = rsResult.getString("CITY");
                               String State = rsResult.getString("STATE");
                               String Country =rsResult.getString("COUNTRY");
                               String Address =Add1 +" "+Add2 +" "+Add3;
                        
                               data.Execute("UPDATE FINANCE.D_FIN_PARTY_MASTER SET ADDRESS ='"+Address+"',CITY = '"+City+"',STATE ='"+State+"',COUNTRY ='"+Country+"',CHANGED=1,PINCODE ='"+Pincode+"' WHERE PARTY_CODE="+PartyCode);                        
                               rsResult.next();
                           }
                            
                        } 
                        rsData.next();  
                    }      
                         
                      
                    
                    
                }catch(Exception e) {
                }
                lblVoucherNo.setText("The End........");
            };
        }.start();
    }//GEN-LAST:event_btnAddressActionPerformed
    
    private void cmdCurrpttedVoucherActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdCurrpttedVoucherActionPerformed
        // TODO add your handling code here:
        new Thread() {
            public void run() {
                try {
                    String FromDate = "2009-04-01";
                    String ToDate = EITLERPGLOBAL.getCurrentDateDB();
                    int VoucherType = 0;
                    ResultSet rsData = data.getResult("SELECT VOUCHER_NO,COMPANY_ID FROM D_FIN_VOUCHER_HEADER WHERE  VOUCHER_DATE>='"+FromDate+"' AND VOUCHER_TYPE="+VoucherType+" AND " + 
                    "AND VOUCHER_DATE<='"+ToDate+"' AND CANCELLED=0 AND VOUCHER_NO NOT LIKE 'M%' ORDER BY COMPANY_ID,VOUCHER_NO ",FinanceGlobal.FinURL);
                    while(!rsData.isAfterLast()) {
                        
                        String VoucherNo = UtilFunctions.getString(rsData,"VOUCHER_NO", "");
                        lblVoucherNo.setText(VoucherNo);
                        int CompanyID = UtilFunctions.getInt(rsData,"COMPANY_ID", 0);
                        if(!data.IsRecordExist("SELECT * FROM D_FIN_VOUCHER_DETAIL WHERE VOUCHER_NO='"+VoucherNo+"'",FinanceGlobal.FinURL)) {
                            System.out.println("CompanyID = " + CompanyID + " VoucherNo = "+VoucherNo+" does not exists in DETAIL");
                        }
                        if(!data.IsRecordExist("SELECT * FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+VoucherNo+"'",FinanceGlobal.FinURL)) {
                            System.out.println("CompanyID = " + CompanyID + " VoucherNo = "+VoucherNo+" does not exists in DETAIL_EX");
                        }
                        if(!data.IsRecordExist("SELECT * FROM D_COM_DOC_DATA WHERE DOC_NO='"+VoucherNo+"' ", clsFinYear.getDBURL(CompanyID,2009))) {
                            System.out.println("CompanyID = " + CompanyID + " VoucherNo = "+VoucherNo+" does not exists in DOC_DATA");
                        }
                        rsData.next();
                    }
                }catch(Exception e) {
                }
                lblVoucherNo.setText("The End........");
            };
        }.start();
        
    }//GEN-LAST:event_cmdCurrpttedVoucherActionPerformed
    
    private void txtSJPostActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSJPostActionPerformed
        // TODO add your handling code here:
        clsSalesInvoice objInvoice = new clsSalesInvoice();
        objInvoice = (clsSalesInvoice)objInvoice.getObject(2,"B000022",EITLERPGLOBAL.DatabaseURL);
        
        //objInvoice.PostSJTypeFelt(2, "F002464");
        //objInvoice.PostSJTypeFilter(2, "B000022");
        //objInvoice.PostSJTypeSuiting(2, "001024");
    }//GEN-LAST:event_txtSJPostActionPerformed
    
    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        //(new clsItemStock()).ProcessLedger("2005-04-01","2006-03-31");
    }//GEN-LAST:event_jButton3ActionPerformed
    
    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        if(txtPartyCode.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(this,"Please Enter Party Code");
        }
        (new clsSupplier()).AddPartyToFinance(txtPartyCode.getText().trim());
        //(new clsSupplier()).AddPartyToExternalDB(txtPartyCode.getText().trim(),"jdbc:mysql://200.0.0.227:3306/DINESHMILLSA" );
        data.Execute("UPDATE D_FIN_PARTY_MASTER SET MAIN_ACCOUNT_CODE='125019' WHERE PARTY_CODE='" + txtPartyCode.getText().trim() + "' ",FinanceGlobal.FinURL);
        
        JOptionPane.showMessageDialog(this,"DONE");
        //(new clsSupplier()).AddPartyToExternalDB("619686","jdbc:mysql://200.0.0.227:3306/DINESHMILLSA" );
       /* try {
            ResultSet rsTmp ;
        } catch(Exception e) {
            e.printStackTrace();
        }
        */
    }//GEN-LAST:event_jButton2ActionPerformed
    
    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        
        try {
            
            Class.forName("org.gjt.mm.mysql.Driver").newInstance();
            Connection con=DriverManager.getConnection("jdbc:mysql://200.0.0.227:3306/MTT","admin","admin");
        }
        catch(Exception e) {
            JOptionPane.showMessageDialog(null,e.getMessage());
        }
        
    }//GEN-LAST:event_jButton1ActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAddress;
    private javax.swing.JButton cmdCurrpttedVoucher;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel lblVoucherNo;
    private javax.swing.JTextField txtPartyCode;
    private javax.swing.JButton txtSJPost;
    // End of variables declaration//GEN-END:variables
    
}
