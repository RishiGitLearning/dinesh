/*
 * frmRptGRNInfo.java
 *
 * Created on April 16, 2008, 12:01 PM
 */

package EITLERP.Finance.ReportsUI;

/**
 *
 * @author  root
 */
import EITLERP.*;
import EITLERP.Finance.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.net.*;
import java.util.*;
import TReportWriter.*;

public class frmRptTRBookWise_PurchaseSummaryOld extends javax.swing.JApplet {
    
    private HashMap props=new HashMap();
    public HashMap colVoucherItems=new HashMap();
    
    private TReportEngine objEngine=new TReportEngine();
    private TReportWriter.SimpleDataProvider.TTable objData = null;//new TReportWriter.SimpleDataProvider.TTable();
    
    
    /** Initializes the applet frmRptGRNInfo */
    public void init() {
        setSize(424,264);
        initComponents();
        Format();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel3 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        cmdPreview = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        txtFromDate = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        txtToDate = new javax.swing.JTextField();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jPanel3.setLayout(null);

        jPanel3.setBackground(new java.awt.Color(0, 153, 204));
        jPanel3.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel6.setText("TR Bookwise Purchase Summary");
        jPanel3.add(jLabel6);
        jLabel6.setBounds(9, 8, 370, 15);

        getContentPane().add(jPanel3);
        jPanel3.setBounds(0, 2, 800, 30);

        cmdPreview.setText("Preview ");
        cmdPreview.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPreviewActionPerformed(evt);
            }
        });

        getContentPane().add(cmdPreview);
        cmdPreview.setBounds(310, 150, 90, 25);

        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel4.setText("From Date : ");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(20, 80, 100, 20);

        txtFromDate.setColumns(10);
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(120, 80, 90, 19);

        jLabel5.setText("To Date :");
        getContentPane().add(jLabel5);
        jLabel5.setBounds(220, 80, 60, 20);

        txtToDate.setColumns(10);
        getContentPane().add(txtToDate);
        txtToDate.setBounds(280, 80, 90, 20);

    }//GEN-END:initComponents
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdPreviewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPreviewActionPerformed
        // TODO add your handling code here:
        //System.out.println("Call....1");
        if ( ! Validate()) {
            return;
        }
        GenerateReport();
    }//GEN-LAST:event_cmdPreviewActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cmdPreview;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtToDate;
    // End of variables declaration//GEN-END:variables
    
    private void Format() {
        try {
            props=new HashMap();
            props.put("SR_NO",new Variant(0));
            props.put("COMPANY_ID",new Variant(""));
            props.put("BOOK_CODE",new Variant(""));
            props.put("MAIN_ACCOUNT_CODE",new Variant(""));
            props.put("CFORM21",new Variant(""));
            props.put("CFORM22",new Variant(""));
            props.put("PUR_VATPER",new Variant(""));
            props.put("PUR_TR44",new Variant(""));
            props.put("TOTAL",new Variant(""));
        }
        catch(Exception e) {
            
        }
    }
    
    public Variant getAttribute(String PropName) {
        if(!props.containsKey(PropName)) {
            return (new Variant(""));
        }
        else {
            return (Variant) props.get(PropName);
        }
    }
    
    public void setAttribute(String PropName,String Value) {
        props.put(PropName,new Variant(Value));
    }
    
    public void setAttribute(String PropName,Object Value) {
        props.put(PropName,new Variant(Value));
    }
    
    public void setAttribute(String PropName,int Value) {
        props.put(PropName,new Variant(Value));
    }
    
    public void setAttribute(String PropName,long Value) {
        props.put(PropName,new Variant(Value));
    }
    
    public void setAttribute(String PropName,double Value) {
        props.put(PropName,new Variant(Value));
    }
    
    public void setAttribute(String PropName,float Value) {
        props.put(PropName,new Variant(Value));
    }
    
    public void setAttribute(String PropName,boolean Value) {
        props.put(PropName,new Variant(Value));
    }
    
    private void GenerateReport() {
        new Thread(){
            public void run(){
                frmProgress objProgress = new frmProgress();
                objProgress.Initialize();
                objProgress.ShowDialog();
                objProgress.setVisible(true);
                objProgress.SetMax(26);
                objProgress.SetMin(0);
                objProgress.SetValue(0);
                objProgress.repaint();
                objProgress.SetText("Starting Process");
                try {
                    double ATR44_403036=0.0,ATR44_403043=0.0,ATR44_403050=0.0,ATR44_405021=0.0,ATR44_411024=0.0,ATR44_411127=0.0,ATR44_421014=0.0,ATR44_201193=0.0,ATR44_201344=0.0,ATR44_Others=0.0;
                    double AVAT_403036=0.0,AVAT_403043=0.0,AVAT_403050=0.0,AVAT_405021=0.0,AVAT_411024=0.0,AVAT_411127=0.0,AVAT_421014=0.0,AVAT_201193=0.0,AVAT_201344=0.0,AVAT_Others=0.0;
                    double A22_403036=0.0,A22_403043=0.0,A22_403050=0.0,A22_405021=0.0,A22_411024=0.0,A22_411127=0.0,A22_421014=0.0,A22_201193=0.0,A22_201344=0.0,A22_Others=0.0;
                    double A21_403036=0.0,A21_403043=0.0,A21_403050=0.0,A21_405021=0.0,A21_411024=0.0,A21_411127=0.0,A21_421014=0.0,A21_201193=0.0,A21_201344=0.0,A21_Others=0.0;
                    double TOTAL=0.0;
                    
                    String strQry = "",MainAccCode="",Amount ="", VoucherNo="";
                    int Counter = 0;
                    
                    objData = new TReportWriter.SimpleDataProvider.TTable();
                    TReportWriter.SimpleDataProvider.TRow objRow;
                    TReportWriter.SimpleDataProvider.TTable objReportData = new TReportWriter.SimpleDataProvider.TTable();
                    
                    objReportData.AddColumn("SR_NO");
                    objReportData.AddColumn("COMPANY_ID");
                    objReportData.AddColumn("BOOK_CODE");
                    objReportData.AddColumn("MAIN_ACCOUNT_CODE");
                    objReportData.AddColumn("CFORM21");
                    objReportData.AddColumn("CFORM22");
                    objReportData.AddColumn("PUR_VATPER");
                    objReportData.AddColumn("PUR_TR44");
                    objReportData.AddColumn("TOTAL");
                    
                    Counter = 0;
                    int cnt =0;
                    for (int i=40;i<65;i++) {
                        
                        cnt++;
                        objProgress.SetValue(cnt);
                        objProgress.SetText("Processing Book Code : "+i);
                        objProgress.repaint();
                        
                        //code for OGS purchase ag. Form 'C' - 21 (extension no) ***
                        strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE, "+
                        "(SELECT SUM(AMOUNT) "+
                        "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                        "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                        "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                        "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX, "+
                        "D_FIN_VOUCHER_DETAIL  VOUDTLM  "+
                        "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                        "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+                        
                        "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                        "AND VOUHEAD.BOOK_CODE = "+i+" "+  //IN (40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64)
                        "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUHEAD.COMPANY_ID = VOUDTLM.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLM.VOUCHER_NO "+
                        "AND VOUDTLM.MAIN_ACCOUNT_CODE LIKE '%.21' AND VOUDTLM.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUDTLEX.MAIN_ACCOUNT_CODE IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                        "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE "+
                        "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                        ResultSet rs21Data = data.getResult(strQry,FinanceGlobal.FinURL);
                        
                        if (rs21Data.getRow() > 0) {
                            rs21Data.first();
                            A21_403036=0.0;A21_403043=0.0;A21_403050=0.0;A21_405021=0.0;A21_411024=0.0;A21_411127=0.0;A21_421014=0.0;A21_201193=0.0;A21_201344=0.0;
                            while (!rs21Data.isAfterLast()) {
                                MainAccCode= UtilFunctions.getString(rs21Data,"MAIN_ACCOUNT_CODE","");
                                Amount = UtilFunctions.getString(rs21Data,"AMOUNT","");
                                VoucherNo = UtilFunctions.getString(rs21Data,"VOUCHER_NO","");
                                
                                if (MainAccCode.trim().equals("403036")) {
                                    if (Amount.trim().equals("")) {
                                        A21_403036 = A21_403036 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_403036 = A21_403036 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("403043")) {
                                    if (Amount.trim().equals("")) {
                                        A21_403043 = A21_403043 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_403043 = A21_403043 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("403050")) {
                                    if (Amount.trim().equals("")) {
                                        A21_403050 = A21_403050 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_403050 = A21_403050 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("405021")) {
                                    if (Amount.trim().equals("")) {
                                        A21_405021 = A21_405021 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_405021 = A21_405021 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("411024")) {
                                    if (Amount.trim().equals("")) {
                                        A21_411024 = A21_411024 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_411024 = A21_411024 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("411127")) {
                                    if (Amount.trim().equals("")) {
                                        A21_411127 = A21_411127 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_411127 = A21_411127 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("421014")) {
                                    if (Amount.trim().equals("")) {
                                        A21_421014 = A21_421014 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_421014 = A21_421014 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("201193")) {
                                    if (Amount.trim().equals("")) {
                                        A21_201193 = A21_201193 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_201193 = A21_201193 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("201344")) {
                                    if (Amount.trim().equals("")) {
                                        A21_201344 = A21_201344 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A21_201344 = A21_201344 + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                    }
                                }
                                rs21Data.next();
                            }
                        }
                        else {
                            A21_403036=0.0;A21_403043=0.0;A21_403050=0.0;A21_405021=0.0;A21_411024=0.0;A21_411127=0.0;A21_421014=0.0;A21_201193=0.0;A21_201344=0.0;
                        }
                        rs21Data.close();
                        
                        strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE, "+
                        "(SELECT SUM(AMOUNT) "+
                        "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                        "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                        "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                        "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX, "+
                        "D_FIN_VOUCHER_DETAIL  VOUDTLM  "+
                        "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                        "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                        "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                        "AND VOUHEAD.BOOK_CODE = "+i+" "+  //IN (40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64)
                        "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+                        
                        "AND VOUHEAD.COMPANY_ID = VOUDTLM.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLM.VOUCHER_NO "+
                        "AND VOUDTLM.MAIN_ACCOUNT_CODE LIKE '%.21' AND VOUDTLM.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUDTLEX.MAIN_ACCOUNT_CODE NOT IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                        "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE "+
                        "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                        
                        rs21Data = data.getResult(strQry,FinanceGlobal.FinURL);
                        
                        if (rs21Data.getRow() > 0) {
                            rs21Data.first();
                            A21_Others = 0.0;
                            while(!rs21Data.isAfterLast()) {
                                MainAccCode= UtilFunctions.getString(rs21Data,"MAIN_ACCOUNT_CODE","");
                                Amount = UtilFunctions.getString(rs21Data,"AMOUNT","");
                                VoucherNo = UtilFunctions.getString(rs21Data,"VOUCHER_NO","");
                                
                                if (Amount.trim().equals("")) {
                                    A21_Others = A21_Others + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                } else {
                                    A21_Others = A21_Others + Double.parseDouble(UtilFunctions.getString(rs21Data,"AMOUNT",""));
                                }
                                
                                rs21Data.next();
                            }
                            rs21Data.close();
                        }
                        else {
                            A21_Others = 0.0;
                        }
                        //*** code for OGS purchase ag. Form 'C' - 21 (extension no)
                        
                        
                        //code for OGS purchase without Form 'C' - 22 (extension no) ***
                        strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE, "+
                        "(SELECT SUM(AMOUNT) "+
                        "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                        "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                        "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                        "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX, "+
                        "D_FIN_VOUCHER_DETAIL  VOUDTLM  "+
                        "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                        "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                        "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                        "AND VOUHEAD.BOOK_CODE = "+i+" "+  //IN (40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64)
                        "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUHEAD.COMPANY_ID = VOUDTLM.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLM.VOUCHER_NO "+
                        "AND VOUDTLM.MAIN_ACCOUNT_CODE LIKE '%.22' AND VOUDTLM.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUDTLEX.MAIN_ACCOUNT_CODE IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                        "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE "+
                        "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                        ResultSet rs22Data = data.getResult(strQry,FinanceGlobal.FinURL);
                        
                        if (rs22Data.getRow() > 0) {
                            rs22Data.first();
                            A22_403036=0.0;A22_403043=0.0;A22_403050=0.0;A22_405021=0.0;A22_411024=0.0;A22_411127=0.0;A22_421014=0.0;A22_201193=0.0;A22_201344=0.0;
                            while (!rs22Data.isAfterLast()) {
                                MainAccCode= UtilFunctions.getString(rs22Data,"MAIN_ACCOUNT_CODE","");
                                Amount = UtilFunctions.getString(rs22Data,"AMOUNT","");
                                VoucherNo = UtilFunctions.getString(rs22Data,"VOUCHER_NO","");
                                
                                if (MainAccCode.trim().equals("403036")) {
                                    if (Amount.trim().equals("")) {
                                        A22_403036 = A22_403036 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_403036 = A22_403036 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("403043")) {
                                    if (Amount.trim().equals("")) {
                                        A22_403043 = A22_403043 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_403043 = A22_403043 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("403050")) {
                                    if (Amount.trim().equals("")) {
                                        A22_403050 = A22_403050 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_403050 = A22_403050 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("405021")) {
                                    if (Amount.trim().equals("")) {
                                        A22_405021 = A22_405021 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_405021 = A22_405021 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("411024")) {
                                    if (Amount.trim().equals("")) {
                                        A22_411024 = A22_411024 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_411024 = A22_411024 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("411127")) {
                                    if (Amount.trim().equals("")) {
                                        A22_411127 = A22_411127 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_411127 = A22_411127 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("421014")) {
                                    if (Amount.trim().equals("")) {
                                        A22_421014 = A22_421014 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_421014 = A22_421014 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("201193")) {
                                    if (Amount.trim().equals("")) {
                                        A22_201193 = A22_201193 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_201193 = A22_201193 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("201344")) {
                                    if (Amount.trim().equals("")) {
                                        A22_201344 = A22_201344 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        A22_201344 = A22_201344 + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                    }
                                }
                                rs22Data.next();
                            }
                        }
                        else {
                            A22_403036=0.0;A22_403043=0.0;A22_403050=0.0;A22_405021=0.0;A22_411024=0.0;A22_411127=0.0;A22_421014=0.0;A22_201193=0.0;A22_201344=0.0;
                        }
                        rs22Data.close();
                        
                        strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE, "+
                        "(SELECT SUM(AMOUNT) "+
                        "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                        "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                        "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                        "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX, "+
                        "D_FIN_VOUCHER_DETAIL  VOUDTLM  "+
                        "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                        "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                        "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                        "AND VOUHEAD.BOOK_CODE = "+i+" "+  //IN (40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64)
                        "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUHEAD.COMPANY_ID = VOUDTLM.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLM.VOUCHER_NO "+
                        "AND VOUDTLM.MAIN_ACCOUNT_CODE LIKE '%.22' AND VOUDTLM.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUDTLEX.MAIN_ACCOUNT_CODE NOT IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                        "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE "+
                        "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                        
                        rs22Data = data.getResult(strQry,FinanceGlobal.FinURL);
                        
                        if (rs22Data.getRow() > 0) {
                            rs22Data.first();
                            A22_Others = 0.0;
                            while(!rs22Data.isAfterLast()) {
                                MainAccCode= UtilFunctions.getString(rs22Data,"MAIN_ACCOUNT_CODE","");
                                Amount = UtilFunctions.getString(rs22Data,"AMOUNT","");
                                VoucherNo = UtilFunctions.getString(rs22Data,"VOUCHER_NO","");
                                
                                if (Amount.trim().equals("")) {
                                    A22_Others = A22_Others + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                } else {
                                    A22_Others = A22_Others + Double.parseDouble(UtilFunctions.getString(rs22Data,"AMOUNT",""));
                                }
                                
                                rs22Data.next();
                            }
                            rs22Data.close();
                        }
                        else {
                            A22_Others = 0.0;
                        }
                        //*** code for OGS purchase without Form 'C' - 22 (extension no)
                        
                        //code for purchase for registered delear - 01 to 20 (vat%) (extension no) ***
                        strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE, "+
                        "(SELECT SUM(AMOUNT) "+
                        "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                        "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                        "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                        "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX, "+
                        "D_FIN_VOUCHER_DETAIL  VOUDTLM  "+
                        "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                        "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                        "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                        "AND VOUHEAD.BOOK_CODE = "+i+" "+  //IN (40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64)
                        "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUHEAD.COMPANY_ID = VOUDTLM.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLM.VOUCHER_NO "+
                        "AND SUBSTR(VOUDTLM.MAIN_ACCOUNT_CODE,8) < 21  " +
                        "AND VOUDTLM.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUDTLEX.MAIN_ACCOUNT_CODE IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                        "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE "+
                        "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                        ResultSet rsVatData = data.getResult(strQry,FinanceGlobal.FinURL);
                        
                        if (rsVatData.getRow() > 0) {
                            rsVatData.first();
                            AVAT_403036=0.0;AVAT_403043=0.0;AVAT_403050=0.0;AVAT_405021=0.0;AVAT_411024=0.0;AVAT_411127=0.0;AVAT_421014=0.0;AVAT_201193=0.0;AVAT_201344=0.0;
                            while (!rsVatData.isAfterLast()) {
                                MainAccCode= UtilFunctions.getString(rsVatData,"MAIN_ACCOUNT_CODE","");
                                Amount = UtilFunctions.getString(rsVatData,"AMOUNT","");
                                VoucherNo = UtilFunctions.getString(rsVatData,"VOUCHER_NO","");
                                
                                if (MainAccCode.trim().equals("403036")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_403036 = AVAT_403036 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_403036 = AVAT_403036 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("403043")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_403043 = AVAT_403043 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_403043 = AVAT_403043 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("403050")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_403050 = AVAT_403050 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_403050 = AVAT_403050 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("405021")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_405021 = AVAT_405021 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_405021 = AVAT_405021 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("411024")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_411024 = AVAT_411024 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_411024 = AVAT_411024 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("411127")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_411127 = AVAT_411127 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_411127 = AVAT_411127 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("421014")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_421014 = AVAT_421014 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_421014 = AVAT_421014 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("201193")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_201193 = AVAT_201193 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_201193 = AVAT_201193 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                } else if (MainAccCode.trim().equals("201344")) {
                                    if (Amount.trim().equals("")) {
                                        AVAT_201344 = AVAT_201344 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        AVAT_201344 = AVAT_201344 + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                    }
                                }
                                rsVatData.next();
                            }
                        }
                        else {
                            AVAT_403036=0.0;AVAT_403043=0.0;AVAT_403050=0.0;AVAT_405021=0.0;AVAT_411024=0.0;AVAT_411127=0.0;AVAT_421014=0.0;AVAT_201193=0.0;AVAT_201344=0.0;
                        }
                        rsVatData.close();
                        
                        strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE, "+
                        "(SELECT SUM(AMOUNT) "+
                        "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                        "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                        "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                        "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX, "+
                        "D_FIN_VOUCHER_DETAIL  VOUDTLM  "+
                        "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                        "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                        "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                        "AND VOUHEAD.BOOK_CODE = "+i+" "+  //IN (40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64)
                        "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUHEAD.COMPANY_ID = VOUDTLM.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLM.VOUCHER_NO "+
                        "AND SUBSTR(VOUDTLM.MAIN_ACCOUNT_CODE,8) < 21 " +
                        "AND VOUDTLM.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                        "AND VOUDTLEX.MAIN_ACCOUNT_CODE NOT IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                        "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.BOOK_CODE "+
                        "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                        
                        rsVatData = data.getResult(strQry,FinanceGlobal.FinURL);
                        
                        if (rsVatData.getRow() > 0) {
                            rsVatData.first();
                            AVAT_Others = 0.0;
                            while(!rsVatData.isAfterLast()) {
                                MainAccCode= UtilFunctions.getString(rsVatData,"MAIN_ACCOUNT_CODE","");
                                Amount = UtilFunctions.getString(rsVatData,"AMOUNT","");
                                VoucherNo = UtilFunctions.getString(rsVatData,"VOUCHER_NO","");
                                
                                if (Amount.trim().equals("")) {
                                    AVAT_Others = AVAT_Others + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                } else {
                                    AVAT_Others = AVAT_Others + Double.parseDouble(UtilFunctions.getString(rsVatData,"AMOUNT",""));
                                }
                                
                                rsVatData.next();
                            }
                            rsVatData.close();
                        }
                        else {
                            AVAT_Others = 0.0;
                        }
                        //*** code for purchase for registered delear - 01 to 20 (vat%) (extension no)
                        
                        //code for import purchase TR 44 Total Summary ***
                        if (i==44) {
                            strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE, " +
                            "(SELECT SUM(AMOUNT) "+
                            "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                            "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                            "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                            "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX "+
                            "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                            "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                            "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                            "AND VOUHEAD.BOOK_CODE = 44 "+
                            "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                            "AND VOUDTLEX.MAIN_ACCOUNT_CODE IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                            "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE "+
                            "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                            
                            ResultSet rs44Data = data.getResult(strQry,FinanceGlobal.FinURL);
                            
                            if (rs44Data.getRow() > 0) {
                                rs44Data.first();
                                ATR44_403036=0.0;ATR44_403043=0.0;ATR44_403050=0.0;ATR44_405021=0.0;ATR44_411024=0.0;ATR44_411127=0.0;ATR44_421014=0.0;ATR44_201193=0.0;ATR44_201344=0.0;
                                
                                while(!rs44Data.isAfterLast()) {
                                    MainAccCode= UtilFunctions.getString(rs44Data,"MAIN_ACCOUNT_CODE","");
                                    Amount = UtilFunctions.getString(rs44Data,"AMOUNT","");
                                    VoucherNo = UtilFunctions.getString(rs44Data,"VOUCHER_NO","");
                                    
                                    if (MainAccCode.trim().equals("403036")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_403036 = ATR44_403036 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_403036 = ATR44_403036 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("403043")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_403043 = ATR44_403043 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_403043 = ATR44_403043 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("403050")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_403050 = ATR44_403050 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_403050 = ATR44_403050 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("405021")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_405021 = ATR44_405021 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_405021 = ATR44_405021 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("411024")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_411024 = ATR44_411024 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_411024 = ATR44_411024 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("411127")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_411127 = ATR44_411127 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_411127 = ATR44_411127 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("421014")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_421014 = ATR44_421014 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_421014 = ATR44_421014 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("201193")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_201193 = ATR44_201193 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_201193 = ATR44_201193 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    } else if (MainAccCode.trim().equals("201344")) {
                                        if (Amount.trim().equals("")) {
                                            ATR44_201344 = ATR44_201344 + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                        } else {
                                            ATR44_201344 = ATR44_201344 + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                        }
                                    }
                                    rs44Data.next();
                                }
                            }
                            else {
                                ATR44_403036=0.0;ATR44_403043=0.0;ATR44_403050=0.0;ATR44_405021=0.0;ATR44_411024=0.0;ATR44_411127=0.0;ATR44_421014=0.0;ATR44_201193=0.0;ATR44_201344=0.0;
                            }
                            rs44Data.close();
                            
                            strQry = "SELECT DISTINCT VOUHEAD.VOUCHER_NO, VOUDTLEX.MAIN_ACCOUNT_CODE, " +
                            "(SELECT SUM(AMOUNT) "+
                            "FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO=VOUHEAD.VOUCHER_NO "+
                            "AND SUB_ACCOUNT_CODE <> '' AND EFFECT='C' "+
                            "GROUP BY VOUCHER_NO,SUB_ACCOUNT_CODE) AS AMOUNT "+
                            "FROM D_FIN_VOUCHER_HEADER VOUHEAD, D_FIN_VOUCHER_DETAIL_EX  VOUDTLEX "+
                            "WHERE VOUHEAD.VOUCHER_DATE >= '"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) +"' "+
                            "AND VOUHEAD.VOUCHER_DATE <= '"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) +"' "+
                            "AND VOUHEAD.APPROVED=1 AND VOUHEAD.CANCELLED=0  AND VOUHEAD.VOUCHER_TYPE = 1 "+
                            "AND VOUHEAD.BOOK_CODE = 44 "+
                            "AND VOUHEAD.COMPANY_ID=VOUDTLEX.COMPANY_ID AND VOUHEAD.VOUCHER_NO=VOUDTLEX.VOUCHER_NO "+
                            "AND VOUDTLEX.MAIN_ACCOUNT_CODE NOT IN ('403036','403043','403050','405021','411024','411127','421014','201193','201344') "+
                            "GROUP BY VOUHEAD.VOUCHER_NO,VOUDTLEX.MAIN_ACCOUNT_CODE "+
                            "ORDER BY VOUDTLEX.MAIN_ACCOUNT_CODE,VOUHEAD.VOUCHER_NO";
                            
                            rs44Data = data.getResult(strQry,FinanceGlobal.FinURL);
                            
                            if (rs44Data.getRow() > 0) {
                                rs44Data.first();
                                ATR44_Others = 0.0;
                                while(!rs44Data.isAfterLast()) {
                                    MainAccCode= UtilFunctions.getString(rs44Data,"MAIN_ACCOUNT_CODE","");
                                    Amount = UtilFunctions.getString(rs44Data,"AMOUNT","");
                                    VoucherNo = UtilFunctions.getString(rs44Data,"VOUCHER_NO","");
                                    
                                    if (Amount.trim().equals("")) {
                                        ATR44_Others = ATR44_Others + data.getDoubleValueFromDB("select SUM(AMOUNT) FROM D_FIN_VOUCHER_DETAIL_EX WHERE VOUCHER_NO='"+ VoucherNo +"' AND EFFECT = 'D'");
                                    } else {
                                        ATR44_Others = ATR44_Others + Double.parseDouble(UtilFunctions.getString(rs44Data,"AMOUNT",""));
                                    }
                                    
                                    rs44Data.next();
                                }
                                rs44Data.close();
                            }
                            else {
                                ATR44_Others = 0.0;
                            }
                            //*** code for import purchase TR 44 Total Summary
                        }
                        else {
                            ATR44_403036=0.0;ATR44_403043=0.0;ATR44_403050=0.0;ATR44_405021=0.0;ATR44_411024=0.0;ATR44_411127=0.0;ATR44_421014=0.0;ATR44_201193=0.0;ATR44_201344=0.0;ATR44_Others = 0.0;
                        }
                        Counter ++;
                        TOTAL = A21_403036 + A22_403036 + AVAT_403036 + ATR44_403036;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","403036");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_403036,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_403036,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_403036,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_403036,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_403043 + A22_403043 + AVAT_403043 + ATR44_403043;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","403043");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_403043,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_403043,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_403043,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_403043,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_403050 + A22_403050 + AVAT_403050 + ATR44_403050;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","403050");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_403050,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_403050,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_403050,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_403050,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_405021 + A22_405021 + AVAT_405021 + ATR44_405021;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","405021");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_405021,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_405021,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_405021,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_405021,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_411024 + A22_411024 + AVAT_411024 + ATR44_411024;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","411024");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_411024,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_411024,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_411024,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_411024,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_411127 + A22_411127 + AVAT_411127 + ATR44_411127;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","411127");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_411127,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_411127,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_411127,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_411127,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_421014 + A22_421014 + AVAT_421014 + ATR44_421014;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","421014");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_421014,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_421014,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_421014,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_421014,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_201193 + A22_201193 + AVAT_201193 + ATR44_201193;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","201193");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_201193,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_201193,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_201193,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_201193,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_201344 + A22_201344 + AVAT_201344 + ATR44_201344;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","421014");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_201344,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_201344,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_201344,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_201344,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                        
                        Counter ++;
                        TOTAL = A21_Others + A22_Others + AVAT_Others + ATR44_Others;
                        //System.out.println("Counter = " + Counter);
                        objRow=objReportData.newRow();
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
                        objRow.setValue("BOOK_CODE",Integer.toString(i));
                        objRow.setValue("MAIN_ACCOUNT_CODE","");
                        objRow.setValue("CFORM21", Double.toString(EITLERPGLOBAL.round(A21_Others,2)));
                        objRow.setValue("CFORM22",Double.toString(EITLERPGLOBAL.round(A22_Others,2)));
                        objRow.setValue("PUR_VATPER",Double.toString(EITLERPGLOBAL.round(AVAT_Others,2)));
                        objRow.setValue("PUR_TR44",Double.toString(EITLERPGLOBAL.round(ATR44_Others,2)));
                        objRow.setValue("TOTAL",Double.toString(EITLERPGLOBAL.round(TOTAL,2)));
                        objReportData.AddRow(objRow);
                    }
                    objProgress.Hide();
                    
                    int Comp_ID = EITLERPGLOBAL.gCompanyID;
                    HashMap Parameters=new HashMap();
                    Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
                    Parameters.put("FROM_DATE",txtFromDate.getText().trim());
                    Parameters.put("TO_DATE",txtToDate.getText().trim());
                    Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
                    
                    objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptTRBookwise_PurchaseSummary.rpt",Parameters,objReportData);
                    
                }
                catch(Exception e) {
                    e.printStackTrace();
                }                
            };
        }.start();
    }
    
    private boolean Validate() {
        //Form level validations
        
        if(txtFromDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter from date");
            return false;
        } else if(!EITLERPGLOBAL.isDate(txtFromDate.getText())) {
            JOptionPane.showMessageDialog(null,"Invalid From Date in DD/MM/YYYY format.");
            return false;
        }
        
        if(txtToDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter To date");
            return false;
        } else if(!EITLERPGLOBAL.isDate(txtToDate.getText())) {
            JOptionPane.showMessageDialog(null,"Invalid To Date in DD/MM/YYYY format.");
            return false;
        }
        
        return true;
    }
}
