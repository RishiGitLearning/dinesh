/*
 * frmpartyinfo.java
 *
 * Created on November 28, 2007, 12:12 PM
 */

package EITLERP.Finance.ReportsUI;

import javax.swing.*;
import EITLERP.* ;
import java.sql.*;
import EITLERP.Finance.*;

/**
 *
 * @author  root
 */
public class frmRptDrillDown extends javax.swing.JApplet {
    
    /** Initializes the applet frmpartyinfo */
    
    clsAccount ObjAccount = new clsAccount();
    clsPartyInfo ObjParty ;
    EITLTableModel TableModelY,TableModelM,TableModelD,TableModelV ;
    static String acname ;
    Object[][] ObjDate;
    
    
    public void init() {
        setSize(781,520);
        initComponents();
        FormatYearGrid();
        FormatMonthGrid();
        FormatDateGrid();
        FormatVoucherGrid();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        partytab = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        maincodetxt = new javax.swing.JTextField();
        subcodetxt = new javax.swing.JTextField();
        cmdnextparty = new javax.swing.JButton();
        lblAccountName = new javax.swing.JLabel();
        chkApproved = new javax.swing.JCheckBox();
        jPanel6 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        lblAccountName4 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        TableY = new javax.swing.JTable();
        cmdYearback = new javax.swing.JButton();
        cmdyearnext = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        TableM = new javax.swing.JTable();
        cmdmonthback = new javax.swing.JButton();
        cmdmonthnext = new javax.swing.JButton();
        lblAccountName1 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        TableD = new javax.swing.JTable();
        cmddateback = new javax.swing.JButton();
        cmddatenext = new javax.swing.JButton();
        lblAccountName2 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        TableV = new javax.swing.JTable();
        cmdvoucherback = new javax.swing.JButton();
        cmdShowVoucher = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        lblAccountName3 = new javax.swing.JLabel();
        jPanel5 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jPanel1.setLayout(null);

        jPanel1.setBorder(new javax.swing.border.EtchedBorder());
        jLabel1.setText("Main Code :");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(30, 30, 80, 20);

        jLabel2.setText("Sub Code :");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(39, 56, 66, 20);

        maincodetxt.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                maincodetxtFocusLost(evt);
            }
        });
        maincodetxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                maincodetxtKeyPressed(evt);
            }
        });

        jPanel1.add(maincodetxt);
        maincodetxt.setBounds(120, 30, 100, 19);

        subcodetxt.setColumns(15);
        subcodetxt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                subcodetxtActionPerformed(evt);
            }
        });
        subcodetxt.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                subcodetxtFocusLost(evt);
            }
        });
        subcodetxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                subcodetxtKeyPressed(evt);
            }
        });

        jPanel1.add(subcodetxt);
        subcodetxt.setBounds(121, 56, 100, 20);

        cmdnextparty.setText("Show");
        cmdnextparty.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdnextpartyActionPerformed(evt);
            }
        });

        jPanel1.add(cmdnextparty);
        cmdnextparty.setBounds(120, 121, 88, 25);

        lblAccountName.setText("-");
        jPanel1.add(lblAccountName);
        lblAccountName.setBounds(124, 87, 360, 15);

        chkApproved.setSelected(true);
        chkApproved.setText("Only Approved Vouchers");
        jPanel1.add(chkApproved);
        chkApproved.setBounds(268, 32, 180, 23);

        partytab.addTab("Party Info", jPanel1);

        jPanel6.setLayout(null);

        jLabel8.setText("A/C Name :");
        jPanel6.add(jLabel8);
        jLabel8.setBounds(10, 9, 80, 15);

        lblAccountName4.setForeground(new java.awt.Color(51, 51, 255));
        jPanel6.add(lblAccountName4);
        lblAccountName4.setBounds(90, 9, 650, 15);

        TableY.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane4.setViewportView(TableY);

        jPanel6.add(jScrollPane4);
        jScrollPane4.setBounds(8, 29, 740, 350);

        cmdYearback.setText("Back");
        cmdYearback.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdYearbackActionPerformed(evt);
            }
        });

        jPanel6.add(cmdYearback);
        cmdYearback.setBounds(570, 383, 88, 25);

        cmdyearnext.setText("Next");
        cmdyearnext.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdyearnextActionPerformed(evt);
            }
        });

        jPanel6.add(cmdyearnext);
        cmdyearnext.setBounds(660, 383, 88, 25);

        partytab.addTab("Yearly Info", jPanel6);

        jPanel2.setLayout(null);

        jPanel2.setBorder(new javax.swing.border.EtchedBorder());
        TableM.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(TableM);

        jPanel2.add(jScrollPane1);
        jScrollPane1.setBounds(8, 29, 740, 350);

        cmdmonthback.setText("Back");
        cmdmonthback.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdmonthbackActionPerformed(evt);
            }
        });

        jPanel2.add(cmdmonthback);
        cmdmonthback.setBounds(570, 383, 88, 25);

        cmdmonthnext.setText("Next");
        cmdmonthnext.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdmonthnextActionPerformed(evt);
            }
        });

        jPanel2.add(cmdmonthnext);
        cmdmonthnext.setBounds(660, 383, 88, 25);

        lblAccountName1.setForeground(new java.awt.Color(51, 51, 255));
        jPanel2.add(lblAccountName1);
        lblAccountName1.setBounds(90, 9, 650, 15);

        jLabel6.setText("A/C Name :");
        jPanel2.add(jLabel6);
        jLabel6.setBounds(10, 9, 80, 15);

        partytab.addTab("Monthly Info", jPanel2);

        jPanel3.setLayout(null);

        jPanel3.setBorder(new javax.swing.border.EtchedBorder());
        TableD.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane2.setViewportView(TableD);

        jPanel3.add(jScrollPane2);
        jScrollPane2.setBounds(6, 25, 740, 360);

        cmddateback.setText("Back");
        cmddateback.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmddatebackActionPerformed(evt);
            }
        });

        jPanel3.add(cmddateback);
        cmddateback.setBounds(565, 392, 88, 25);

        cmddatenext.setText("Next");
        cmddatenext.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmddatenextActionPerformed(evt);
            }
        });

        jPanel3.add(cmddatenext);
        cmddatenext.setBounds(658, 392, 88, 25);

        lblAccountName2.setForeground(new java.awt.Color(0, 153, 255));
        jPanel3.add(lblAccountName2);
        lblAccountName2.setBounds(85, 7, 660, 15);

        jLabel7.setText("A/C Name :");
        jPanel3.add(jLabel7);
        jLabel7.setBounds(5, 7, 80, 15);

        partytab.addTab("Datewise Info", jPanel3);

        jPanel4.setLayout(null);

        jPanel4.setBorder(new javax.swing.border.EtchedBorder());
        TableV.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane3.setViewportView(TableV);

        jPanel4.add(jScrollPane3);
        jScrollPane3.setBounds(7, 28, 740, 350);

        cmdvoucherback.setText("Back");
        cmdvoucherback.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdvoucherbackActionPerformed(evt);
            }
        });

        jPanel4.add(cmdvoucherback);
        cmdvoucherback.setBounds(659, 382, 88, 25);

        cmdShowVoucher.setText("Show Voucher");
        cmdShowVoucher.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdShowVoucherActionPerformed(evt);
            }
        });

        jPanel4.add(cmdShowVoucher);
        cmdShowVoucher.setBounds(523, 383, 130, 25);

        jLabel3.setText("A/C Name :");
        jPanel4.add(jLabel3);
        jLabel3.setBounds(7, 7, 80, 15);

        lblAccountName3.setForeground(new java.awt.Color(0, 153, 255));
        jPanel4.add(lblAccountName3);
        lblAccountName3.setBounds(87, 7, 650, 15);

        partytab.addTab("Voucher Detail", jPanel4);

        getContentPane().add(partytab);
        partytab.setBounds(1, 29, 760, 450);

        jPanel5.setLayout(null);

        jPanel5.setBackground(new java.awt.Color(0, 153, 204));
        jPanel5.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel4.setText("ACCOUNTS DRILL DOWN INFORMATION");
        jPanel5.add(jLabel4);
        jLabel4.setBounds(9, 8, 280, 15);

        getContentPane().add(jPanel5);
        jPanel5.setBounds(-1, -1, 800, 30);

    }//GEN-END:initComponents
    
    private void cmdYearbackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdYearbackActionPerformed
        // TODO add your handling code here:
        partytab.setSelectedIndex(0);
    }//GEN-LAST:event_cmdYearbackActionPerformed
    
    private void cmdyearnextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdyearnextActionPerformed
        // TODO add your handling code here:
        if(maincodetxt.getText().trim().equals("") && subcodetxt.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please Enter Main Code or SubCode");
        }
        else {
            GenerateMonthGrid((new clsPartyInfo()).getMonthDetail(maincodetxt.getText().trim(),subcodetxt.getText().trim(),chkApproved.isSelected()));
            partytab.setSelectedIndex(2);
        }
    }//GEN-LAST:event_cmdyearnextActionPerformed
    
    private void subcodetxtFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_subcodetxtFocusLost
        // TODO add your handling code here:
        lblAccountName.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName1.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName2.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName3.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName4.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
    }//GEN-LAST:event_subcodetxtFocusLost
    
    private void maincodetxtFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_maincodetxtFocusLost
        // TODO add your handling code here:
        lblAccountName.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName1.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName2.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName3.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
        lblAccountName4.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),subcodetxt.getText()));
    }//GEN-LAST:event_maincodetxtFocusLost
    
    private void subcodetxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_subcodetxtKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==112) {
            
            LOV aList=new LOV();
            
            aList.SQL="SELECT PARTY_CODE,PARTY_NAME FROM D_FIN_PARTY_MASTER WHERE APPROVED=1 ORDER BY PARTY_NAME";
            aList.ReturnCol=1;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=2;
            aList.UseSpecifiedConn=true;
            aList.dbURL=FinanceGlobal.FinURL;
            
            if(aList.ShowLOV()) {
                subcodetxt.setText(aList.ReturnVal);
                lblAccountName.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),aList.ReturnVal));
                lblAccountName1.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),aList.ReturnVal));
                lblAccountName2.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),aList.ReturnVal));
                lblAccountName3.setText(clsPartyMaster.getAccountName(maincodetxt.getText(),aList.ReturnVal));
            }
            
        }
        
    }//GEN-LAST:event_subcodetxtKeyPressed
    
    private void maincodetxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_maincodetxtKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==112) {
            LOV aList=new LOV();
            
            aList.SQL="SELECT MAIN_ACCOUNT_CODE,ACCOUNT_NAME FROM D_FIN_GL WHERE  APPROVED=1 ORDER BY ACCOUNT_NAME";
            aList.ReturnCol=1;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=2;
            aList.UseSpecifiedConn=true;
            aList.dbURL=FinanceGlobal.FinURL;
            
            if(aList.ShowLOV()) {
                maincodetxt.setText(aList.ReturnVal);
            }
            
        }
        
    }//GEN-LAST:event_maincodetxtKeyPressed
    
    private void cmdShowVoucherActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdShowVoucherActionPerformed
        // TODO add your handling code here:
        AppletFrame aFrame=new AppletFrame("Voucher Information");
        aFrame.startAppletEx("EITLERP.Finance.frmVoucher","Voucher Information");
        frmVoucher ObjDoc=(frmVoucher) aFrame.ObjApplet;
        ObjDoc.FindEx((int)EITLERPGLOBAL.gCompanyID,(String)TableV.getValueAt(TableV.getSelectedRow(),0));
    }//GEN-LAST:event_cmdShowVoucherActionPerformed
    
    private void cmdvoucherbackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdvoucherbackActionPerformed
        partytab.setSelectedIndex(3);
    }//GEN-LAST:event_cmdvoucherbackActionPerformed
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        
    }//GEN-LAST:event_formMouseClicked
    
    private void cmddatenextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmddatenextActionPerformed
        
        int noOfVoucherRow = isVoucherNoExist(maincodetxt.getText().trim(),subcodetxt.getText().trim(),EITLERPGLOBAL.formatDateDB((String)TableD.getValueAt(TableD.getSelectedRow(),0)),chkApproved.isSelected());
        FormatVoucherGrid();
        if(noOfVoucherRow> 0) {
            try {
                clsPartyInfo ObjPartyInfo = new clsPartyInfo();
                String VoucherDate =EITLERPGLOBAL.formatDateDB((String)TableD.getValueAt(TableD.getSelectedRow(),0));
                GenerateVoucherGrid((new clsPartyInfo()).getVoucherInfo(maincodetxt.getText().trim(),subcodetxt.getText().trim(),VoucherDate,chkApproved.isSelected()),noOfVoucherRow,acname);
            }
            catch(Exception e) {
                e.printStackTrace();
            }
        }
        partytab.setSelectedIndex(4);
    }//GEN-LAST:event_cmddatenextActionPerformed
    
    private void cmddatebackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmddatebackActionPerformed
        TableD.removeAll();
        partytab.setSelectedIndex(2);
    }//GEN-LAST:event_cmddatebackActionPerformed
    
    private void cmdmonthnextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdmonthnextActionPerformed
        int noOfDateRow = isVoucherDateExist(maincodetxt.getText().trim(),subcodetxt.getText().trim(),getFromDate(TableM.getSelectedRow()),chkApproved.isSelected());
        FormatDateGrid();
        if(noOfDateRow> 0) {
            try {
                GenerateDateGrid((new clsPartyInfo()).getDateDetail(maincodetxt.getText().trim(),subcodetxt.getText().trim(),getFromDate(TableM.getSelectedRow()),chkApproved.isSelected()),noOfDateRow);
            }
            catch(Exception e) {
                e.printStackTrace();
            }
        }
        partytab.setSelectedIndex(3);
        
    }//GEN-LAST:event_cmdmonthnextActionPerformed
    
    private void cmdmonthbackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdmonthbackActionPerformed
        TableM.removeAll();
        partytab.setSelectedIndex(1);
    }//GEN-LAST:event_cmdmonthbackActionPerformed
    
    private void cmdnextpartyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdnextpartyActionPerformed
        if(maincodetxt.getText().trim().equals("") && subcodetxt.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please Enter Main Code or SubCode");
        }
        else {
            FormatYearGrid();
            GenerateYearGrid((new clsPartyInfo()).getYearDetail(maincodetxt.getText().trim(),subcodetxt.getText().trim(),chkApproved.isSelected()));
            partytab.setSelectedIndex(1);
        }
    }//GEN-LAST:event_cmdnextpartyActionPerformed
    
    public void GenerateMonthGrid(Object[][] ObjMonth){
        TableM.removeAll();
        if(!(TableM.getRowCount()==12)) {
            Monthadd();
        }
        for(int i=0;i<=11;i++) {
            TableModelM.setValueByVariable("Opening Amount",(String)ObjMonth[i][0],i);
            TableModelM.setValueByVariable("Credit",(String)ObjMonth[i][1],i);
            TableModelM.setValueByVariable("Debit",(String)ObjMonth[i][2],i);
            TableModelM.setValueByVariable("Closing Amount",(String)ObjMonth[i][3],i);
        }
    }
    
    public void GenerateYearGrid(Object[][] ObjYear){
        TableY.removeAll();
        Yearadd();
        
        TableModelY.setValueByVariable("Opening Amount",(String)ObjYear[0][0],0);
        TableModelY.setValueByVariable("Credit",(String)ObjYear[0][1],0);
        TableModelY.setValueByVariable("Debit",(String)ObjYear[0][2],0);
        TableModelY.setValueByVariable("Closing Amount",(String)ObjYear[0][3],0);
        
    }
    
    public void GenerateVoucherGrid(Object ObjVoucher[][],int row2,String AcName) {
        Object[] AcName1 =new Object[1];
        AcName1[0]=lblAccountName3.getText();
        Object[] rowdata2 = new Object[row2];
        for(int i=0;i<row2;i++) {
            TableModelV.addRow(rowdata2);
            TableV.setValueAt(ObjVoucher[i][0],i,0);
            TableV.setValueAt(ObjVoucher[i][1],i,1);
            TableV.setValueAt(AcName1[0],i,2);
            TableV.setValueAt(ObjVoucher[i][2],i,3);
            TableV.setValueAt(ObjVoucher[i][3],i,4);
            TableV.setValueAt(ObjVoucher[i][4],i,5);
        }
    }
    
    public void GenerateDateGrid(Object ObjDate[][],int row) {
        Object[] rowdata = new Object[row];
        for(int i=0;i<row;i++) {
            TableModelD.addRow(rowdata);
            TableD.setValueAt(ObjDate[i][0],i,0);
            TableD.setValueAt(ObjDate[i][1],i,1);
            TableD.setValueAt(ObjDate[i][2],i,2);
            TableD.setValueAt(ObjDate[i][3],i,3);
            TableD.setValueAt(ObjDate[i][4],i,4);
        }
    }
    private void subcodetxtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_subcodetxtActionPerformed
        
    }//GEN-LAST:event_subcodetxtActionPerformed
    
    public String getFromDate(int selMonth) {
        int month,year,remainMonth;
        String Date;
        month =Integer.parseInt(EITLERPGLOBAL.FinFromDateDB.substring(5,7));
        year=Integer.parseInt(EITLERPGLOBAL.FinFromDateDB.substring(0,4));
        if(selMonth>=9) {
            year++;
            remainMonth=selMonth%9+1;
            month=remainMonth;
            return Integer.toString(year)+"-"+"0"+Integer.toString(month)+"-"+"01";
            
        }
        else {
            month=month+selMonth;
            if(month>=10){
                return Integer.toString(year)+"-"+Integer.toString(month)+"-"+"01";
            }
            else{
                return Integer.toString(year)+"-"+"0"+Integer.toString(month)+"-"+"01";
            }
        }
    }
    
    public void FormatYearGrid() {
        TableY.removeAll();
        TableModelY = new EITLTableModel();
        TableY.setModel(TableModelY);
        TableModelY.addColumn("Year");
        TableModelY.addColumn("Opening Amount");
        TableModelY.addColumn("Debit");
        TableModelY.addColumn("Credit");
        TableModelY.addColumn("Closing Amount");
        TableModelY.SetVariable(0, "Year");
        TableModelY.SetVariable(1, "Opening Amount");
        TableModelY.SetVariable(2, "Debit");
        TableModelY.SetVariable(3, "Credit");
        TableModelY.SetVariable(4, "Closing Amount");
    }
    
    
    public void FormatMonthGrid() {
        TableM.removeAll();
        TableModelM = new EITLTableModel();
        TableM.setModel(TableModelM);
        TableModelM.addColumn("Month");
        TableModelM.addColumn("Opening Amount");
        TableModelM.addColumn("Debit");
        TableModelM.addColumn("Credit");
        TableModelM.addColumn("Closing Amount");
        TableModelM.SetVariable(0, "Month");
        TableModelM.SetVariable(1, "Opening Amount");
        TableModelM.SetVariable(2, "Debit");
        TableModelM.SetVariable(3, "Credit");
        TableModelM.SetVariable(4, "Closing Amount");
    }
    
    public void FormatDateGrid() {
        TableD.removeAll();
        TableModelD = new EITLTableModel();
        TableD.setModel(TableModelD);
        TableModelD.addColumn("Date");
        TableModelD.addColumn("Opening Amount");
        TableModelD.addColumn("Debit");
        TableModelD.addColumn("Credit");
        TableModelD.addColumn("Closing Amount");
    }
    
    public void FormatVoucherGrid() {
        TableV.removeAll();
        TableModelV = new EITLTableModel();
        TableV.setModel(TableModelV);
        TableModelV.addColumn("Voucher No.");
        TableModelV.addColumn("Date");
        TableModelV.addColumn("A/c Name");
        TableModelV.addColumn("Debit");
        TableModelV.addColumn("Credit");
        TableModelV.addColumn("TR/Bank Code");
        
    }
    
    public void Yearadd() {
        try {
            int Newrow ;
            Object[] rowdata = new Object[5];
            TableModelY.addRow(rowdata);
            Newrow = TableY.getRowCount()-1;
            TableModelY.setValueByVariable("Year",EITLERPGLOBAL.FinYearFrom+"-"+EITLERPGLOBAL.FinYearTo,Newrow);
        }
        catch (Exception e) {
            e.printStackTrace();
        }
    }
    
    public void Monthadd() {
        int Newrow ;
        String months[]={"April","May","June","July","August","Septmber","October","November","December","January","February","March"};
        Object[] rowdata = new Object[12];
        for(int i=0;i<12;i++) {
            TableModelM.addRow(rowdata);
            Newrow = TableM.getRowCount()-1;
            TableModelM.setValueByVariable("Month",months[i],Newrow);
        }
    }
    
    public int isVoucherDateExist(String MainAccountCode,String SubAccountCode,String OpeningDate,boolean bApproved) {
        int jh=0;
        try {
            ResultSet rs;
            String strSQL;
            String ToDate = EITLERPGLOBAL.addMonthToDate(OpeningDate);
            strSQL="SELECT DISTINCT(A.VOUCHER_DATE) FROM D_FIN_VOUCHER_HEADER A,D_FIN_VOUCHER_DETAIL_EX B WHERE  A.VOUCHER_DATE>='"+OpeningDate+"' AND A.APPROVED="+bApproved+" AND A.CANCELLED=0 AND A.VOUCHER_DATE<='"+ToDate+"' AND A.VOUCHER_NO =B.VOUCHER_NO "+getStrQuery(MainAccountCode,SubAccountCode);
            rs = data.getResult(strSQL,FinanceGlobal.FinURL);
            rs.first();
            if(rs.getRow()>0) {
                rs.last();
                jh = rs.getRow();
            }
            else {
                jh =0;
            }
        }
        catch(Exception e){
        }
        return jh;
    }
    
    
    public String getStrQuery(String MainAccountCode,String SubAccountCode) {
        
        String strQuery;
        if(!SubAccountCode.trim().equals("")) {
            strQuery=" AND SUB_ACCOUNT_CODE ="+SubAccountCode;
            if(!MainAccountCode.trim().equals("")) {
                strQuery=strQuery+" AND MAIN_ACCOUNT_CODE ="+MainAccountCode;
            }
        }
        else {
            strQuery = " AND MAIN_ACCOUNT_CODE ="+MainAccountCode ;
        }
        
        return strQuery;
    }
    
    
    public int isVoucherNoExist(String MainAccountCode,String SubAccountCode,String OpeningDate,boolean bApproved) {
        int brd=0;
        try {
            ResultSet rs;
            String strSQL;
            strSQL="SELECT DISTINCT(A.VOUCHER_NO) FROM D_FIN_VOUCHER_HEADER A,D_FIN_VOUCHER_DETAIL_EX B WHERE  A.VOUCHER_DATE='"+OpeningDate+"' AND A.APPROVED="+bApproved+" AND A.CANCELLED=0 AND A.VOUCHER_NO =B.VOUCHER_NO "+getStrQuery(MainAccountCode,SubAccountCode);
            rs = data.getResult(strSQL,FinanceGlobal.FinURL);
            rs.first();
            if(rs.getRow()>0){
                rs.last();
                brd = rs.getRow();
            }
            else {
                brd =0;
            }
        }
        catch(Exception e){
        }
        return brd;
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable TableD;
    private javax.swing.JTable TableM;
    private javax.swing.JTable TableV;
    private javax.swing.JTable TableY;
    private javax.swing.JCheckBox chkApproved;
    private javax.swing.JButton cmdShowVoucher;
    private javax.swing.JButton cmdYearback;
    private javax.swing.JButton cmddateback;
    private javax.swing.JButton cmddatenext;
    private javax.swing.JButton cmdmonthback;
    private javax.swing.JButton cmdmonthnext;
    private javax.swing.JButton cmdnextparty;
    private javax.swing.JButton cmdvoucherback;
    private javax.swing.JButton cmdyearnext;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JLabel lblAccountName;
    private javax.swing.JLabel lblAccountName1;
    private javax.swing.JLabel lblAccountName2;
    private javax.swing.JLabel lblAccountName3;
    private javax.swing.JLabel lblAccountName4;
    private javax.swing.JTextField maincodetxt;
    private javax.swing.JTabbedPane partytab;
    private javax.swing.JTextField subcodetxt;
    // End of variables declaration//GEN-END:variables
    
}
