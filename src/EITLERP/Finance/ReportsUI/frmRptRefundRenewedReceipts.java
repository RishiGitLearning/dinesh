

package EITLERP.Finance.ReportsUI;


import EITLERP.*;
import EITLERP.Finance.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.net.*;
import java.util.*;
import TReportWriter.*;

public class frmRptRefundRenewedReceipts extends javax.swing.JApplet {
    
    private EITLComboModel cmbReceiptTypeModel;
    private EITLComboModel cmbReportTypeModel;
    private EITLComboModel cmbMonthModel;
    private TReportEngine objEngine=new TReportEngine();
    private TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
    
    
    /** Initializes the applet frmRptGRNInfo */
    public void init() {
        setSize(424,264);
        initComponents();
        
        GenerateCombo();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel3 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        txtYear = new javax.swing.JTextField();
        cmdPreview = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        cmbReportType = new javax.swing.JComboBox();
        cmbMonth = new javax.swing.JComboBox();
        cmdPreviewSummary = new javax.swing.JButton();
        cmbReceiptType = new javax.swing.JComboBox();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jPanel3.setLayout(null);

        jPanel3.setBackground(new java.awt.Color(0, 153, 204));
        jPanel3.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel6.setText("REFUND OR RENEWED RECEIPT REPORT");
        jPanel3.add(jLabel6);
        jLabel6.setBounds(9, 8, 350, 14);

        getContentPane().add(jPanel3);
        jPanel3.setBounds(0, 2, 800, 30);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("Month :");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(20, 70, 90, 20);

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("Year :");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(220, 70, 60, 20);

        txtYear.setColumns(10);
        getContentPane().add(txtYear);
        txtYear.setBounds(285, 70, 90, 20);

        cmdPreview.setText("Preview Report");
        cmdPreview.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPreviewActionPerformed(evt);
            }
        });

        getContentPane().add(cmdPreview);
        cmdPreview.setBounds(70, 180, 130, 23);

        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel4.setText("Report Type :");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(20, 130, 90, 14);

        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel5.setText("Receipt Type :");
        getContentPane().add(jLabel5);
        jLabel5.setBounds(20, 100, 90, 14);

        getContentPane().add(cmbReportType);
        cmbReportType.setBounds(120, 130, 90, 22);

        getContentPane().add(cmbMonth);
        cmbMonth.setBounds(120, 70, 90, 22);

        cmdPreviewSummary.setText("Preview Summary");
        cmdPreviewSummary.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPreviewSummaryActionPerformed(evt);
            }
        });

        getContentPane().add(cmdPreviewSummary);
        cmdPreviewSummary.setBounds(230, 180, 160, 23);

        getContentPane().add(cmbReceiptType);
        cmbReceiptType.setBounds(120, 100, 90, 22);

    }//GEN-END:initComponents
    
    private void cmdPreviewSummaryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPreviewSummaryActionPerformed
        // TODO add your handling code here:
        if ( ! Validate()) {
            return;
        }
        GenerateSummary();
    }//GEN-LAST:event_cmdPreviewSummaryActionPerformed
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdPreviewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPreviewActionPerformed
        // TODO add your handling code here:
        if ( ! Validate()) {
            return;
        }
        GenerateReport();
    }//GEN-LAST:event_cmdPreviewActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox cmbMonth;
    private javax.swing.JComboBox cmbReceiptType;
    private javax.swing.JComboBox cmbReportType;
    private javax.swing.JButton cmdPreview;
    private javax.swing.JButton cmdPreviewSummary;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JTextField txtYear;
    // End of variables declaration//GEN-END:variables
    
    private void GenerateReport() {
        try {
            
            
            int ReceiptType = cmbReceiptType.getSelectedIndex() + 1;
            int ReportType = cmbReportType.getSelectedIndex() + 1;
            int nMonth = cmbMonth.getSelectedIndex() + 1;
            int DepositTypeID = 1;
            if(ReceiptType == 3) {
                DepositTypeID=2;
            }
            String strSQL = "";
            //--------------------REFUND 
            if (ReportType == 1) {
                TReportWriter.SimpleDataProvider.TRow objRow;
                TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
                
                objReportData.AddColumn("SR_NO");
                objReportData.AddColumn("RECEIPT_NO");
                objReportData.AddColumn("LEGACY_NO");
                objReportData.AddColumn("CHEQUE_DATE");
                objReportData.AddColumn("APPLICANT_NAME");
                objReportData.AddColumn("AMOUNT");
                objReportData.AddColumn("DEPOSIT_PERIOD");
                objReportData.AddColumn("INTEREST_RATE");
                objReportData.AddColumn("RECEIPT_DATE");
                objReportData.AddColumn("MATURITY_DATE");
                objReportData.AddColumn("CHEQUE_NO");
                objReportData.AddColumn("DEPOSITER_STATUS");
                objReportData.AddColumn("BROKER_CODE");
                
                TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
                objOpeningRow.setValue("SR_NO","");
                objOpeningRow.setValue("RECEIPT_NO","");
                objOpeningRow.setValue("LEGACY_NO","");
                objOpeningRow.setValue("CHEQUE_DATE","0000-00-00");
                objOpeningRow.setValue("APPLICANT_NAME","");
                objOpeningRow.setValue("AMOUNT","");
                objOpeningRow.setValue("DEPOSIT_PERIOD","");
                objOpeningRow.setValue("INTEREST_RATE","");
                objOpeningRow.setValue("RECEIPT_DATE","0000-00-00");
                objOpeningRow.setValue("MATURITY_DATE","0000-00-00");
                objOpeningRow.setValue("CHEQUE_NO","");
                objOpeningRow.setValue("DEPOSITER_STATUS","");
                objOpeningRow.setValue("BROKER_CODE","");
                
                strSQL = "SELECT DMST.RECEIPT_NO,DMST.LEGACY_NO, DMST.RECEIPT_DATE, DMST.APPLICANT_NAME, DMST.MATURITY_DATE, DMST.AMOUNT, " +
                "DMST.DEPOSIT_PERIOD, DMST.INTEREST_RATE, DREFUND.CHEQUE_NO, DREFUND.CHEQUE_DATE, DMST.BROKER_CODE , " +
                "DREFUND.REFUND_DATE, " +
                "CASE WHEN DMST.DEPOSITER_CATEGORY = 1 THEN 'E' WHEN DMST.DEPOSITER_CATEGORY = 2 THEN 'S' " +
                "WHEN DMST.DEPOSITER_CATEGORY = 3 THEN 'C'  WHEN DMST.DEPOSITER_CATEGORY = 4 THEN 'D' " +
                "WHEN DMST.DEPOSITER_CATEGORY = 5 THEN 'I' ELSE '' END DEPOSITER_CATEGORY, " +
                "CASE WHEN SMST.SCHEME_TYPE = 1 THEN 'FD' WHEN SMST.SCHEME_TYPE = 2 THEN 'LD' " +
                "WHEN SMST.SCHEME_TYPE = 3 THEN 'CD' ELSE '' END SCHEME_TYPE " +
                "FROM D_FD_DEPOSIT_MASTER DMST, D_FD_DEPOSIT_REFUND DREFUND , D_FD_SCHEME_MASTER SMST " +
                "WHERE DREFUND.COMPANY_ID = "+EITLERPGLOBAL.gCompanyID+" AND DREFUND.APPROVED = 1 AND DREFUND.CANCELLED=0 AND DMST.DEPOSIT_TYPE_ID=" +DepositTypeID+" " +
                "AND DMST.MAIN_ACCOUNT_CODE=DREFUND.MAIN_ACCOUNT_CODE AND DMST.PARTY_CODE=DREFUND.SUB_ACCOUNT_CODE " +
                "AND DMST.COMPANY_ID=DREFUND.COMPANY_ID AND DMST.RECEIPT_NO = DREFUND.RECEIPT_NO " +
                "AND DMST.COMPANY_ID = SMST.COMPANY_ID AND DMST.SCHEME_ID = SMST.SCHEME_ID AND SMST.SCHEME_TYPE= " +ReceiptType+" " +
                " AND MONTH(DREFUND.REFUND_DATE) =  "+ nMonth +" AND YEAR(DREFUND.REFUND_DATE) = "+ txtYear.getText().trim() + " ORDER BY DREFUND.REFUND_DATE";
                System.out.println("STRING SQL = "+strSQL);
                
                ResultSet rsTmp=data.getResult(strSQL,FinanceGlobal.FinURL);
                rsTmp.first();
                
                int Counter = 0;
                
                if(rsTmp.getRow()>0) {
                    while(!rsTmp.isAfterLast()) {
                        Counter ++;
                        objRow=objReportData.newRow();
                        
                        objRow.setValue("SR_NO",Integer.toString(Counter));
                        objRow.setValue("RECEIPT_NO",UtilFunctions.getString(rsTmp,"RECEIPT_NO",""));
                        objRow.setValue("LEGACY_NO",UtilFunctions.getString(rsTmp,"LEGACY_NO",""));
                        objRow.setValue("CHEQUE_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"CHEQUE_DATE","0000-00-00")));
                        objRow.setValue("APPLICANT_NAME",UtilFunctions.getString(rsTmp,"APPLICANT_NAME",""));
                        objRow.setValue("AMOUNT",UtilFunctions.getString(rsTmp,"AMOUNT",""));
                        objRow.setValue("DEPOSIT_PERIOD",UtilFunctions.getString(rsTmp,"DEPOSIT_PERIOD",""));
                        objRow.setValue("INTEREST_RATE",UtilFunctions.getString(rsTmp,"INTEREST_RATE",""));
                        objRow.setValue("RECEIPT_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"RECEIPT_DATE","0000-00-00")));
                        objRow.setValue("MATURITY_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"MATURITY_DATE","0000-00-00")));
                        objRow.setValue("CHEQUE_NO",UtilFunctions.getString(rsTmp,"CHEQUE_NO",""));
                        objRow.setValue("DEPOSITER_STATUS",UtilFunctions.getString(rsTmp,"DEPOSITER_CATEGORY",""));
                        objRow.setValue("BROKER_CODE",UtilFunctions.getString(rsTmp,"BROKER_CODE",""));
                        
                        objReportData.AddRow(objRow);
                        
                        rsTmp.next();
                    }
                }
                
                int Comp_ID = EITLERPGLOBAL.gCompanyID;
                String month_year = cmbMonth.getSelectedItem() + " + " + txtYear.getText().trim();
                
                HashMap Parameters=new HashMap();
                Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
                Parameters.put("MONTH_YEAR",month_year);
                Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
                
                //FD Refund Receipt
                if ((ReceiptType == 1) & (ReportType == 1)) {
                    objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptFDRefundReceipt.rpt",Parameters,objReportData);
                }
                
                //CD Refund Receipt
                if ((ReceiptType == 2) & (ReportType == 1)) {
                    objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptCDRefundReceipt.rpt",Parameters,objReportData);
                }
                
                //LD Refund Receipt
                if ((ReceiptType == 3) & (ReportType == 1)) {
                    objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptLDRefundReceipt.rpt",Parameters,objReportData);
                }
            }
            
            
            
            if (ReportType == 2) {
                TReportWriter.SimpleDataProvider.TRow objRowR;
                TReportWriter.SimpleDataProvider.TTable objReportDataR=new TReportWriter.SimpleDataProvider.TTable();
                
                objReportDataR.AddColumn("SR_NO");
                objReportDataR.AddColumn("RECEIPT_NO");
                objReportDataR.AddColumn("LEGACY_NO");
                objReportDataR.AddColumn("RECEIPT_DATE");
                objReportDataR.AddColumn("APPLICANT_NAME");
                objReportDataR.AddColumn("EFFECTIVE_DATE");
                objReportDataR.AddColumn("MATURITY_DATE");
                objReportDataR.AddColumn("PARTY_CODE");
                objReportDataR.AddColumn("AMOUNT");
                objReportDataR.AddColumn("DEPOSIT_PERIOD");
                objReportDataR.AddColumn("INTEREST_RATE");
                objReportDataR.AddColumn("NEW_RECEIPT_NO");
                objReportDataR.AddColumn("DEPOSITER_STATUS");
                objReportDataR.AddColumn("BROKER_CODE");
                
                TReportWriter.SimpleDataProvider.TRow objOpeningRowR=objReportDataR.newRow();
                objOpeningRowR.setValue("SR_NO","");
                objOpeningRowR.setValue("RECEIPT_NO","");
                objOpeningRowR.setValue("LEGACY_NO","");
                objOpeningRowR.setValue("RECEIPT_DATE","0000-00-00");
                objOpeningRowR.setValue("APPLICANT_NAME","");
                objOpeningRowR.setValue("EFFECTIVE_DATE","0000-00-00");
                objOpeningRowR.setValue("MATURITY_DATE","0000-00-00");
                objOpeningRowR.setValue("PARTY_CODE","");
                objOpeningRowR.setValue("AMOUNT","");
                objOpeningRowR.setValue("DEPOSIT_PERIOD","");
                objOpeningRowR.setValue("INTEREST_RATE","");
                objOpeningRowR.setValue("NEW_RECEIPT_NO","");
                objOpeningRowR.setValue("DEPOSITER_STATUS","");
                objOpeningRowR.setValue("BROKER_CODE","");
                
                strSQL = "SELECT DMST.COMPANY_ID, DMST.RECEIPT_NO,DMST.LEGACY_NO, DMST.RECEIPT_DATE, DMST.APPLICANT_NAME, DMST.EFFECTIVE_DATE, " +
                "DMST.MATURITY_DATE, DMST.PARTY_CODE, DMST.AMOUNT, DMST.DEPOSIT_PERIOD, DMST.INTEREST_RATE, " +
                "NDMST.RECEIPT_NO NEW_RECEIPT_NO, " +
                "CASE WHEN DMST.DEPOSITER_CATEGORY = 1 THEN 'E' WHEN DMST.DEPOSITER_CATEGORY = 2 THEN 'S' " +
                "WHEN DMST.DEPOSITER_CATEGORY = 3 THEN 'C'  WHEN DMST.DEPOSITER_CATEGORY = 4 THEN 'D' " +
                "WHEN DMST.DEPOSITER_CATEGORY = 5 THEN 'I' ELSE '' END DEPOSITER_CATEGORY, DMST.BROKER_CODE , " +
                "CASE WHEN OSMST.SCHEME_TYPE = 1 THEN 'FD' WHEN OSMST.SCHEME_TYPE = 2 THEN 'LD' " +
                "WHEN OSMST.SCHEME_TYPE = 3 THEN 'CD' ELSE '' END OSCHEME_TYPE, " +
                "CASE WHEN NSMST.SCHEME_TYPE = 1 THEN 'FD' WHEN NSMST.SCHEME_TYPE = 2 THEN 'LD' " +
                "WHEN NSMST.SCHEME_TYPE = 3 THEN 'CD' ELSE '' END NSCHEME_TYPE " +
                "FROM D_FD_DEPOSIT_MASTER DMST, D_FD_SCHEME_MASTER OSMST, " +
                "D_FD_SCHEME_MASTER NSMST, D_FD_DEPOSIT_MASTER NDMST " +
                "WHERE DMST.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" AND DMST.DEPOSIT_STATUS=1 AND DMST.APPROVED=1 AND DMST.CANCELLED=0 " +
                "AND DMST.COMPANY_ID = OSMST.COMPANY_ID AND DMST.SCHEME_ID = OSMST.SCHEME_ID AND OSMST.SCHEME_TYPE=" +ReceiptType+" " +
                "AND NDMST.COMPANY_ID = NSMST.COMPANY_ID AND NDMST.SCHEME_ID = NSMST.SCHEME_ID " +
                "AND DMST.COMPANY_ID = NDMST.COMPANY_ID AND DMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO " +
                "AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' " +
                "AND MONTH(NDMST.RECEIPT_DATE) = "+ nMonth +" AND YEAR(NDMST.RECEIPT_DATE) = "+ txtYear.getText().trim() + " ORDER BY NDMST.RECEIPT_DATE ";
                //"AND MONTH(NDMST.EFFECTIVE_DATE) = "+ nMonth +" AND YEAR(NDMST.EFFECTIVE_DATE) = "+ txtYear.getText().trim() + " ORDER BY NDMST.EFFECTIVE_DATE ";
                
                //FD Renewed Receipt
                /*if ((ReceiptType == 1) & (ReportType == 2)) {
                    strSQL = "SELECT DMST.COMPANY_ID, DMST.RECEIPT_NO, DMST.RECEIPT_DATE, DMST.APPLICANT_NAME, "+
                    "DMST.EFFECTIVE_DATE, DMST.MATURITY_DATE, DMST.PARTY_CODE, DMST.AMOUNT, "+
                    "DMST.DEPOSIT_PERIOD, DMST.INTEREST_RATE, NDMST.RECEIPT_NO NEW_RECEIPT_NO, "+
                    "CASE WHEN DMST.DEPOSITER_STATUS = 1 THEN 'E' WHEN DMST.DEPOSITER_STATUS = 2 THEN 'S' "+
                    "WHEN DMST.DEPOSITER_STATUS = 3 THEN 'C'  WHEN DMST.DEPOSITER_STATUS = 4 THEN 'I' "+
                    "WHEN DMST.DEPOSITER_STATUS = 5 THEN 'D' ELSE '' END DEPOSITER_STATUS, "+
                    "DMST.BROKER_CODE , CASE WHEN SMST.SCHEME_TYPE = 1 THEN 'FD' WHEN SMST.SCHEME_TYPE = 2 THEN 'LD' "+
                    "WHEN SMST.SCHEME_TYPE = 3 THEN 'CD' ELSE '' END SCHEME_TYPE "+
                    "FROM D_FD_DEPOSIT_MASTER DMST, D_FD_SCHEME_MASTER SMST, D_FD_DEPOSIT_MASTER NDMST "+
                    "WHERE DMST.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" AND DMST.DEPOSIT_STATUS=1 AND DMST.APPROVED=1 AND DMST.CANCELLED=0  "+
                    "AND DMST.COMPANY_ID = SMST.COMPANY_ID AND DMST.SCHEME_ID = SMST.SCHEME_ID AND SMST.SCHEME_TYPE= 1  "+
                    "AND DMST.COMPANY_ID = NDMST.COMPANY_ID AND DMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO "+
                    "AND NDMST.DEPOSIT_STATUS=0 AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                    "AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' " +
                    "AND MONTH(NDMST.EFFECTIVE_DATE) = "+ nMonth +" " +
                    "AND YEAR(NDMST.EFFECTIVE_DATE) = "+ txtYear.getText().trim() + " ORDER BY NDMST.EFFECTIVE_DATE";
                }
                 
                //CD Renewed Receipt
                if ((ReceiptType == 3) & (ReportType == 2)) {
                    strSQL = "SELECT DMST.COMPANY_ID, DMST.RECEIPT_NO, DMST.RECEIPT_DATE, DMST.APPLICANT_NAME, "+
                    "DMST.EFFECTIVE_DATE, DMST.MATURITY_DATE, DMST.PARTY_CODE, DMST.AMOUNT, "+
                    "DMST.DEPOSIT_PERIOD, DMST.INTEREST_RATE, NDMST.RECEIPT_NO NEW_RECEIPT_NO, "+
                    "CASE WHEN DMST.DEPOSITER_STATUS = 1 THEN 'E' WHEN DMST.DEPOSITER_STATUS = 2 THEN 'S' "+
                    "WHEN DMST.DEPOSITER_STATUS = 3 THEN 'C'  WHEN DMST.DEPOSITER_STATUS = 4 THEN 'I' "+
                    "WHEN DMST.DEPOSITER_STATUS = 5 THEN 'D' ELSE '' END DEPOSITER_STATUS, "+
                    "DMST.BROKER_CODE , CASE WHEN SMST.SCHEME_TYPE = 1 THEN 'FD' WHEN SMST.SCHEME_TYPE = 2 THEN 'LD' "+
                    "WHEN SMST.SCHEME_TYPE = 3 THEN 'CD' ELSE '' END SCHEME_TYPE "+
                    "FROM D_FD_DEPOSIT_MASTER DMST, D_FD_SCHEME_MASTER SMST, D_FD_DEPOSIT_MASTER NDMST "+
                    "WHERE DMST.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" AND DMST.DEPOSIT_STATUS=1 AND DMST.APPROVED=1 AND DMST.CANCELLED=0  "+
                    "AND DMST.COMPANY_ID = SMST.COMPANY_ID AND DMST.SCHEME_ID = SMST.SCHEME_ID AND SMST.SCHEME_TYPE= 3 "+
                    "AND DMST.COMPANY_ID = NDMST.COMPANY_ID AND DMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO "+
                    "AND NDMST.DEPOSIT_STATUS=0 AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                    "AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' " +
                    "AND MONTH(NDMST.EFFECTIVE_DATE) = "+ nMonth +" " +
                    "AND YEAR(NDMST.EFFECTIVE_DATE) = "+ txtYear.getText().trim() + " ORDER BY NDMST.EFFECTIVE_DATE";
                }
                 
                //LD Renewed Receipt
                if ((ReceiptType == 2) & (ReportType == 2)) {
                    strSQL = "SELECT DMST.COMPANY_ID, DMST.RECEIPT_NO, DMST.RECEIPT_DATE, DMST.APPLICANT_NAME, "+
                    "DMST.EFFECTIVE_DATE, DMST.MATURITY_DATE, DMST.PARTY_CODE, DMST.AMOUNT, "+
                    "DMST.DEPOSIT_PERIOD, DMST.INTEREST_RATE, NDMST.RECEIPT_NO NEW_RECEIPT_NO, "+
                    "CASE WHEN DMST.DEPOSITER_STATUS = 1 THEN 'E' WHEN DMST.DEPOSITER_STATUS = 2 THEN 'S' "+
                    "WHEN DMST.DEPOSITER_STATUS = 3 THEN 'C'  WHEN DMST.DEPOSITER_STATUS = 4 THEN 'I' "+
                    "WHEN DMST.DEPOSITER_STATUS = 5 THEN 'D' ELSE '' END DEPOSITER_STATUS, "+
                    "DMST.BROKER_CODE , CASE WHEN SMST.SCHEME_TYPE = 1 THEN 'FD' WHEN SMST.SCHEME_TYPE = 2 THEN 'LD' "+
                    "WHEN SMST.SCHEME_TYPE = 3 THEN 'CD' ELSE '' END SCHEME_TYPE "+
                    "FROM D_FD_DEPOSIT_MASTER DMST, D_FD_SCHEME_MASTER SMST, D_FD_DEPOSIT_MASTER NDMST "+
                    "WHERE DMST.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" AND DMST.DEPOSIT_STATUS=1 AND DMST.APPROVED=1 AND DMST.CANCELLED=0  "+
                    "AND DMST.COMPANY_ID = SMST.COMPANY_ID AND DMST.SCHEME_ID = SMST.SCHEME_ID AND SMST.SCHEME_TYPE= 2 "+
                    "AND DMST.COMPANY_ID = NDMST.COMPANY_ID AND DMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO "+
                    "AND NDMST.DEPOSIT_STATUS=0 AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                    "AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' " +
                    "AND MONTH(NDMST.EFFECTIVE_DATE) = "+ nMonth +" " +
                    "AND YEAR(NDMST.EFFECTIVE_DATE) = "+ txtYear.getText().trim() + " ORDER BY NDMST.EFFECTIVE_DATE";
                }*/
                System.out.println("str = " + strSQL);
                ResultSet rsTmpR=data.getResult(strSQL,FinanceGlobal.FinURL);
                rsTmpR.first();
                
                int CounterR = 0;
                
                if(rsTmpR.getRow()>0) {
                    while(!rsTmpR.isAfterLast()) {
                        CounterR ++;
                        objRowR=objReportDataR.newRow();
                        
                        objRowR.setValue("SR_NO",Integer.toString(CounterR));
                        objRowR.setValue("RECEIPT_NO",UtilFunctions.getString(rsTmpR,"OSCHEME_TYPE","")+UtilFunctions.getString(rsTmpR,"RECEIPT_NO",""));
                        objRowR.setValue("LEGACY_NO",UtilFunctions.getString(rsTmpR,"LEGACY_NO",""));
                        objRowR.setValue("RECEIPT_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmpR,"RECEIPT_DATE","0000-00-00")));
                        objRowR.setValue("APPLICANT_NAME",UtilFunctions.getString(rsTmpR,"APPLICANT_NAME",""));
                        objRowR.setValue("EFFECTIVE_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmpR,"EFFECTIVE_DATE","0000-00-00")));
                        objRowR.setValue("MATURITY_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmpR,"MATURITY_DATE","0000-00-00")));
                        objRowR.setValue("PARTY_CODE",UtilFunctions.getString(rsTmpR,"PARTY_CODE",""));
                        objRowR.setValue("AMOUNT",UtilFunctions.getString(rsTmpR,"AMOUNT",""));
                        objRowR.setValue("DEPOSIT_PERIOD",UtilFunctions.getString(rsTmpR,"DEPOSIT_PERIOD",""));
                        objRowR.setValue("INTEREST_RATE",UtilFunctions.getString(rsTmpR,"INTEREST_RATE",""));
                        objRowR.setValue("NEW_RECEIPT_NO",UtilFunctions.getString(rsTmpR,"NSCHEME_TYPE","")+UtilFunctions.getString(rsTmpR,"NEW_RECEIPT_NO",""));
                        objRowR.setValue("DEPOSITER_STATUS",UtilFunctions.getString(rsTmpR,"DEPOSITER_CATEGORY",""));
                        objRowR.setValue("BROKER_CODE",UtilFunctions.getString(rsTmpR,"BROKER_CODE",""));
                        
                        objReportDataR.AddRow(objRowR);
                        
                        rsTmpR.next();
                    }
                }
                
                int Comp_ID = EITLERPGLOBAL.gCompanyID;
                String month_year = cmbMonth.getSelectedItem() + " + " + txtYear.getText().trim();
                
                HashMap Parameters=new HashMap();
                Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
                Parameters.put("MONTH_YEAR",month_year);
                Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
                
                if(ReceiptType==1) {
                    Parameters.put("TYPE","FD");
                } if(ReceiptType==2) {
                    Parameters.put("TYPE","LD");
                } if(ReceiptType==3) {
                    Parameters.put("TYPE","CD");
                }
                
                
                //FD Renewed Receipt
                //if ((ReceiptType == 1) & (ReportType == 2)) {
                //objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptFDRenewedReceipt.rpt",Parameters,objReportDataR);
                //}
                
                //CD Renewed Receipt
                //if ((ReceiptType == 2) & (ReportType == 2)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptCDRenewedReceipt.rpt",Parameters,objReportDataR);
                //}
                
                //LD Renewed Receipt
                /*if ((ReceiptType == 3) & (ReportType == 2)) {
                    objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptLDRenewedReceipt.rpt",Parameters,objReportDataR);
                }*/
            }
        }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
    private void GenerateCombo() {
        
        //--- Generate Type Combo ------//
        ComboData aData=new ComboData();
        
        cmbMonthModel=new EITLComboModel();
        cmbMonth.removeAllItems();
        cmbMonth.setModel(cmbMonthModel);
        
        aData=new ComboData();
        aData.Code=1;
        aData.Text="January";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=2;
        aData.Text="February";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=3;
        aData.Text="March";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=4;
        aData.Text="April";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=5;
        aData.Text="May";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=6;
        aData.Text="June";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=7;
        aData.Text="July";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=8;
        aData.Text="August";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=9;
        aData.Text="September";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=10;
        aData.Text="October";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=11;
        aData.Text="November";
        cmbMonthModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=12;
        aData.Text="December";
        cmbMonthModel.addElement(aData);
        
        
        
        cmbReceiptTypeModel=new EITLComboModel();
        cmbReceiptType.removeAllItems();
        cmbReceiptType.setModel(cmbReceiptTypeModel);
        
        aData=new ComboData();
        aData.Code=1;
        aData.Text="FD";
        cmbReceiptTypeModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=2;
        aData.Text="LD";
        cmbReceiptTypeModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=3;
        aData.Text="CD";
        cmbReceiptTypeModel.addElement(aData);
        
        
        cmbReportTypeModel=new EITLComboModel();
        cmbReportType.removeAllItems();
        cmbReportType.setModel(cmbReportTypeModel);
        
        aData=new ComboData();
        aData.Code=1;
        aData.Text="REFUND";
        cmbReportTypeModel.addElement(aData);
        
        aData=new ComboData();
        aData.Code=2;
        aData.Text="RENEWED";
        cmbReportTypeModel.addElement(aData);
        
    }
    
    private void GenerateSummary() {
        try {
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            objReportData.AddColumn("NUM_EMPLOYEE");
            objReportData.AddColumn("NUM_SHARE_HOLDERS");
            objReportData.AddColumn("NUM_COMPANY");
            objReportData.AddColumn("NUM_INDIVIDUAL");
            objReportData.AddColumn("NUM_DIRECTOR");
            objReportData.AddColumn("SUM_EMPLOYEE");
            objReportData.AddColumn("SUM_SHARE_HOLDERS");
            objReportData.AddColumn("SUM_COMPANY");
            objReportData.AddColumn("SUM_INDIVIDUAL");
            objReportData.AddColumn("SUM_DIRECTOR");
            objReportData.AddColumn("CNT_DEPOSITER_STATUS");
            objReportData.AddColumn("SUM_AMOUNT");
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            objOpeningRow.setValue("NUM_EMPLOYEE","");
            objOpeningRow.setValue("NUM_SHARE_HOLDERS","");
            objOpeningRow.setValue("NUM_COMPANY","");
            objOpeningRow.setValue("NUM_INDIVIDUAL","");
            objOpeningRow.setValue("NUM_DIRECTOR","");
            objOpeningRow.setValue("SUM_EMPLOYEE","");
            objOpeningRow.setValue("SUM_SHARE_HOLDERS","");
            objOpeningRow.setValue("SUM_COMPANY","");
            objOpeningRow.setValue("SUM_INDIVIDUAL","");
            objOpeningRow.setValue("SUM_DIRECTOR","");
            objOpeningRow.setValue("CNT_DEPOSITER_STATUS","");
            objOpeningRow.setValue("SUM_AMOUNT","");
            
            int ReceiptType = cmbReceiptType.getSelectedIndex() + 1;
            int ReportType = cmbReportType.getSelectedIndex() + 1;
            int nMonth = cmbMonth.getSelectedIndex() + 1;
            String strSQL = "";
            
            
            if (ReportType == 1) {
                strSQL= "SELECT IF (DEPOSITMST.DEPOSITER_CATEGORY = 1,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 2,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 3,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 4,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 5,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 1,SUM(DEPOSITMST.AMOUNT),0) AS SUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 2,SUM(DEPOSITMST.AMOUNT),0) AS SUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 3,SUM(DEPOSITMST.AMOUNT),0) AS SUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 4,SUM(DEPOSITMST.AMOUNT),0) AS SUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 5,SUM(DEPOSITMST.AMOUNT),0) AS SUM_INDIVIDUAL, "+
                "COUNT(DEPOSITMST.DEPOSITER_CATEGORY) AS CNT_DEPOSITER_STATUS, "+
                "IF (SUM(DEPOSITMST.AMOUNT) > 0,SUM(DEPOSITMST.AMOUNT),0) AS SUM_AMOUNT "+
                "FROM D_FD_DEPOSIT_MASTER DEPOSITMST, D_FD_SCHEME_MASTER SCHEMEMST , D_FD_DEPOSIT_REFUND DREFUND "+
                "WHERE DEPOSITMST.COMPANY_ID =" + EITLERPGLOBAL.gCompanyID + " "+
                " AND DEPOSITMST.CANCELLED=0  AND DEPOSITMST.APPROVED=1 "+
                " AND DREFUND.CANCELLED=0  AND DREFUND.APPROVED=1 "+
                "AND DEPOSITMST.COMPANY_ID = SCHEMEMST.COMPANY_ID AND DEPOSITMST.SCHEME_ID = SCHEMEMST.SCHEME_ID AND DEPOSITMST.DEPOSIT_STATUS = 1 " +
                "AND DEPOSITMST.COMPANY_ID = DREFUND.COMPANY_ID AND DEPOSITMST.RECEIPT_NO=DREFUND.RECEIPT_NO AND SCHEMEMST.SCHEME_TYPE="+ReceiptType+" " +
                "AND MONTH(DREFUND.REFUND_DATE) = "+ nMonth +" AND YEAR(DREFUND.REFUND_DATE) = " + txtYear.getText().trim() +
                " GROUP BY DEPOSITMST.DEPOSITER_CATEGORY " ;
                
            }
            
            if (ReportType == 2) {
                strSQL = "SELECT IF (DEPOSITMST.DEPOSITER_CATEGORY = 1,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 2,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 3,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 4,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 5,COUNT(DEPOSITMST.DEPOSITER_CATEGORY),0) AS NUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 1,SUM(DEPOSITMST.AMOUNT),0) AS SUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 2,SUM(DEPOSITMST.AMOUNT),0) AS SUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 3,SUM(DEPOSITMST.AMOUNT),0) AS SUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 4,SUM(DEPOSITMST.AMOUNT),0) AS SUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_CATEGORY = 5,SUM(DEPOSITMST.AMOUNT),0) AS SUM_INDIVIDUAL, "+
                "COUNT(DEPOSITMST.DEPOSITER_CATEGORY) AS CNT_DEPOSITER_STATUS, "+
                "IF (SUM(DEPOSITMST.AMOUNT) > 0,SUM(DEPOSITMST.AMOUNT),0) AS SUM_AMOUNT "+
                "FROM D_FD_DEPOSIT_MASTER DEPOSITMST, D_FD_SCHEME_MASTER SCHEMEMST , D_FD_DEPOSIT_MASTER NDMST "+
                "WHERE DEPOSITMST.COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " AND DEPOSITMST.APPROVED=1  AND DEPOSITMST.CANCELLED=0 "+
                "AND DEPOSITMST.COMPANY_ID = SCHEMEMST.COMPANY_ID AND DEPOSITMST.SCHEME_ID = SCHEMEMST.SCHEME_ID  AND SCHEMEMST.SCHEME_TYPE = "+ReceiptType+" "+
                "AND DEPOSITMST.COMPANY_ID = NDMST.COMPANY_ID AND DEPOSITMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO "+
                //"AND NDMST.DEPOSIT_STATUS=0 AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                "AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                "AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' "+
                "AND MONTH(NDMST.RECEIPT_DATE) =  "+ nMonth +" AND YEAR(NDMST.RECEIPT_DATE) = " + txtYear.getText().trim() +
                " GROUP BY DEPOSITMST.DEPOSITER_CATEGORY " ;
                
            }
            
            /*//CD Refund Receipt
            if ((ReceiptType == 2) & (ReportType == 1)) {
                strSQL= "SELECT IF (DEPOSITMST.DEPOSITER_STATUS = 1,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 1,SUM(DEPOSITMST.AMOUNT),0) AS SUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,SUM(DEPOSITMST.AMOUNT),0) AS SUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,SUM(DEPOSITMST.AMOUNT),0) AS SUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,SUM(DEPOSITMST.AMOUNT),0) AS SUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,SUM(DEPOSITMST.AMOUNT),0) AS SUM_DIRECTOR, "+
                "COUNT(DEPOSITMST.DEPOSITER_STATUS) AS CNT_DEPOSITER_STATUS, "+
                "IF (SUM(DEPOSITMST.AMOUNT) > 0,SUM(DEPOSITMST.AMOUNT),0) AS SUM_AMOUNT "+
                "FROM D_FD_DEPOSIT_MASTER DEPOSITMST, D_FD_SCHEME_MASTER SCHEMEMST , D_FD_DEPOSIT_REFUND DREFUND "+
                "WHERE DEPOSITMST.COMPANY_ID =" + EITLERPGLOBAL.gCompanyID + " AND DEPOSITMST.DEPOSIT_STATUS=0 "+
                "AND DEPOSITMST.CANCELLED=0 AND DEPOSITMST.APPROVED=1 "+
                "AND DEPOSITMST.COMPANY_ID = SCHEMEMST.COMPANY_ID AND DEPOSITMST.SCHEME_ID = SCHEMEMST.SCHEME_ID " +
                "AND DEPOSITMST.COMPANY_ID = DREFUND.COMPANY_ID AND DEPOSITMST.RECEIPT_NO=DREFUND.RECEIPT_NO AND SCHEMEMST.SCHEME_TYPE=3 " +
                "AND MONTH(DREFUND.MATURITY_DATE) = "+ nMonth +" AND YEAR(DREFUND.MATURITY_DATE) = " + txtYear.getText().trim() +
                " GROUP BY DEPOSITMST.DEPOSITER_STATUS " ;
             
            }
            //CD Renewed Receipt
            if ((ReceiptType == 2) & (ReportType == 2)) {
                strSQL = "SELECT IF (DEPOSITMST.DEPOSITER_STATUS = 1,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 1,SUM(DEPOSITMST.AMOUNT),0) AS SUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,SUM(DEPOSITMST.AMOUNT),0) AS SUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,SUM(DEPOSITMST.AMOUNT),0) AS SUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,SUM(DEPOSITMST.AMOUNT),0) AS SUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,SUM(DEPOSITMST.AMOUNT),0) AS SUM_DIRECTOR, "+
                "COUNT(DEPOSITMST.DEPOSITER_STATUS) AS CNT_DEPOSITER_STATUS, "+
                "IF (SUM(DEPOSITMST.AMOUNT) > 0,SUM(DEPOSITMST.AMOUNT),0) AS SUM_AMOUNT "+
                "FROM D_FD_DEPOSIT_MASTER DEPOSITMST, D_FD_SCHEME_MASTER SCHEMEMST , D_FD_DEPOSIT_MASTER NDMST "+
                "WHERE DEPOSITMST.COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " AND DEPOSITMST.DEPOSIT_STATUS=1  AND DEPOSITMST.APPROVED=1  AND DEPOSITMST.CANCELLED=0 "+
                "AND DEPOSITMST.COMPANY_ID = SCHEMEMST.COMPANY_ID AND DEPOSITMST.SCHEME_ID = SCHEMEMST.SCHEME_ID  AND SCHEMEMST.SCHEME_TYPE = 3 "+
                "AND DEPOSITMST.COMPANY_ID = NDMST.COMPANY_ID AND DEPOSITMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO "+
                "AND NDMST.DEPOSIT_STATUS=0 AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                "AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' "+
                "AND MONTH(NDMST.EFFECTIVE_DATE) =  "+ nMonth +" AND YEAR(NDMST.EFFECTIVE_DATE) = " + txtYear.getText().trim() +
                " GROUP BY DEPOSITMST.DEPOSITER_STATUS " ;
            }
             
            //LD Refund Receipt
            if ((ReceiptType == 3) & (ReportType == 1)) {
                strSQL= "SELECT IF (DEPOSITMST.DEPOSITER_STATUS = 1,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 1,SUM(DEPOSITMST.AMOUNT),0) AS SUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,SUM(DEPOSITMST.AMOUNT),0) AS SUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,SUM(DEPOSITMST.AMOUNT),0) AS SUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,SUM(DEPOSITMST.AMOUNT),0) AS SUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,SUM(DEPOSITMST.AMOUNT),0) AS SUM_DIRECTOR, "+
                "COUNT(DEPOSITMST.DEPOSITER_STATUS) AS CNT_DEPOSITER_STATUS, "+
                "IF (SUM(DEPOSITMST.AMOUNT) > 0,SUM(DEPOSITMST.AMOUNT),0) AS SUM_AMOUNT "+
                "FROM D_FD_DEPOSIT_MASTER DEPOSITMST, D_FD_SCHEME_MASTER SCHEMEMST , D_FD_DEPOSIT_REFUND DREFUND "+
                "WHERE DEPOSITMST.COMPANY_ID =" + EITLERPGLOBAL.gCompanyID + " AND DEPOSITMST.DEPOSIT_STATUS=0 "+
                "AND DEPOSITMST.CANCELLED=0 AND DEPOSITMST.APPROVED=1 "+
                "AND DEPOSITMST.COMPANY_ID = SCHEMEMST.COMPANY_ID AND DEPOSITMST.SCHEME_ID = SCHEMEMST.SCHEME_ID " +
                "AND DEPOSITMST.COMPANY_ID = DREFUND.COMPANY_ID AND DEPOSITMST.RECEIPT_NO=DREFUND.RECEIPT_NO AND SCHEMEMST.SCHEME_TYPE=2" +
                "AND MONTH(DREFUND.MATURITY_DATE) = "+ nMonth +" AND YEAR(DREFUND.MATURITY_DATE) = " + txtYear.getText().trim() +
                " GROUP BY DEPOSITMST.DEPOSITER_STATUS " ;
            }
            //LD Renewed Receipt
            if ((ReceiptType == 3) & (ReportType == 2)) {
                strSQL = "SELECT IF (DEPOSITMST.DEPOSITER_STATUS = 1,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,COUNT(DEPOSITMST.DEPOSITER_STATUS),0) AS NUM_DIRECTOR, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 1,SUM(DEPOSITMST.AMOUNT),0) AS SUM_EMPLOYEE, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 2,SUM(DEPOSITMST.AMOUNT),0) AS SUM_SHARE_HOLDERS, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 3,SUM(DEPOSITMST.AMOUNT),0) AS SUM_COMPANY, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 4,SUM(DEPOSITMST.AMOUNT),0) AS SUM_INDIVIDUAL, "+
                "IF (DEPOSITMST.DEPOSITER_STATUS = 5,SUM(DEPOSITMST.AMOUNT),0) AS SUM_DIRECTOR, "+
                "COUNT(DEPOSITMST.DEPOSITER_STATUS) AS CNT_DEPOSITER_STATUS, "+
                "IF (SUM(DEPOSITMST.AMOUNT) > 0,SUM(DEPOSITMST.AMOUNT),0) AS SUM_AMOUNT "+
                "FROM D_FD_DEPOSIT_MASTER DEPOSITMST, D_FD_SCHEME_MASTER SCHEMEMST , D_FD_DEPOSIT_MASTER NDMST "+
                "WHERE DEPOSITMST.COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " AND DEPOSITMST.DEPOSIT_STATUS=1  AND DEPOSITMST.APPROVED=1  AND DEPOSITMST.CANCELLED=0 "+
                "AND DEPOSITMST.COMPANY_ID = SCHEMEMST.COMPANY_ID AND DEPOSITMST.SCHEME_ID = SCHEMEMST.SCHEME_ID  AND SCHEMEMST.SCHEME_TYPE = 2 "+
                "AND DEPOSITMST.COMPANY_ID = NDMST.COMPANY_ID AND DEPOSITMST.RECEIPT_NO=NDMST.OLD_RECEIPT_NO "+
                "AND NDMST.DEPOSIT_STATUS=0 AND NDMST.APPROVED=1 AND NDMST.CANCELLED=0 "+
                "AND NDMST.DEPOSIT_ENTRY_TYPE = 2 AND NDMST.OLD_RECEIPT_NO <> '' "+
                "AND MONTH(NDMST.EFFECTIVE_DATE) =  "+ nMonth +" AND YEAR(NDMST.EFFECTIVE_DATE) = " + txtYear.getText().trim() +
                " GROUP BY DEPOSITMST.DEPOSITER_STATUS " ;
            }
             */
            System.out.println("sql="+strSQL);
            
            ResultSet rsTmp=data.getResult(strSQL,FinanceGlobal.FinURL);
            rsTmp.first();
            
            int Counter = 0;
            double NUM_EMPLOYEE=0.0,NUM_SHARE_HOLDERS=0.0,NUM_COMPANY=0.0,NUM_INDIVIDUAL=0.0,NUM_DIRECTOR=0.0;
            double SUM_EMPLOYEE=0.0,SUM_SHARE_HOLDERS=0.0,SUM_COMPANY=0.0,SUM_INDIVIDUAL=0.0,SUM_DIRECTOR=0.0;
            double CNT_DEPOSITER_STATUS=0.0,SUM_AMOUNT=0.0;
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    
                    NUM_EMPLOYEE += UtilFunctions.getLong(rsTmp,"NUM_EMPLOYEE",0);
                    NUM_SHARE_HOLDERS += UtilFunctions.getLong(rsTmp,"NUM_SHARE_HOLDERS",0);
                    NUM_COMPANY += UtilFunctions.getLong(rsTmp,"NUM_COMPANY",0);
                    NUM_INDIVIDUAL += UtilFunctions.getLong(rsTmp,"NUM_INDIVIDUAL",0);
                    NUM_DIRECTOR += UtilFunctions.getLong(rsTmp,"NUM_DIRECTOR",0);
                    SUM_EMPLOYEE += UtilFunctions.getLong(rsTmp,"SUM_EMPLOYEE",0);
                    SUM_SHARE_HOLDERS += UtilFunctions.getLong(rsTmp,"SUM_SHARE_HOLDERS",0);
                    SUM_COMPANY += UtilFunctions.getLong(rsTmp,"SUM_COMPANY",0);
                    SUM_INDIVIDUAL += UtilFunctions.getLong(rsTmp,"SUM_INDIVIDUAL",0);
                    SUM_DIRECTOR += UtilFunctions.getLong(rsTmp,"SUM_DIRECTOR",0);
                    CNT_DEPOSITER_STATUS += UtilFunctions.getLong(rsTmp,"CNT_DEPOSITER_STATUS",0);
                    SUM_AMOUNT += UtilFunctions.getLong(rsTmp,"SUM_AMOUNT",0);
                    
                    rsTmp.next();
                }
            }
            
            objRow=objReportData.newRow();
            
            objRow.setValue("NUM_EMPLOYEE",Double.toString(NUM_EMPLOYEE));
            objRow.setValue("NUM_SHARE_HOLDERS",Double.toString(NUM_SHARE_HOLDERS));
            objRow.setValue("NUM_COMPANY",Double.toString(NUM_COMPANY));
            objRow.setValue("NUM_INDIVIDUAL",Double.toString(NUM_INDIVIDUAL));
            objRow.setValue("NUM_DIRECTOR",Double.toString(NUM_DIRECTOR));
            objRow.setValue("SUM_EMPLOYEE",Double.toString(SUM_EMPLOYEE));
            objRow.setValue("SUM_SHARE_HOLDERS",Double.toString(SUM_SHARE_HOLDERS));
            objRow.setValue("SUM_COMPANY",Double.toString(SUM_COMPANY));
            objRow.setValue("SUM_INDIVIDUAL",Double.toString(SUM_INDIVIDUAL));
            objRow.setValue("SUM_DIRECTOR",Double.toString(SUM_DIRECTOR));
            objRow.setValue("CNT_DEPOSITER_STATUS",Double.toString(CNT_DEPOSITER_STATUS));
            objRow.setValue("SUM_AMOUNT",Double.toString(SUM_AMOUNT));
            
            objReportData.AddRow(objRow);
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            
            String month_year = cmbMonth.getSelectedItem() + " + " + txtYear.getText().trim();
            
            HashMap Parameters=new HashMap();
            Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
            Parameters.put("MONTH_YEAR",month_year);
            
            
            //FD Refund Receipt
            if ((ReceiptType == 1) & (ReportType == 1)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptFDRefundReceiptSummary.rpt",Parameters,objReportData);
            }
            //FD Renewed Receipt
            if ((ReceiptType == 1) & (ReportType == 2)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptFDRenewedReceiptSummary.rpt",Parameters,objReportData);
            }
            
            //CD Refund Receipt
            if ((ReceiptType == 2) & (ReportType == 1)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptCDRefundReceiptSummary.rpt",Parameters,objReportData);
            }
            //CD Renewed Receipt
            if ((ReceiptType == 2) & (ReportType == 2)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptCDRenewedReceiptSummary.rpt",Parameters,objReportData);
            }
            
            //LD Refund Receipt
            if ((ReceiptType == 3) & (ReportType == 1)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptLDRefundReceiptSummary.rpt",Parameters,objReportData);
            }
            //LD Renewed Receipt
            if ((ReceiptType == 3) & (ReportType == 2)) {
                objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/finance/rptLDRenewedReceiptSummary.rpt",Parameters,objReportData);
            }
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
    
    private boolean Validate() {
        //Form level validations
        if(txtYear.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter Year");
            return false;
        } else if(!EITLERPGLOBAL.IsNumber(txtYear.getText().trim())) {
            JOptionPane.showMessageDialog(null,"Invalid Year in YYYY format.");
            return false;
        } else if (txtYear.getText().trim().length() != 4) {
            JOptionPane.showMessageDialog(null,"Invalid Year in YYYY format.");
            return false;
        }
        
        
        return true;
    }
}
