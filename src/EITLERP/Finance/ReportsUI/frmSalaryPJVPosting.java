/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package EITLERP.Finance.ReportsUI;

import EITLERP.EITLERPGLOBAL;
import EITLERP.EITLTableCellRenderer;
import EITLERP.EITLTableModel;
import EITLERP.Finance.FinanceGlobal;
import EITLERP.Finance.UtilFunctions;
import EITLERP.Finance.clsPartyMaster;
import EITLERP.Finance.clsVoucher;
import EITLERP.Sales.clsSalesInvoice;
import EITLERP.data;
import EITLERP.*;
//import TReportWriter.TReportEngine;
import TReportWriter.*;
import TReportWriter.SimpleDataProvider.*;
import java.awt.Color;
import java.awt.Component;
import java.awt.event.KeyEvent;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.math.BigDecimal;
import java.net.URL;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.HashMap;
import javax.swing.DefaultCellEditor;
import javax.swing.JCheckBox;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JProgressBar;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumnModel;

/**
 *
 * @author root
 */
public class frmSalaryPJVPosting extends javax.swing.JApplet {

    private ResultSet rsResultSet, rsResultSet1, rsResultSet2;
    private Connection Conn;
    private Statement Stmt;

    public String S = "";
    public int Flag = 0;
    private EITLTableModel DataModel;
    private boolean InvFlag = false;
    private boolean cntrFlag = false;

    /**
     * Initializes the applet frmFeltInvPro
     */
    @Override
    public void init() {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
//        try {
//            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
//                if ("Nimbus".equals(info.getName())) {
//                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
//                    break;
//                }
//            }
//        } catch (ClassNotFoundException ex) {
//            java.util.logging.Logger.getLogger(frmFeltInvPro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
//        } catch (InstantiationException ex) {
//            java.util.logging.Logger.getLogger(frmFeltInvPro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
//        } catch (IllegalAccessException ex) {
//            java.util.logging.Logger.getLogger(frmFeltInvPro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
//        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
//            java.util.logging.Logger.getLogger(frmFeltInvPro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
//        }
        //</editor-fold>

        /* Create and display the applet */
//        try {
//            java.awt.EventQueue.invokeAndWait(new Runnable() {
//                public void run() {
//                    initComponents();
//                }
//            });
//        } catch (Exception ex) {
//            ex.printStackTrace();
//        }
        setSize(970, 400);
        initComponents();
        lblTitle.setForeground(Color.WHITE);
        jPanel2.setVisible(true);
        getDept();
//        btnPanel.setVisible(false);
        GeneratePayList();
    }

    /**
     * This method is called from within the init() method to initialize the
     * form. WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        lblTitle = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        btnPanel = new javax.swing.JPanel();
        btnProcess = new javax.swing.JButton();

        getContentPane().setLayout(null);

        lblTitle.setBackground(new java.awt.Color(0, 102, 153));
        lblTitle.setText("Salary PJV Posting Form");
        lblTitle.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        lblTitle.setOpaque(true);
        getContentPane().add(lblTitle);
        lblTitle.setBounds(0, 2, 970, 25);

        jPanel2.setLayout(null);

        Table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(Table);

        jPanel2.add(jScrollPane1);
        jScrollPane1.setBounds(10, 10, 950, 240);

        getContentPane().add(jPanel2);
        jPanel2.setBounds(0, 30, 970, 250);

        btnPanel.setLayout(null);

        btnProcess.setText("Process");
        btnProcess.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnProcessActionPerformed(evt);
            }
        });
        btnPanel.add(btnProcess);
        btnProcess.setBounds(20, 0, 170, 25);

        getContentPane().add(btnPanel);
        btnPanel.setBounds(740, 290, 210, 30);
    }// </editor-fold>//GEN-END:initComponents

    private void btnProcessActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnProcessActionPerformed
        // TODO add your handling code here:
        if (!Validate()) {
            return;
        }
        for (int j = 0; j < Table.getRowCount(); j++) {
            String pDate = Table.getValueAt(j, Table.getColumnCount() - 1).toString();
            String sql2 = "UPDATE SDMLATTPAY.PAYROLL_MTH_JV_POSTING_SUMMARY "
                    + "SET VOUCHER_HDFC_DATE = '" + EITLERPGLOBAL.formatDateDB(pDate) + "' "
                    + "WHERE JV_MONTH='" + Table.getValueAt(j, 0) + "' AND JV_YEAR='" + Table.getValueAt(j, 1) + "' "
                    + "AND JV_CATEGORY='" + Table.getValueAt(j, 2) + "' ";
            data.Execute(sql2);
        }
        data.Execute("TRUNCATE SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY ");
        data.Execute("INSERT INTO SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY "
                + "(JV_MONTH, JV_YEAR, JV_CATEGORY, JVE_BASIC, JVE_RETAINER_FEE, JVE_DA, JVE_HRA, JVE_CONVEYANCE, JVE_ELECTRICITY, JVE_PERSONAL_PAY, JVE_MAGAZINE_ALW, JVE_PERFORMANCE_ALW, JVE_OTHER_ALW, JVE_AWARD_HRA, JVE_DA_DIFF, JVE_MED_EDU_HOT_AMT, JVE_ADHOC_PAY, JVE_WASH_ALW, JVE_WASH_MTH, JVE_PH_AMOUNT, JVE_ARREAR_MEDICAL, JVE_ARREAR_AMOUNT, JVE_FURNISHING, JVE_PRE_FURNISH, JVE_SALARY_ADJUSTMENT, JVE_TOTAL_EARNING, JVE_ALL_EARNING_TOTAL, JVE_ALL_EARNING_DIFF, JVE_TOTAL_HRA, JVE_TOTAL_EARNING_WO_HRA, JVE_ATTD_ALW, JVD_PF_AMOUNT, JVD_ESIC_AMOUNT, JVD_PROF_TAX_AMOUNT, JVD_GLWF_AMOUNT, JVD_OTHER_DED_AMOUNT, JVD_REVENUE_AMOUNT, JVD_SOCIAL_PAY_AMOUNT, JVD_SOCIETY_DED, JVD_HDFC_PAY_AMOUNT, JVD_MLWF_AMOUNT, JVD_LIP_AMOUNT, JVD_TDS, JVD_COVID_19_PA, JVD_RENT_DEDUCTION, JVD_UNION_FEE, JVD_UNION_LEVY, JVD_KASAR, JVD_TOTAL_DEDUCTION, JVD_ALL_DEDUCTION_TOTAL, JVD_ALL_DEDUCTION_DIFF, JVD_OTH_DEDUCTION, JV_NET_AMOUNT, VOUCHER_HDFC_DATE) "
                + "SELECT "
                + " JV_MONTH, JV_YEAR, JV_CATEGORY, JVE_BASIC, JVE_RETAINER_FEE, JVE_DA, JVE_HRA, JVE_CONVEYANCE, JVE_ELECTRICITY, JVE_PERSONAL_PAY, JVE_MAGAZINE_ALW, JVE_PERFORMANCE_ALW, JVE_OTHER_ALW, JVE_AWARD_HRA, JVE_DA_DIFF, JVE_MED_EDU_HOT_AMT, JVE_ADHOC_PAY, JVE_WASH_ALW, JVE_WASH_MTH, JVE_PH_AMOUNT, JVE_ARREAR_MEDICAL, JVE_ARREAR_AMOUNT, JVE_FURNISHING, JVE_PRE_FURNISH, JVE_SALARY_ADJUSTMENT, JVE_TOTAL_EARNING, JVE_ALL_EARNING_TOTAL, JVE_ALL_EARNING_DIFF, JVE_TOTAL_HRA, JVE_TOTAL_EARNING_WO_HRA, JVE_ATTD_ALW, JVD_PF_AMOUNT, JVD_ESIC_AMOUNT, JVD_PROF_TAX_AMOUNT, JVD_GLWF_AMOUNT, JVD_OTHER_DED_AMOUNT, JVD_REVENUE_AMOUNT, JVD_SOCIAL_PAY_AMOUNT, JVD_SOCIETY_DED, JVD_HDFC_PAY_AMOUNT, JVD_MLWF_AMOUNT, JVD_LIP_AMOUNT, JVD_TDS, JVD_COVID_19_PA, JVD_RENT_DEDUCTION, JVD_UNION_FEE, JVD_UNION_LEVY, JVD_KASAR, JVD_TOTAL_DEDUCTION, JVD_ALL_DEDUCTION_TOTAL, JVD_ALL_DEDUCTION_DIFF, JVD_OTH_DEDUCTION, JV_NET_AMOUNT, VOUCHER_HDFC_DATE "
                + "FROM SDMLATTPAY.PAYROLL_MTH_JV_POSTING_SUMMARY WHERE COALESCE(VOUCHER_NO,'')='' ");

        SalaryPJVPosting();
        btnPanel.setVisible(false);
    }//GEN-LAST:event_btnProcessActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable Table;
    private javax.swing.JPanel btnPanel;
    private javax.swing.JButton btnProcess;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblTitle;
    // End of variables declaration//GEN-END:variables

    private boolean Validate() {
        //Form level validations
        for (int j = 0; j < Table.getRowCount(); j++) {
            if (Table.getValueAt(j, Table.getColumnCount() - 1).toString().trim().equals("")) {
                JOptionPane.showMessageDialog(null, "Please Enter Pay Date");
                return false;
            } else if (!EITLERPGLOBAL.isDate(Table.getValueAt(j, Table.getColumnCount() - 1).toString().trim())) {
                JOptionPane.showMessageDialog(null, "Invalid Pay Date in DD/MM/YYYY format.");
                return false;
            }
        }
        return true;
    }

    private void getDept() {
        if (EITLERPGLOBAL.gUserDeptID == 10 || EITLERPGLOBAL.gUserDeptID == 76 || EITLERPGLOBAL.gUserID == 1) {
            btnProcess.setVisible(true);
            btnProcess.setEnabled(true);
        } else {
            btnProcess.setEnabled(false);
            btnProcess.setVisible(false);
        }
    }

    private void GeneratePayList() {
        String sql = "";
        ResultSet rs;
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);
        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DefaultTableCellRenderer rightRenderer = new DefaultTableCellRenderer();
        rightRenderer.setHorizontalAlignment(JLabel.RIGHT);

        try {
            sql = "SELECT "
                    + "JV_MONTH AS 'Month', JV_YEAR AS 'Year', JV_CATEGORY AS 'Category', JVE_BASIC AS 'Basic', JVE_RETAINER_FEE AS 'Retainer Fee', JVE_DA AS 'DA', JVE_DA_DIFF AS 'DA Diff', JVE_HRA AS 'HRA', JVE_CONVEYANCE AS 'Conv. Alw', JVE_ELECTRICITY AS 'Elect. Alw', JVE_PERSONAL_PAY AS 'Pers. Pay', JVE_MAGAZINE_ALW AS 'Maga. Alw', JVE_PERFORMANCE_ALW AS 'Perf. Alw', JVE_AWARD_HRA AS 'Award HRA', JVE_ATTD_ALW AS 'Atnd. Alw', JVE_OTHER_ALW AS 'Other Alw', JVE_MED_EDU_HOT_AMT AS 'Med/Edu %', JVE_ADHOC_PAY AS 'Adhoc Pay', JVE_WASH_ALW AS 'Wash Alw', JVE_WASH_MTH AS 'Wash Month', JVE_PH_AMOUNT AS 'PH Amount', JVE_ARREAR_MEDICAL AS 'Arrears Medical', JVE_ARREAR_AMOUNT AS 'Arrears Amount', JVE_SALARY_ADJUSTMENT AS 'Basic Adjus', JVE_TOTAL_EARNING AS 'Gross Earnings', JVE_TOTAL_HRA AS 'Total HRA', JVE_TOTAL_EARNING_WO_HRA AS 'Total WO HRA', JVD_PF_AMOUNT AS 'PF', JVD_ESIC_AMOUNT AS 'ESI', JVD_PROF_TAX_AMOUNT AS 'PT', JVD_TDS AS 'TDS', JVD_RENT_DEDUCTION AS 'Rent Deduc', JVD_GLWF_AMOUNT AS 'GLWF', JVD_OTHER_DED_AMOUNT AS 'Oth. Deduc', JVD_REVENUE_AMOUNT AS 'Revenue', JVD_SOCIAL_PAY_AMOUNT AS 'Soc. Pay', JVD_SOCIETY_DED AS 'Soc. Deduction', JVD_HDFC_PAY_AMOUNT AS 'HDFC Pay', JVD_MLWF_AMOUNT AS 'MLWF', JVD_LIP_AMOUNT AS 'LIP Amt', JVD_COVID_19_PA AS 'Covid19 PA', JVD_UNION_FEE AS 'Union Levy', JVD_KASAR AS 'Kasar', JVD_TOTAL_DEDUCTION AS 'Gross Deductions', JV_NET_AMOUNT AS 'Net Total', '' AS 'PAY DATE' "
                    + "FROM SDMLATTPAY.PAYROLL_MTH_JV_POSTING_SUMMARY WHERE COALESCE(VOUCHER_NO,'')='' ";

            System.out.println(sql);
            rs = data.getResult(sql);
            ResultSetMetaData rsInfo = rs.getMetaData();

            //Format the table from the resultset meta data
            int i = 1;
            for (i = 1; i <= rsInfo.getColumnCount(); i++) {
                DataModel.addColumn(rsInfo.getColumnName(i));
            }
            rs.first();
            System.out.println("Row no." + rs.getRow());
            if (rs.getRow() > 0) {
                while (!rs.isAfterLast()) {
                    Object[] rowData = new Object[100];
                    for (int m = 1; m < i; m++) {
                        rowData[m - 1] = rs.getString(m);
                    }
                    DataModel.addRow(rowData);
                    rs.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 80; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }
            for (i = 3; i < rsInfo.getColumnCount() - 1; i++) {
                Table.getColumnModel().getColumn(i).setCellRenderer(rightRenderer);
            }
//            DataModel.TableReadOnly(true);
            for (i = 0; i < rsInfo.getColumnCount() - 1; i++) {
                DataModel.SetReadOnly(i);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void SalaryPJVPosting() {
        String frmyr = String.valueOf(EITLERPGLOBAL.getCurrentFinYear());
        String fyr = frmyr.substring(2, 4);
//        System.out.println(frmyr);
//        System.out.println(fyr);
//        String toyr = String.valueOf(EITLERPGLOBAL.getCurrentFinYear() + 1);
//        String tyr = toyr.substring(2, 4);
//        System.out.println(toyr);
//        System.out.println(tyr);

        try {
            Conn = data.getConn();
            Stmt = Conn.createStatement();

            if (data.IsRecordExist("SELECT VOUCHER_NO FROM D_FIN_VOUCHER_HEADER WHERE COMPANY_ID=" + EITLERPGLOBAL.gCompanyID + "  AND LEFT(VOUCHER_NO,2) = 'JV'", FinanceGlobal.FinURL)) {
                rsResultSet = Stmt.executeQuery("SELECT VOUCHER_NO,SUBSTRING(VOUCHER_NO,1,6) AS JV,RIGHT(VOUCHER_NO,5) AS JVSRNO FROM (SELECT MAX(VOUCHER_NO) AS VOUCHER_NO FROM FINANCE.D_FIN_VOUCHER_HEADER WHERE COMPANY_ID=" + EITLERPGLOBAL.gCompanyID + "  AND LEFT(VOUCHER_NO,2) = 'JV' AND SUBSTRING(VOUCHER_NO,5,2)='25' AND SUBSTRING(VOUCHER_NO,3,2)='" + fyr + "' ) AS A");
                String LastDocNo = "";
                String LastcnvNo = "";
                int draftSrNo = 0;

                rsResultSet.first();
                while (!rsResultSet.isAfterLast() && rsResultSet.getRow() > 0) {
                    LastDocNo = rsResultSet.getString("VOUCHER_NO");
                    LastcnvNo = rsResultSet.getString("JV");
                    draftSrNo = rsResultSet.getInt("JVSRNO");

                    rsResultSet.next();
                }

                String draftNo = "";
                String draftDate = EITLERPGLOBAL.getCurrentDateDB();

                int counter = 1;
                ResultSet rsSchemeHeader = Stmt.executeQuery("SELECT JV_MONTH, JV_YEAR, JV_CATEGORY, VOUCHER_HDFC_DATE, UCASE(MONTHNAME(CONCAT('2020-',JV_MONTH,'-02'))) AS JV_MTH_NAME FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY ");

                rsSchemeHeader.first();
                if (rsSchemeHeader.getRow() > 0) {
                    while (!rsSchemeHeader.isAfterLast()) {
                        System.out.println("JV_CATEGORY : " + rsSchemeHeader.getString("JV_CATEGORY"));
                        String pRemark = "";
                        if (rsSchemeHeader.getString("JV_CATEGORY").trim().equals("BRD_STAFF")) {
                            pRemark = "BEING THE AMOUNT OF BARODA STAFF SALARY FOR THE MONTH OF " + rsSchemeHeader.getString("JV_MTH_NAME") + "," + rsSchemeHeader.getString("JV_YEAR") + "-HDFC E PAYMENT DTD " + EITLERPGLOBAL.formatDate(rsSchemeHeader.getString("VOUCHER_HDFC_DATE"));
                        }
                        if (rsSchemeHeader.getString("JV_CATEGORY").trim().equals("BRD_WORKER")) {
                            pRemark = "BEING THE AMOUNT OF BARODA WORKER WAGES FOR THE MONTH OF " + rsSchemeHeader.getString("JV_MTH_NAME") + "," + rsSchemeHeader.getString("JV_YEAR") + "-HDFC E PAYMENT DTD " + EITLERPGLOBAL.formatDate(rsSchemeHeader.getString("VOUCHER_HDFC_DATE"));
                        }
                        if (rsSchemeHeader.getString("JV_CATEGORY").trim().equals("BRD_RETAINER")) {
                            pRemark = "BEING THE AMOUNT OF BARODA RETAINER SALARY FOR THE MONTH OF " + rsSchemeHeader.getString("JV_MTH_NAME") + "," + rsSchemeHeader.getString("JV_YEAR") + "-HDFC E PAYMENT DTD " + EITLERPGLOBAL.formatDate(rsSchemeHeader.getString("VOUCHER_HDFC_DATE"));
                        }
                        if (rsSchemeHeader.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                            pRemark = "BEING THE AMOUNT OF ANKLESHWAR STAFF SALARY FOR THE MONTH OF " + rsSchemeHeader.getString("JV_MTH_NAME") + "," + rsSchemeHeader.getString("JV_YEAR") + "-HDFC E PAYMENT DTD " + EITLERPGLOBAL.formatDate(rsSchemeHeader.getString("VOUCHER_HDFC_DATE"));
                        }
                        if (rsSchemeHeader.getString("JV_CATEGORY").trim().equals("ANK_WORKER")) {
                            pRemark = "BEING THE AMOUNT OF ANKLESHWAR WORKER WAGES FOR THE MONTH OF " + rsSchemeHeader.getString("JV_MTH_NAME") + "," + rsSchemeHeader.getString("JV_YEAR") + "-HDFC E PAYMENT DTD " + EITLERPGLOBAL.formatDate(rsSchemeHeader.getString("VOUCHER_HDFC_DATE"));
                        }
                        if (rsSchemeHeader.getString("JV_CATEGORY").trim().equals("ANK_RETAINER")) {
                            pRemark = "BEING THE AMOUNT OF ANKLESHWAR RETAINER SALARY FOR THE MONTH OF " + rsSchemeHeader.getString("JV_MTH_NAME") + "," + rsSchemeHeader.getString("JV_YEAR") + "-HDFC E PAYMENT DTD " + EITLERPGLOBAL.formatDate(rsSchemeHeader.getString("VOUCHER_HDFC_DATE"));
                        }

                        Statement st2 = Conn.createStatement();
                        String SQL1 = "UPDATE SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY SET VOUCHER_NO=CONCAT('JV','" + fyr + "',2500000 +ABS(REPLACE(RIGHT('" + draftNo + (draftSrNo + counter) + "',4),' ',''))),VOUCHER_DATE='" + draftDate + "',VOUCHER_REMARKS='" + pRemark + "' WHERE JV_MONTH='" + rsSchemeHeader.getString("JV_MONTH") + "' AND JV_YEAR='" + rsSchemeHeader.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsSchemeHeader.getString("JV_CATEGORY") + "' ";
//                        System.out.println("SQL 1 : " + SQL1);
                        st2.execute(SQL1);

                        String SQL2 = "UPDATE SDMLATTPAY.PAYROLL_MTH_JV_POSTING_SUMMARY SET VOUCHER_NO=CONCAT('JV','" + fyr + "',2500000 +ABS(REPLACE(RIGHT('" + draftNo + (draftSrNo + counter) + "',4),' ',''))),VOUCHER_DATE='" + draftDate + "',VOUCHER_REMARKS='" + pRemark + "' WHERE JV_MONTH='" + rsSchemeHeader.getString("JV_MONTH") + "' AND JV_YEAR='" + rsSchemeHeader.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsSchemeHeader.getString("JV_CATEGORY") + "' ";
//                        System.out.println("SQL 2 : " + SQL2);
                        st2.execute(SQL2);

                        rsSchemeHeader.next();
                        counter++;
                    }
                }
            }

            Stmt.execute("TRUNCATE TABLE TEMP_DATABASE.L_FIN_VOUCHER_HEADER");

            Stmt.execute("INSERT INTO TEMP_DATABASE.L_FIN_VOUCHER_HEADER (COMPANY_ID,VOUCHER_NO,BOOK_CODE,HIERARCHY_ID,REMARKS,VOUCHER_DATE,VOUCHER_TYPE,EXCLUDE_IN_ADJ) SELECT 2,VOUCHER_NO,'25',1264,VOUCHER_REMARKS,VOUCHER_DATE,9,1 FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY ");

            Stmt.execute("TRUNCATE TABLE TEMP_DATABASE.L_FIN_VOUCHER_DETAIL");

            String detailInsertQuery = "";

            rsResultSet1 = Stmt.executeQuery("SELECT * FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY ");
            int srno = 0;
            rsResultSet1.first();
            while (!rsResultSet1.isAfterLast() && rsResultSet1.getRow() > 0) {
                srno = 1;
                detailInsertQuery = "INSERT INTO TEMP_DATABASE.L_FIN_VOUCHER_DETAIL (COMPANY_ID,VOUCHER_NO,SR_NO,EFFECT,MAIN_ACCOUNT_CODE,"
                        + "SUB_ACCOUNT_CODE,AMOUNT,MODULE_ID,REF_COMPANY_ID,IS_DEDUCTION,VALUE_DATE,LINK_NO) ";

                if (rsResultSet1.getDouble("JVE_TOTAL_EARNING_WO_HRA") > 0) {
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_STAFF") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                        detailInsertQuery += "SELECT 2,VOUCHER_NO," + srno + ",'D',413019,'',"
                                + "JVE_TOTAL_EARNING_WO_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_WORKER") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_WORKER")) {
                        detailInsertQuery += "SELECT 2,VOUCHER_NO," + srno + ",'D',414010,'',"
                                + "JVE_TOTAL_EARNING_WO_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_RETAINER") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_RETAINER")) {
                        detailInsertQuery += "SELECT 2,VOUCHER_NO," + srno + ",'D',441032,'',"
                                + "JVE_TOTAL_EARNING_WO_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                }

                if (rsResultSet1.getDouble("JVE_TOTAL_HRA") > 0) {
                    srno = srno + 1;
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_STAFF") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                        detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'D',413033,'',"
                                + "JVE_TOTAL_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_WORKER") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_WORKER")) {
                        detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'D',414027,'',"
                                + "JVE_TOTAL_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                }

                if (rsResultSet1.getDouble("JVE_MED_EDU_HOT_AMT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'D',419046,'',"
                            + "JVE_MED_EDU_HOT_AMT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVE_ARREAR_MEDICAL") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'D',419046,'',"
                            + "JVE_ARREAR_MEDICAL,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVE_ARREAR_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'D',441032,'',"
                            + "JVE_ARREAR_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JV_NET_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132067,'',"
                            + "JV_NET_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_PF_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127059,'',"
                            + "JVD_PF_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_ESIC_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127028,'',"
                            + "JVD_ESIC_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_PROF_TAX_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127011,'',"
                            + "JVD_PROF_TAX_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_TDS") > 0) {
                    srno = srno + 1;
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_STAFF") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                        detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127170,'',"
                                + "JVD_TDS,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet1.getString("JV_CATEGORY").trim().equals("BRD_RETAINER") || rsResultSet1.getString("JV_CATEGORY").trim().equals("ANK_RETAINER")) {
                        detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127172,'',"
                                + "JVD_TDS,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                    }
                }

                if (rsResultSet1.getDouble("JVD_RENT_DEDUCTION") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',315070,'',"
                            + "JVD_RENT_DEDUCTION,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_GLWF_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127066,'',"
                            + "JVD_GLWF_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_REVENUE_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',450227,'',"
                            + "JVD_REVENUE_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_SOCIAL_PAY_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132525,'',"
                            + "JVD_SOCIAL_PAY_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_SOCIETY_DED") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132525,'',"
                            + "JVD_SOCIETY_DED,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_HDFC_PAY_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132563,'',"
                            + "JVD_HDFC_PAY_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_MLWF_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',127066,'',"
                            + "JVD_MLWF_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_UNION_FEE") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132123,'',"
                            + "JVD_UNION_FEE,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_UNION_LEVY") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132123,'',"
                            + "JVD_UNION_LEVY,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_LIP_AMOUNT") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',132549,'',"
                            + "JVD_LIP_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_COVID_19_PA") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',441019,'',"
                            + "JVD_COVID_19_PA,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet1.getDouble("JVD_KASAR") > 0) {
                    srno = srno + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srno + ",'C',315252,'',"
                            + "JVD_KASAR,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet1.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet1.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet1.getString("JV_CATEGORY") + "' ";
                }

//                System.out.println(detailInsertQuery);
                data.Execute(detailInsertQuery);

                rsResultSet1.next();
            }

            Stmt.execute("TRUNCATE TABLE TEMP_DATABASE.L_FIN_VOUCHER_DETAIL_EX");

            String detailEXInsertQuery = "";

            rsResultSet2 = Stmt.executeQuery("SELECT * FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY ");
            int srnoEX = 0;
            rsResultSet2.first();
            while (!rsResultSet2.isAfterLast() && rsResultSet2.getRow() > 0) {
                srnoEX = 1;
                detailEXInsertQuery = "INSERT INTO TEMP_DATABASE.L_FIN_VOUCHER_DETAIL_EX (COMPANY_ID,VOUCHER_NO,SR_NO,EFFECT,MAIN_ACCOUNT_CODE,"
                        + "SUB_ACCOUNT_CODE,AMOUNT,MODULE_ID,REF_COMPANY_ID,IS_DEDUCTION,VALUE_DATE,LINK_NO) ";

                if (rsResultSet2.getDouble("JVE_TOTAL_EARNING_WO_HRA") > 0) {
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_STAFF") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                        detailEXInsertQuery += "SELECT 2,VOUCHER_NO," + srnoEX + ",'D',413019,'',"
                                + "JVE_TOTAL_EARNING_WO_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_WORKER") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_WORKER")) {
                        detailEXInsertQuery += "SELECT 2,VOUCHER_NO," + srnoEX + ",'D',414010,'',"
                                + "JVE_TOTAL_EARNING_WO_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_RETAINER") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_RETAINER")) {
                        detailEXInsertQuery += "SELECT 2,VOUCHER_NO," + srnoEX + ",'D',441032,'',"
                                + "JVE_TOTAL_EARNING_WO_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                }

                if (rsResultSet2.getDouble("JVE_TOTAL_HRA") > 0) {
                    srnoEX = srnoEX + 1;
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_STAFF") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                        detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'D',413033,'',"
                                + "JVE_TOTAL_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_WORKER") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_WORKER")) {
                        detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'D',414027,'',"
                                + "JVE_TOTAL_HRA,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                }

                if (rsResultSet2.getDouble("JVE_MED_EDU_HOT_AMT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'D',419046,'',"
                            + "JVE_MED_EDU_HOT_AMT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVE_ARREAR_MEDICAL") > 0) {
                    srnoEX = srnoEX + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'D',419046,'',"
                            + "JVE_ARREAR_MEDICAL,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVE_ARREAR_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'D',441019,'',"
                            + "JVE_ARREAR_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JV_NET_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',132067,'',"
                            + "JV_NET_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_PF_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127059,'',"
                            + "JVD_PF_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_ESIC_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127028,'',"
                            + "JVD_ESIC_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_PROF_TAX_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127011,'',"
                            + "JVD_PROF_TAX_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_TDS") > 0) {
                    srnoEX = srnoEX + 1;
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_STAFF") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_STAFF")) {
                        detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127170,'',"
                                + "JVD_TDS,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                    if (rsResultSet2.getString("JV_CATEGORY").trim().equals("BRD_RETAINER") || rsResultSet2.getString("JV_CATEGORY").trim().equals("ANK_RETAINER")) {
                        detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127172,'',"
                                + "JVD_TDS,0,0,0,VOUCHER_DATE,'' "
                                + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                                + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                    }
                }

                if (rsResultSet2.getDouble("JVD_RENT_DEDUCTION") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',315070,'',"
                            + "JVD_RENT_DEDUCTION,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_GLWF_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127066,'',"
                            + "JVD_GLWF_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_REVENUE_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',450227,'',"
                            + "JVD_REVENUE_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_SOCIAL_PAY_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',132525,'',"
                            + "JVD_SOCIAL_PAY_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_SOCIETY_DED") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',132525,'',"
                            + "JVD_SOCIETY_DED,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_HDFC_PAY_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',132563,'',"
                            + "JVD_HDFC_PAY_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_MLWF_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',127066,'',"
                            + "JVD_MLWF_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_UNION_FEE") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',312123,'',"
                            + "JVD_UNION_FEE,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_LIP_AMOUNT") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',132549,'',"
                            + "JVD_LIP_AMOUNT,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_COVID_19_PA") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',441019,'',"
                            + "JVD_COVID_19_PA,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

                if (rsResultSet2.getDouble("JVD_KASAR") > 0) {
                    srnoEX = srnoEX + 1;
                    detailEXInsertQuery += " UNION ALL SELECT 2,VOUCHER_NO," + srnoEX + ",'C',315252,'',"
                            + "JVD_KASAR,0,0,0,VOUCHER_DATE,'' "
                            + "FROM SDMLATTPAY.TMP_PAYROLL_MTH_JV_POSTING_SUMMARY WHERE JV_MONTH='" + rsResultSet2.getString("JV_MONTH") + "' "
                            + "AND JV_YEAR='" + rsResultSet2.getString("JV_YEAR") + "' AND JV_CATEGORY='" + rsResultSet2.getString("JV_CATEGORY") + "' ";
                }

//                System.out.println(detailEXInsertQuery);
                data.Execute(detailEXInsertQuery);

                rsResultSet2.next();
            }

            Stmt.execute("TRUNCATE TABLE TEMP_DATABASE.L_COM_DOC_DATA");

            Stmt.execute("INSERT INTO  TEMP_DATABASE.L_COM_DOC_DATA SELECT 2,89,VOUCHER_NO,NOW(),USER_ID,CASE WHEN CREATOR =1 THEN 'W' ELSE 'P'  END, CASE WHEN CREATOR =0 THEN 'A' ELSE 'C'  END,'',SR_NO,0,'','0000-00-00','0000-00-00',0,'0000-00-00'  FROM DINESHMILLS.D_COM_HIERARCHY_RIGHTS A,TEMP_DATABASE.L_FIN_VOUCHER_HEADER B WHERE B.HIERARCHY_ID =1264 AND A.HIERARCHY_ID = B.HIERARCHY_ID ");

            String sqlH = "INSERT INTO FINANCE.D_FIN_VOUCHER_HEADER SELECT * FROM TEMP_DATABASE.L_FIN_VOUCHER_HEADER";
            Stmt.execute(sqlH);

            String sqlD = "INSERT INTO FINANCE.D_FIN_VOUCHER_DETAIL SELECT * FROM TEMP_DATABASE.L_FIN_VOUCHER_DETAIL";
            Stmt.execute(sqlD);

            String sqlE = "INSERT INTO FINANCE.D_FIN_VOUCHER_DETAIL_EX SELECT * FROM TEMP_DATABASE.L_FIN_VOUCHER_DETAIL_EX";
            Stmt.execute(sqlE);

            String sqlDoc = "INSERT INTO DINESHMILLS.D_COM_DOC_DATA SELECT * FROM TEMP_DATABASE.L_COM_DOC_DATA";
            Stmt.execute(sqlDoc);

        } catch (SQLException sqe) {
            sqe.printStackTrace();
        }
    }
}
