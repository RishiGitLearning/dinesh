/*
 * frmTRmapping.java
 *
 * Created on December 14, 2007, 1:03 PM
 */

package EITLERP.Finance;

/**
 *
 * @author  root
 */

import EITLERP.* ;
import java.sql.*;
import javax.swing.* ;

public class frmExpenseCaptions extends javax.swing.JApplet {
    
    
    EITLTableModel TableModelT;
    /** Initializes the applet frmTRmapping */
    public void init() {
        setSize(627,447);
        initComponents();
        FormatGrid();
        GenerateGrid();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txtMainAccountCode = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        TableT = new javax.swing.JTable();
        cmdAdd = new javax.swing.JButton();
        cmdRemove = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        lblAccountName = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        txtCaption1 = new javax.swing.JTextField();
        txtCaption2 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        txtCaption3 = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        txtCaption4 = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        txtCaption5 = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();

        getContentPane().setLayout(null);

        jPanel1.setLayout(null);

        jPanel1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jPanel1MouseClicked(evt);
            }
        });

        jLabel2.setText("Main A/C Code");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(14, 41, 100, 20);

        txtMainAccountCode.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtMainAccountCodeFocusLost(evt);
            }
        });
        txtMainAccountCode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtMainAccountCodeKeyPressed(evt);
            }
        });

        jPanel1.add(txtMainAccountCode);
        txtMainAccountCode.setBounds(120, 43, 110, 19);

        jScrollPane1.setBorder(new javax.swing.border.EtchedBorder());
        TableT.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(TableT);

        jPanel1.add(jScrollPane1);
        jScrollPane1.setBounds(7, 202, 590, 210);

        cmdAdd.setText("Add  ");
        cmdAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdAddActionPerformed(evt);
            }
        });

        jPanel1.add(cmdAdd);
        cmdAdd.setBounds(401, 173, 90, 25);

        cmdRemove.setText("Remove");
        cmdRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdRemoveActionPerformed(evt);
            }
        });

        jPanel1.add(cmdRemove);
        cmdRemove.setBounds(495, 173, 90, 25);

        jPanel2.setLayout(null);

        jPanel2.setBackground(new java.awt.Color(0, 153, 204));
        jPanel2.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel6.setText("AMOUNT BIFURCATION CAPTIONS");
        jPanel2.add(jLabel6);
        jLabel6.setBounds(9, 8, 280, 15);

        jPanel1.add(jPanel2);
        jPanel2.setBounds(1, 2, 800, 30);

        lblAccountName.setText("...");
        jPanel1.add(lblAccountName);
        lblAccountName.setBounds(122, 66, 320, 15);

        jLabel1.setText("Caption 1 :");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(9, 98, 70, 15);

        jPanel1.add(txtCaption1);
        txtCaption1.setBounds(82, 97, 100, 19);

        jPanel1.add(txtCaption2);
        txtCaption2.setBounds(265, 98, 100, 19);

        jLabel3.setText("Caption 2 :");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(192, 99, 70, 15);

        jPanel1.add(txtCaption3);
        txtCaption3.setBounds(82, 122, 100, 19);

        jLabel4.setText("Caption 3 :");
        jPanel1.add(jLabel4);
        jLabel4.setBounds(9, 123, 70, 15);

        jPanel1.add(txtCaption4);
        txtCaption4.setBounds(267, 123, 100, 19);

        jLabel5.setText("Caption 4 :");
        jPanel1.add(jLabel5);
        jLabel5.setBounds(194, 124, 70, 15);

        jPanel1.add(txtCaption5);
        txtCaption5.setBounds(83, 147, 100, 19);

        jLabel7.setText("Caption 5 :");
        jPanel1.add(jLabel7);
        jLabel7.setBounds(10, 148, 70, 15);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(0, 0, 670, 420);

    }//GEN-END:initComponents

    private void jPanel1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jPanel1MouseClicked
        // TODO add your handling code here:
        JOptionPane.showMessageDialog(null," W "+getWidth()+" H "+getHeight());
    }//GEN-LAST:event_jPanel1MouseClicked

    private void txtMainAccountCodeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtMainAccountCodeFocusLost
        // TODO add your handling code here:
        lblAccountName.setText(clsPartyMaster.getAccountName(txtMainAccountCode.getText(), ""));
    }//GEN-LAST:event_txtMainAccountCodeFocusLost

    private void txtMainAccountCodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtMainAccountCodeKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==112) {
            LOV aList=new LOV();
            
            aList.SQL="SELECT MAIN_ACCOUNT_CODE,ACCOUNT_NAME FROM D_FIN_GL WHERE  APPROVED=1 ORDER BY ACCOUNT_NAME";
            aList.ReturnCol=1;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=2;
            aList.UseSpecifiedConn=true;
            aList.dbURL=FinanceGlobal.FinURL;
            
            if(aList.ShowLOV()) {
                txtMainAccountCode.setText(aList.ReturnVal);
            }
            
        }
        
    }//GEN-LAST:event_txtMainAccountCodeKeyPressed
    
    private void cmdRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdRemoveActionPerformed
        // TODO add your handling code here:
        if(TableT.getSelectedRow()>=0)
        {
           if(JOptionPane.showConfirmDialog(null,"Are you Sure to Remove?","Confirmation",JOptionPane.YES_NO_OPTION)==JOptionPane.YES_OPTION)
           {
           String MainCode=TableModelT.getValueByVariable("MAIN_ACCOUNT_CODE", TableT.getSelectedRow()); 
           data.Execute("DELETE FROM D_FIN_EXPENSE_CAPTIONS WHERE MAIN_ACCOUNT_CODE='"+MainCode+"'",FinanceGlobal.FinURL); 
           }
        }
        
        FormatGrid();
        GenerateGrid();
    }//GEN-LAST:event_cmdRemoveActionPerformed
    
    private void cmdAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdAddActionPerformed
        // TODO add your handling code here:
        try{
            
            if(!clsAccount.IsValidAccount(txtMainAccountCode.getText(),""))
            {
              JOptionPane.showMessageDialog(null,"Please specify valid account code");
              return; 
            }
            
            
            Connection Conn;
            Statement Stmt;
            ResultSet rsInsertTR;
            
            Conn=data.getConn(FinanceGlobal.FinURL);
            Stmt=Conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
            
            rsInsertTR =Stmt.executeQuery("SELECT * FROM D_FIN_EXPENSE_CAPTIONS");
            rsInsertTR.moveToInsertRow();
            rsInsertTR.updateLong("COMPANY_ID", EITLERPGLOBAL.gCompanyID);
            rsInsertTR.updateString("MAIN_ACCOUNT_CODE",txtMainAccountCode.getText());
            rsInsertTR.updateString("CAPTION_1",txtCaption1.getText());
            rsInsertTR.updateString("CAPTION_2",txtCaption2.getText());
            rsInsertTR.updateString("CAPTION_3",txtCaption3.getText());
            rsInsertTR.updateString("CAPTION_4",txtCaption4.getText());
            rsInsertTR.updateString("CAPTION_5",txtCaption5.getText());
            rsInsertTR.updateString("CHANGED",Integer.toString(1));
            rsInsertTR.updateString("CHANGED_DATE",EITLERPGLOBAL.getCurrentDateDB());
            rsInsertTR.updateString("CREATED_BY","Admin");
            rsInsertTR.updateString("CREATED_DATE",EITLERPGLOBAL.getCurrentDateDB());
            rsInsertTR.updateString("MODIFIED_BY","Admin");
            rsInsertTR.updateString("MODIFIED_DATE",EITLERPGLOBAL.getCurrentDateDB());
            rsInsertTR.insertRow();
            
        }
        catch(Exception e){
            e.printStackTrace();
        }
        FormatGrid();
        GenerateGrid();
    }//GEN-LAST:event_cmdAddActionPerformed
    
    
    private void FormatGrid() {
        TableT.removeAll();
        TableModelT = new EITLTableModel();
        TableT.setModel(TableModelT);
        
        TableModelT.addColumn("Main Code"); //0
        TableModelT.addColumn("Account Name"); //1
        TableModelT.addColumn("Caption 1"); //2
        TableModelT.addColumn("Caption 2"); //3
        TableModelT.addColumn("Caption 3"); //4
        TableModelT.addColumn("Caption 4"); //5
        TableModelT.addColumn("Caption 5"); //6
        
        TableModelT.SetVariable(0, "MAIN_ACCOUNT_CODE");
        TableModelT.SetVariable(1,"ACCOUNT_NAME");
        TableModelT.SetVariable(2,"CAPTION_1");
        TableModelT.SetVariable(3,"CAPTION_2");
        TableModelT.SetVariable(4,"CAPTION_3");
        TableModelT.SetVariable(5,"CAPTION_4");
        TableModelT.SetVariable(6,"CAPTION_5");
        
    }
    
    
    
    private void GenerateGrid() {
        
        try{
            
            int noOfRow = 0;
            
            ResultSet rsTR;
            rsTR =data.getResult("SELECT * FROM D_FIN_EXPENSE_CAPTIONS",FinanceGlobal.FinURL);
            rsTR.first();
            
            if(rsTR.getRow()>0) {
                Object[] rowData = new Object[7];
                
                rowData[0]=UtilFunctions.getString(rsTR,"MAIN_ACCOUNT_CODE","");
                rowData[1]=clsPartyMaster.getAccountName(UtilFunctions.getString(rsTR,"MAIN_ACCOUNT_CODE",""),"");
                rowData[2]=UtilFunctions.getString(rsTR,"CAPTION_1","");
                rowData[3]=UtilFunctions.getString(rsTR,"CAPTION_2","");
                rowData[4]=UtilFunctions.getString(rsTR,"CAPTION_3","");
                rowData[5]=UtilFunctions.getString(rsTR,"CAPTION_4","");
                rowData[6]=UtilFunctions.getString(rsTR,"CAPTION_5","");
                
                TableModelT.addRow(rowData);
            }
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable TableT;
    private javax.swing.JButton cmdAdd;
    private javax.swing.JButton cmdRemove;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblAccountName;
    private javax.swing.JTextField txtCaption1;
    private javax.swing.JTextField txtCaption2;
    private javax.swing.JTextField txtCaption3;
    private javax.swing.JTextField txtCaption4;
    private javax.swing.JTextField txtCaption5;
    private javax.swing.JTextField txtMainAccountCode;
    // End of variables declaration//GEN-END:variables
    
}
