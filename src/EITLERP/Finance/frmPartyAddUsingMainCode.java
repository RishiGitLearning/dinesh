/*
 * frmGRNFind.java
 *
 * Created on May 15, 2004, 1:35 PM
 */

package EITLERP.Finance;

/**
 *
 * @author  nrpithva
 */

/*<APPLET CODE=frmGRNFind.class HEIGHT=405 WIDTH=565></APPLET>*/

import javax.swing.*;
import java.awt.*;
import java.util.*;
import java.sql.*;
import EITLERP.*;
import EITLERP.Finance.*;


public class frmPartyAddUsingMainCode extends javax.swing.JApplet {
    
    private clsPartyMaster objParty=null;
    
    public String LastError="";
    private ResultSet rsParty = null;
    private ResultSet rsResultSet;
    private Connection Conn;
    private Statement Stmt;
    
    
    /** Initializes the applet frmGRNFind */
    public void init() {
        System.gc();
        setSize(565,300);
        initComponents();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jLabel1 = new javax.swing.JLabel();
        cmdGenerate = new javax.swing.JButton();
        cmdClear = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txtMainCode = new javax.swing.JTextField();
        txtName = new javax.swing.JTextField();
        jLabel14 = new javax.swing.JLabel();
        txtNewMainCode = new javax.swing.JTextField();
        txtNewName = new javax.swing.JTextField();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Arial", 1, 12));
        jLabel1.setText("Main Code related to new Party Add");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(6, 12, 310, 15);

        cmdGenerate.setText("Generate");
        cmdGenerate.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        cmdGenerate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdGenerateActionPerformed(evt);
            }
        });

        getContentPane().add(cmdGenerate);
        cmdGenerate.setBounds(480, 70, 70, 25);

        cmdClear.setText("Clear");
        cmdClear.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        cmdClear.setNextFocusableComponent(txtMainCode);
        cmdClear.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdClearActionPerformed(evt);
            }
        });

        getContentPane().add(cmdClear);
        cmdClear.setBounds(482, 110, 70, 25);

        jPanel1.setLayout(null);

        jPanel1.setBorder(new javax.swing.border.EtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel2.setDisplayedMnemonic('G');
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setLabelFor(txtMainCode);
        jLabel2.setText("Main Account Code");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(0, 20, 140, 15);

        txtMainCode.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtMainCodeFocusLost(evt);
            }
        });
        txtMainCode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtMainCodeKeyPressed(evt);
            }
        });

        jPanel1.add(txtMainCode);
        txtMainCode.setBounds(150, 10, 132, 19);

        txtName.setEditable(false);
        txtName.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtNameFocusLost(evt);
            }
        });
        txtName.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtNameKeyPressed(evt);
            }
        });

        jPanel1.add(txtName);
        txtName.setBounds(150, 50, 300, 19);

        jLabel14.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel14.setText("New Main Code");
        jPanel1.add(jLabel14);
        jLabel14.setBounds(0, 90, 140, 15);

        txtNewMainCode.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtNewMainCodeFocusLost(evt);
            }
        });
        txtNewMainCode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtNewMainCodeKeyPressed(evt);
            }
        });

        jPanel1.add(txtNewMainCode);
        txtNewMainCode.setBounds(150, 90, 132, 19);

        txtNewName.setEditable(false);
        jPanel1.add(txtNewName);
        txtNewName.setBounds(150, 130, 300, 19);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(6, 39, 458, 160);

    }//GEN-END:initComponents
    
    private void txtNewMainCodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNewMainCodeKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==112) {
            
            LOV aList=new LOV();
            
            aList.SQL="SELECT  MAIN_ACCOUNT_CODE,ACCOUNT_NAME FROM D_FIN_GL ORDER BY MAIN_ACCOUNT_CODE ";
            aList.ReturnCol=1;
            aList.SecondCol=2;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=2;
            aList.UseSpecifiedConn=true;
            aList.dbURL=FinanceGlobal.FinURL;
            
            if(aList.ShowLOV()) {
                txtNewMainCode.setText(aList.ReturnVal);
                txtNewName.setText(clsGL.getAccountName(EITLERPGLOBAL.gCompanyID,txtNewMainCode.getText()));
            }
        }
        
    }//GEN-LAST:event_txtNewMainCodeKeyPressed
    
    private void txtNewMainCodeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtNewMainCodeFocusLost
        // TODO add your handling code here:
        if (! txtNewMainCode.getText().trim().equals("")) {
            txtNewName.setText(clsGL.getAccountName(EITLERPGLOBAL.gCompanyID,txtNewMainCode.getText()));
        }
    }//GEN-LAST:event_txtNewMainCodeFocusLost
    
    private void txtMainCodeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtMainCodeFocusLost
        // TODO add your handling code here:
        if (! txtMainCode.getText().trim().equals("")) {
            txtName.setText(clsGL.getAccountName(EITLERPGLOBAL.gCompanyID,txtMainCode.getText()));
        }
    }//GEN-LAST:event_txtMainCodeFocusLost
    
    private void txtMainCodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtMainCodeKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==112) {
            
            LOV aList=new LOV();
            
            aList.SQL="SELECT  MAIN_ACCOUNT_CODE,ACCOUNT_NAME FROM D_FIN_GL ORDER BY MAIN_ACCOUNT_CODE ";
            aList.ReturnCol=1;
            aList.SecondCol=2;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=2;
            aList.UseSpecifiedConn=true;
            aList.dbURL=FinanceGlobal.FinURL;
            
            if(aList.ShowLOV()) {
                txtMainCode.setText(aList.ReturnVal);
                txtName.setText(clsGL.getAccountName(EITLERPGLOBAL.gCompanyID,txtMainCode.getText()));
            }
        }
        
        
    }//GEN-LAST:event_txtMainCodeKeyPressed
    
    private void txtNameFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtNameFocusLost
        // TODO add your handling code here:
        
    }//GEN-LAST:event_txtNameFocusLost
    
    private void txtNameKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNameKeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtNameKeyPressed
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
        
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdClearActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdClearActionPerformed
        // TODO add your handling code here:
        txtMainCode.setText("");
        txtName.setText("");
        txtNewMainCode.setText("");
        txtNewName.setText("");
    }//GEN-LAST:event_cmdClearActionPerformed
    
    private void cmdGenerateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdGenerateActionPerformed
        // TODO add your handling code here:
        /*String Query="",subcode = "";
        Query="SELECT * FROM D_FIN_PARTY_MASTER WHERE MAIN_ACCOUNT_CODE = '"+ txtMainCode.getText().trim() +"' ";
        rsParty = data.getResult(Query,FinanceGlobal.FinURL);
        try {
            if (rsParty.getRow() > 0) {
                rsParty.first();
                int cnt = 0;
                while (! rsParty.isAfterLast()) {
                    objParty = new clsPartyMaster();
                    subcode = UtilFunctions.getString(rsParty,"PARTY_CODE","");
                    cnt = cnt + 1;
                    
                    if(data.IsRecordExist("SELECT PARTY_CODE FROM D_FIN_PARTY_MASTER WHERE PARTY_CODE='"+ subcode +"' AND MAIN_ACCOUNT_CODE='"+txtNewMainCode.getText().trim()+"'",FinanceGlobal.FinURL)) {
                        LastError="Party with this party code and ledger code already exist.";
                        System.out.println("subcode="+ subcode + " is exist (count no= " + cnt + " )");
                    }
                    else {
                        System.out.println("subcode="+ subcode + " (count no= " + cnt + " )");
                        
                        long NewAccountID=data.getMaxID("D_FIN_PARTY_MASTER","PARTY_ID",FinanceGlobal.FinURL);
                        Conn=data.getConn(FinanceGlobal.FinURL);
                        Stmt=Conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);
                        rsResultSet=Stmt.executeQuery("SELECT * FROM D_FIN_PARTY_MASTER WHERE PARTY_ID =1");
                        
                        
                        rsResultSet.first();
                        rsResultSet.moveToInsertRow();
                        rsResultSet.updateLong("COMPANY_ID",EITLERPGLOBAL.gCompanyID);
                        
                        rsResultSet.updateLong("PARTY_ID",NewAccountID);
                        rsResultSet.updateString("PARTY_CODE",UtilFunctions.getString(rsParty,"PARTY_CODE",""));
                        rsResultSet.updateString("MAIN_ACCOUNT_CODE",txtNewMainCode.getText().trim());
                        rsResultSet.updateString("PARTY_NAME",UtilFunctions.getString(rsParty,"PARTY_NAME",""));
                        rsResultSet.updateString("SH_NAME",UtilFunctions.getString(rsParty,"SH_NAME",""));
                        rsResultSet.updateString("SH_CODE",UtilFunctions.getString(rsParty,"SH_CODE",""));
                        
                        rsResultSet.updateDouble("CREDIT_DAYS",UtilFunctions.getDouble(rsParty,"CREDIT_DAYS",0));
                        rsResultSet.updateDouble("CREDIT_LIMIT",UtilFunctions.getDouble(rsParty,"CREDIT_LIMIT",0));
                        rsResultSet.updateString("TIN_NO",UtilFunctions.getString(rsParty,"TIN_NO",""));
                        rsResultSet.updateString("TIN_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"TIN_DATE","0000-00-00")));
                        rsResultSet.updateString("CST_NO",UtilFunctions.getString(rsParty,"CST_NO",""));
                        rsResultSet.updateString("CST_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"CST_DATE","0000-00-00")));
                        rsResultSet.updateString("ECC_NO",UtilFunctions.getString(rsParty,"ECC_NO",""));
                        rsResultSet.updateString("ECC_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"ECC_DATE","0000-00-00")));
                        rsResultSet.updateString("SERVICE_TAX_NO",UtilFunctions.getString(rsParty,"SERVICE_TAX_NO",""));
                        rsResultSet.updateString("SERVICE_TAX_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"SERVICE_TAX_DATE","0000-00-00")));
                        rsResultSet.updateString("SSI_CATEGORY",UtilFunctions.getString(rsParty,"SSI_CATEGORY",""));
                        rsResultSet.updateString("SSI_NO",UtilFunctions.getString(rsParty,"SSI_NO",""));
                        rsResultSet.updateString("SSI_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"SSI_DATE","0000-00-00")));
                        rsResultSet.updateString("ESI_NO",UtilFunctions.getString(rsParty,"ESI_NO",""));
                        rsResultSet.updateString("ESI_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"ESI_DATE","0000-00-00")));
                        rsResultSet.updateString("ADDRESS",UtilFunctions.getString(rsParty,"ADDRESS",""));
                        rsResultSet.updateString("CITY",UtilFunctions.getString(rsParty,"CITY",""));
                        rsResultSet.updateString("PINCODE",UtilFunctions.getString(rsParty,"PINCODE",""));
                        rsResultSet.updateString("STATE",UtilFunctions.getString(rsParty,"STATE",""));
                        rsResultSet.updateString("COUNTRY",UtilFunctions.getString(rsParty,"COUNTRY",""));
                        rsResultSet.updateString("PHONE",UtilFunctions.getString(rsParty,"PHONE",""));
                        rsResultSet.updateString("FAX",UtilFunctions.getString(rsParty,"FAX",""));
                        rsResultSet.updateString("MOBILE",UtilFunctions.getString(rsParty,"MOBILE",""));
                        rsResultSet.updateString("EMAIL",UtilFunctions.getString(rsParty,"EMAIL",""));
                        rsResultSet.updateString("URL",UtilFunctions.getString(rsParty,"URL",""));
                        rsResultSet.updateString("REMARKS",UtilFunctions.getString(rsParty,"REMARKS",""));
                        rsResultSet.updateBoolean("BLOCKED",UtilFunctions.getBoolean(rsParty,"BLOCKED",false));
                        rsResultSet.updateString("PAN_NO",UtilFunctions.getString(rsParty,"PAN_NO",""));
                        rsResultSet.updateString("PAN_DATE",EITLERPGLOBAL.formatDateDB(UtilFunctions.getString(rsParty,"PAN_DATE","0000-00-00")));
                        rsResultSet.updateLong("HIERARCHY_ID",0);
                        rsResultSet.updateString("CREATED_BY",EITLERPGLOBAL.gLoginID);
                        rsResultSet.updateString("CREATED_DATE",EITLERPGLOBAL.getCurrentDateDB());
                        rsResultSet.updateString("MODIFIED_BY",EITLERPGLOBAL.gLoginID);
                        rsResultSet.updateString("MODIFIED_DATE",EITLERPGLOBAL.getCurrentDateDB());
                        rsResultSet.updateBoolean("CHANGED",true);
                        rsResultSet.updateString("CHANGED_DATE",EITLERPGLOBAL.getCurrentDateDB());
                        rsResultSet.updateBoolean("APPROVED",true);
                        rsResultSet.updateString("APPROVED_DATE",EITLERPGLOBAL.getCurrentDateDB());
                        rsResultSet.updateBoolean("REJECTED",false);
                        rsResultSet.updateString("REJECTED_DATE","0000-00-00");
                        rsResultSet.updateString("REJECTED_REMARKS","");
                        rsResultSet.updateBoolean("CANCELLED",false);
                        rsResultSet.insertRow();
                        
                    }
                    rsParty.next();
                }
            }
        }
        catch (Exception e) {
            e.printStackTrace();
        }*/
    }//GEN-LAST:event_cmdGenerateActionPerformed
    
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cmdClear;
    private javax.swing.JButton cmdGenerate;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JTextField txtMainCode;
    private javax.swing.JTextField txtName;
    private javax.swing.JTextField txtNewMainCode;
    private javax.swing.JTextField txtNewName;
    // End of variables declaration//GEN-END:variables
    
    
    
}
