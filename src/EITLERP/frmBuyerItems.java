/*
 * frmItemMapping.java
 *
 * Created on June 23, 2005, 12:20 PM
 */

package EITLERP;

/**
 *
 * @author  root
 */
import EITLERP.Stores.*;
import EITLERP.Purchase.*;
import javax.swing.*;
import java.awt.*;
import java.util.*;

public class frmBuyerItems extends javax.swing.JApplet {
    
    private EITLTableModel DataModel=new EITLTableModel();
    private EITLComboModel cmbItemClassModel=new EITLComboModel();
    private EITLComboModel cmbBuyerModel=new EITLComboModel();
    
    /** Initializes the applet frmItemMapping */
    public void init() {
        setSize(499,504);
        initComponents();
        GenerateGrid();
        GenerateCombo();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        jPanel2 = new javax.swing.JPanel();
        cmbBuyer = new javax.swing.JComboBox();
        jLabel3 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        cmbItemClass = new javax.swing.JComboBox();
        jLabel4 = new javax.swing.JLabel();
        txtItemID = new javax.swing.JTextField();
        cmdAdd = new javax.swing.JButton();
        cmdRemove = new javax.swing.JButton();
        
        getContentPane().setLayout(null);
        
        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });
        
        jPanel1.setLayout(null);
        
        jPanel1.setBackground(new java.awt.Color(0, 153, 255));
        jPanel1.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel1.setText("BUYERWISE ITEM ENTRY");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(7, 8, 229, 15);
        
        getContentPane().add(jPanel1);
        jPanel1.setBounds(0, 2, 501, 32);
        
        Table.setModel(new javax.swing.table.DefaultTableModel(
        new Object [][] {
            {null, null, null, null},
            {null, null, null, null},
            {null, null, null, null},
            {null, null, null, null}
        },
        new String [] {
            "Title 1", "Title 2", "Title 3", "Title 4"
        }
        ));
        jScrollPane1.setViewportView(Table);
        
        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(6, 203, 470, 266);
        
        jPanel2.setLayout(null);
        
        jPanel2.setBorder(new javax.swing.border.EtchedBorder());
        jPanel2.add(cmbBuyer);
        cmbBuyer.setBounds(94, 13, 278, 24);
        
        jLabel3.setText("Buyer");
        jPanel2.add(jLabel3);
        jLabel3.setBounds(5, 18, 91, 15);
        
        jLabel2.setText("Item Class");
        jPanel2.add(jLabel2);
        jLabel2.setBounds(7, 51, 80, 15);
        
        jPanel2.add(cmbItemClass);
        cmbItemClass.setBounds(96, 47, 90, 24);
        
        jLabel4.setText("Item Code");
        jPanel2.add(jLabel4);
        jLabel4.setBounds(8, 89, 74, 15);
        
        jPanel2.add(txtItemID);
        txtItemID.setBounds(96, 86, 124, 21);
        
        getContentPane().add(jPanel2);
        jPanel2.setBounds(4, 39, 472, 125);
        
        cmdAdd.setText("Add ");
        cmdAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdAddActionPerformed(evt);
            }
        });
        
        getContentPane().add(cmdAdd);
        cmdAdd.setBounds(294, 171, 88, 25);
        
        cmdRemove.setText("Remove");
        cmdRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdRemoveActionPerformed(evt);
            }
        });
        
        getContentPane().add(cmdRemove);
        cmdRemove.setBounds(386, 171, 88, 25);
        
    }//GEN-END:initComponents
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
        
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdRemoveActionPerformed
        // TODO add your handling code here:
        if(Table.getRowCount()>0&&Table.getSelectedRow()>=0) {
            if(JOptionPane.showConfirmDialog(null,"Are you sure you wat to delete selected record ?","Confirmation",JOptionPane.YES_NO_OPTION)==JOptionPane.YES_OPTION) {
                int SrNo=Integer.parseInt((String)Table.getValueAt(Table.getSelectedRow(), 0));
                clsBuyerItems.Delete(EITLERPGLOBAL.gCompanyID,SrNo);
                GenerateGrid();
            }
        }
    }//GEN-LAST:event_cmdRemoveActionPerformed
    
    private void cmdAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdAddActionPerformed
        // TODO add your handling code here:

        if(EITLERPGLOBAL.getCombostrCode(cmbItemClass).trim().equals("")&&txtItemID.getText().trim().equals(""))
        {
          JOptionPane.showMessageDialog(null,"Please enter item code");
          return;
        }
        clsBuyerItems ObjItem=new clsBuyerItems();
        ObjItem.setAttribute("COMPANY_ID",EITLERPGLOBAL.gCompanyID);
        ObjItem.setAttribute("BUYER",EITLERPGLOBAL.getComboCode(cmbBuyer));
        ObjItem.setAttribute("ITEM_CLASS",EITLERPGLOBAL.getCombostrCode(cmbItemClass));
        ObjItem.setAttribute("ITEM_ID",txtItemID.getText());
                
        if(clsBuyerItems.Insert(ObjItem)) {
            GenerateGrid();
        }
        else {
            JOptionPane.showMessageDialog(null,"Error occured while saving");
        }
        
    }//GEN-LAST:event_cmdAddActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable Table;
    private javax.swing.JComboBox cmbBuyer;
    private javax.swing.JComboBox cmbItemClass;
    private javax.swing.JButton cmdAdd;
    private javax.swing.JButton cmdRemove;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextField txtItemID;
    // End of variables declaration//GEN-END:variables
    
    private void FormatGrid() {
        DataModel=new EITLTableModel();
        
        Table.removeAll();
        
        Table.setModel(DataModel);
        Table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        
        DataModel.addColumn("Sr."); //0
        DataModel.addColumn("Buyer ID"); //1
        DataModel.addColumn("Buyer Name");
        DataModel.addColumn("Item Class");
        DataModel.addColumn("Item Code");
        
        DataModel.SetNumeric(0,true);
        DataModel.SetNumeric(1,true);
                
        DataModel.TableReadOnly(true);
    }
    
    
    private void GenerateGrid() {
        HashMap List=new HashMap();
        
        FormatGrid();
        
        List=clsBuyerItems.getList();
        
        for(int i=1;i<=List.size();i++) {
            clsBuyerItems ObjItem=(clsBuyerItems)List.get(Integer.toString(i));
            Object[] rowData=new Object[5];
            
            rowData[0]=Integer.toString((int)ObjItem.getAttribute("SR_NO").getVal());
            rowData[1]=Integer.toString((int)ObjItem.getAttribute("BUYER").getVal());
            rowData[2]=clsUser.getUserName(EITLERPGLOBAL.gCompanyID,(int)ObjItem.getAttribute("BUYER").getVal());
            rowData[3]=(String)ObjItem.getAttribute("ITEM_CLASS").getObj();
            rowData[4]=(String)ObjItem.getAttribute("ITEM_ID").getObj();
            
            DataModel.addRow(rowData);
        }
        
    }
    
    
    private void GenerateCombo() {
        HashMap List=new HashMap();
        
        //Generate Department Combo
        cmbItemClassModel=new EITLComboModel();
        cmbItemClass.removeAllItems();
        cmbItemClass.setModel(cmbItemClassModel);

        
        ComboData aData=new ComboData();
        aData.strCode="";
        aData.Text="All";
        cmbItemClassModel.addElement(aData);
        
        
        aData=new ComboData();
        aData.strCode="A";
        aData.Text="A";
        cmbItemClassModel.addElement(aData);
        
        
        aData=new ComboData();
        aData.strCode="B";
        aData.Text="B";
        cmbItemClassModel.addElement(aData);
        
        aData=new ComboData();
        aData.strCode="C";
        aData.Text="C";
        cmbItemClassModel.addElement(aData);
        
        
        cmbBuyerModel=new EITLComboModel();
        cmbBuyer.removeAllItems();
        cmbBuyer.setModel(cmbBuyerModel);
        
        List= (new clsUser()).getList(" WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID);
        
        for(int i=1;i<=List.size();i++) {
            clsUser ObjItem=(clsUser)List.get(Integer.toString(i));
            
            aData=new ComboData();
            aData.Code=(int)ObjItem.getAttribute("USER_ID").getVal();
            aData.Text=(String)ObjItem.getAttribute("USER_NAME").getObj();
            
            cmbBuyerModel.addElement(aData);
        }
        
        
        
        
    }
}
