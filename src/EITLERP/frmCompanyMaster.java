/*
 * frmCompanyMaster.java
 *
 * Created on March 31, 2004, 1:51 PM
 */
/*
 * @author  jadave
 */
/*
 <APPLET CODE=frmCompanyMaster.class
 HEIGHT=700
 WIDTH=600>
 </APPLET>
 */
  
package EITLERP;
import java.awt.*;
import javax.swing.*;
import java.util.*;
 
//import java.sql.*;
//import java.net.*;

public class frmCompanyMaster extends javax.swing.JApplet {

    //private ResultSet rsCompany; 
    //private Connection conn;
    //private Statement stmt;
    
    private clsCompany ObjCompany;
    private int EditMode=0;
    boolean Init;
    
    /** Creates new form frmCompanyMaster */
    public frmCompanyMaster() {        
        System.gc();
        Init = false;   
        setSize(600,700);
        try
        {  
           
           initComponents();
           
           ObjCompany = new clsCompany();           
           ObjCompany.LoadData();       
                    
           DisplayValues();                     
                   
           setButtonsEnabled();    
           setTextEnabled(false);
         }
         catch(Exception ex)
         {
              JOptionPane.showMessageDialog(null,"Error!! " + ex.getMessage() + " " + ex.getLocalizedMessage());
         }
    }

    private void DisplayValues()
    {
        txtCompanyName.setText((String)ObjCompany.getAttribute("COMPANY_NAME").getObj());
        txtAdd1.setText((String)ObjCompany.getAttribute("ADD1").getObj());
        txtAdd2.setText((String)ObjCompany.getAttribute("ADD2").getObj());  
        txtAdd3.setText((String)ObjCompany.getAttribute("ADD3").getObj());
        txtCity.setText((String)ObjCompany.getAttribute("CITY").getObj());
        txtState.setText((String)ObjCompany.getAttribute("STATE").getObj());
        txtECCNo.setText((String)ObjCompany.getAttribute("ECC_NO").getObj());
        txtECCDate.setText(EITLERPGLOBAL.formatDate((String) ObjCompany.getAttribute("ECC_DATE").getObj() ));        
    }
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jToolBar1 = new javax.swing.JToolBar();
        cmdAdd = new javax.swing.JButton();
        cmdEdit = new javax.swing.JButton();
        cmdDelete = new javax.swing.JButton();
        cmdFirst = new javax.swing.JButton();
        cmdPrevious = new javax.swing.JButton();
        cmdNext = new javax.swing.JButton();
        cmdLast = new javax.swing.JButton();
        cmdSave = new javax.swing.JButton();
        cmdCancel = new javax.swing.JButton();
        cmdClose = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        txtCompanyName = new java.awt.TextField();
        label10 = new java.awt.Label();
        txtAdd1 = new java.awt.TextField();
        label11 = new java.awt.Label();
        txtAdd2 = new java.awt.TextField();
        label12 = new java.awt.Label();
        label13 = new java.awt.Label();
        txtAdd3 = new java.awt.TextField();
        label14 = new java.awt.Label();
        txtCity = new java.awt.TextField();
        label15 = new java.awt.Label();
        txtState = new java.awt.TextField();
        label16 = new java.awt.Label();
        txtECCNo = new java.awt.TextField();
        label17 = new java.awt.Label();
        txtECCDate = new java.awt.TextField();
        
        getContentPane().setLayout(null);
        
        cmdAdd.setText("ADD");
        cmdAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdAddActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdAdd);
        
        cmdEdit.setText("EDIT");
        cmdEdit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdEditActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdEdit);
        
        cmdDelete.setText("DELETE");
        cmdDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdDeleteActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdDelete);
        
        cmdFirst.setText("|<");
        cmdFirst.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdFirstActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdFirst);
        
        cmdPrevious.setText("<<");
        cmdPrevious.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPreviousActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdPrevious);
        
        cmdNext.setText(">>");
        cmdNext.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdNextActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdNext);
        
        cmdLast.setText(">|");
        cmdLast.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdLastActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdLast);
        
        cmdSave.setText("SAVE");
        cmdSave.setEnabled(false);
        cmdSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdSaveActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdSave);
        
        cmdCancel.setText("CANCEL");
        cmdCancel.setEnabled(false);
        cmdCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdCancelActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdCancel);
        
        cmdClose.setText("CLOSE");
        cmdClose.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdCloseActionPerformed(evt);
            }
        });
        
        jToolBar1.add(cmdClose);
        
        getContentPane().add(jToolBar1);
        jToolBar1.setBounds(0, 0, 570, 40);
        
        jPanel2.setLayout(null);
        
        jPanel2.add(txtCompanyName);
        txtCompanyName.setBounds(140, 60, 160, 19);
        
        label10.setBackground(new java.awt.Color(204, 204, 204));
        label10.setText("Company Name");
        jPanel2.add(label10);
        label10.setBounds(40, 60, 96, 19);
        
        jPanel2.add(txtAdd1);
        txtAdd1.setBounds(140, 90, 160, 19);
        
        label11.setText("Address Line1");
        jPanel2.add(label11);
        label11.setBounds(50, 90, 87, 19);
        
        jPanel2.add(txtAdd2);
        txtAdd2.setBounds(140, 120, 160, 19);
        
        label12.setText("Line2");
        jPanel2.add(label12);
        label12.setBounds(95, 120, 35, 19);
        
        label13.setText("Line3");
        jPanel2.add(label13);
        label13.setBounds(90, 150, 50, 19);
        
        jPanel2.add(txtAdd3);
        txtAdd3.setBounds(140, 150, 160, 19);
        
        label14.setText("City");
        jPanel2.add(label14);
        label14.setBounds(104, 180, 30, 19);
        
        txtCity.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCityActionPerformed(evt);
            }
        });
        
        jPanel2.add(txtCity);
        txtCity.setBounds(140, 180, 160, 19);
        
        label15.setText("State");
        jPanel2.add(label15);
        label15.setBounds(100, 210, 30, 20);
        
        jPanel2.add(txtState);
        txtState.setBounds(140, 210, 160, 19);
        
        label16.setText("ECC No");
        jPanel2.add(label16);
        label16.setBounds(80, 240, 50, 20);
        
        jPanel2.add(txtECCNo);
        txtECCNo.setBounds(140, 240, 160, 19);
        
        label17.setText("ECC Date");
        jPanel2.add(label17);
        label17.setBounds(70, 270, 60, 20);
        
        jPanel2.add(txtECCDate);
        txtECCDate.setBounds(140, 270, 160, 19);
        
        getContentPane().add(jPanel2);
        jPanel2.setBounds(10, 40, 380, 500);
        
    }//GEN-END:initComponents

    private void cmdCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdCancelActionPerformed
        // Add your handling code here:
           try
           {
              ObjCompany.LoadData();                                     
              DisplayValues();                         
              setButtonsEnabled(); 
              setTextEnabled(false);
           }
           catch(Exception ex)
           {
               JOptionPane.showMessageDialog(null,"Error!! " + ObjCompany.lastError);
           }
           
    }//GEN-LAST:event_cmdCancelActionPerformed

    private void cmdLastActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdLastActionPerformed
        // Add your handling code here:
        ObjCompany.MoveLast();
        DisplayValues();
    }//GEN-LAST:event_cmdLastActionPerformed

    private void cmdEditActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdEditActionPerformed
        // Add your handling code here:
        EditMode = EITLERP.EITLERPGLOBAL.EDIT;        
        setButtonsDisabled();
        setTextEnabled(true);
        txtCompanyName.setEnabled(false);        
    }//GEN-LAST:event_cmdEditActionPerformed

    private void cmdDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdDeleteActionPerformed
        // Add your handling code here:
        boolean DeleteResult = false;
        int DeleteConfirm;
        
        DeleteConfirm = JOptionPane.showConfirmDialog(null,"Do you really want to delete this record ?","Delete Confirmation",JOptionPane.YES_NO_OPTION);
        
        if (DeleteConfirm == JOptionPane.NO_OPTION)
        {
            return;
        }
        
        DeleteResult = ObjCompany.Delete();
        
        if (DeleteResult) 
        {
                JOptionPane.showMessageDialog(null,"Record Deleted Successfully");
                DisplayValues();
        }
        else
        {
                JOptionPane.showMessageDialog(null,"Record Not Deleted!!" + ObjCompany.lastError);
        }        
    }//GEN-LAST:event_cmdDeleteActionPerformed

    private void cmdPreviousActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPreviousActionPerformed
        // Add your handling code here:
        ObjCompany.MovePrevious();
        DisplayValues();
    }//GEN-LAST:event_cmdPreviousActionPerformed

    private void cmdCloseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdCloseActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_cmdCloseActionPerformed

    private void cmdNextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdNextActionPerformed
        // Add your handling code here:
        ObjCompany.MoveNext();
        DisplayValues();
    }//GEN-LAST:event_cmdNextActionPerformed

    private void txtCityActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCityActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_txtCityActionPerformed

    private void cmdSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdSaveActionPerformed
        // Add your handling code here:
        boolean ActionResult;
        
        if (txtCompanyName.getText().trim().equals(""))
        {
            JOptionPane.showMessageDialog(null,"Please Enter Company Name");
            txtCompanyName.requestFocus();
            return;
        }
        if (EditMode == EITLERP.EITLERPGLOBAL.ADD)
        {
            ObjCompany.setAttribute("COMPANY_NAME",txtCompanyName.getText());
            ObjCompany.setAttribute("ADD1",txtAdd1.getText());
            ObjCompany.setAttribute("ADD2",txtAdd2.getText());
            ObjCompany.setAttribute("Add3",txtAdd3.getText());
            ObjCompany.setAttribute("CITY",txtCity.getText());
            ObjCompany.setAttribute("STATE",txtState.getText());
            ObjCompany.setAttribute("ECC_NO",txtECCNo.getText());
            ObjCompany.setAttribute("ECC_DATE",EITLERPGLOBAL.formatDateDB(txtECCDate.getText()));           
            ActionResult = ObjCompany.Add();
            if (ActionResult)
            {
                JOptionPane.showMessageDialog(null,"Record Added Successfully");
                setButtonsEnabled();
                setTextEnabled(false);  
     
            }
            else
            {
                JOptionPane.showMessageDialog(null,"Record Not Added!! " + ObjCompany.lastError  );
                cmdCancel.setEnabled(true);
            }
        }   
        
        if (EditMode == EITLERP.EITLERPGLOBAL.EDIT)
        {
            //ObjCompany.setAttribute("COMPANY_NAME",txtCompanyName.getText());
            ObjCompany.setAttribute("ADD1",txtAdd1.getText());
            ObjCompany.setAttribute("ADD2",txtAdd2.getText());
            ObjCompany.setAttribute("Add3",txtAdd3.getText());
            ObjCompany.setAttribute("CITY",txtCity.getText());
            ObjCompany.setAttribute("STATE",txtState.getText());
            ObjCompany.setAttribute("ECC_NO",txtECCNo.getText());
            ObjCompany.setAttribute("ECC_DATE",EITLERPGLOBAL.formatDateDB(txtECCDate.getText()));           
            ActionResult = ObjCompany.Edit();
            if (ActionResult)
            {
                JOptionPane.showMessageDialog(null,"Record Edited Successfully");
                setButtonsEnabled();
                setTextEnabled(false); 
            }
            else
            {
                JOptionPane.showMessageDialog(null,"Record Not Edited!! " + ObjCompany.lastError  );
                cmdCancel.setEnabled(true);
            }
         }        
                 
    }//GEN-LAST:event_cmdSaveActionPerformed

    private void cmdFirstActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdFirstActionPerformed
        // Add your handling code here:
        ObjCompany.MoveFirst();
        DisplayValues();
    }//GEN-LAST:event_cmdFirstActionPerformed

    private void cmdAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdAddActionPerformed
        // Add your handling code here:
         EditMode = EITLERP.EITLERPGLOBAL.ADD;        
         setButtonsDisabled();
         setTextEnabled(true);
         txtCompanyName.setText("");
         txtAdd1.setText("");
         txtAdd2.setText("");  
         txtAdd3.setText("");
         txtCity.setText("");
         txtState.setText("");
         txtECCNo.setText("");
         txtECCDate.setText("");                    
    }//GEN-LAST:event_cmdAddActionPerformed
    private void setTextEnabled(boolean setIt)
    {
        txtCompanyName.setEnabled(setIt);
        txtAdd1.setEnabled(setIt);
        txtAdd2.setEnabled(setIt);
        txtAdd3.setEnabled(setIt);
        txtCity.setEnabled(setIt);
        txtState.setEnabled(setIt);
        txtECCNo.setEnabled(setIt);
        txtECCDate.setEnabled(setIt);
    }  
    
    
    private void setButtonsDisabled()
    {
        cmdAdd.setEnabled(false);
        cmdEdit.setEnabled(false);
        cmdDelete.setEnabled(false);
        cmdFirst.setEnabled(false);
        cmdPrevious.setEnabled(false);
        cmdNext.setEnabled(false);
        cmdLast.setEnabled(false);
        
        cmdSave.setEnabled(true);
        cmdCancel.setEnabled(true);
        cmdClose.setEnabled(true);
    }
    private void setButtonsEnabled()
    {
        cmdAdd.setEnabled(true);
        cmdEdit.setEnabled(true);
        cmdDelete.setEnabled(true);
        cmdFirst.setEnabled(true);
        cmdPrevious.setEnabled(true);
        cmdNext.setEnabled(true);
        cmdLast.setEnabled(true);
        
        cmdSave.setEnabled(false);
        cmdCancel.setEnabled(false);
       
        cmdClose.setEnabled(true);        
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cmdAdd;
    private javax.swing.JButton cmdCancel;
    private javax.swing.JButton cmdClose;
    private javax.swing.JButton cmdDelete;
    private javax.swing.JButton cmdEdit;
    private javax.swing.JButton cmdFirst;
    private javax.swing.JButton cmdLast;
    private javax.swing.JButton cmdNext;
    private javax.swing.JButton cmdPrevious;
    private javax.swing.JButton cmdSave;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JToolBar jToolBar1;
    private java.awt.Label label10;
    private java.awt.Label label11;
    private java.awt.Label label12;
    private java.awt.Label label13;
    private java.awt.Label label14;
    private java.awt.Label label15;
    private java.awt.Label label16;
    private java.awt.Label label17;
    private java.awt.TextField txtAdd1;
    private java.awt.TextField txtAdd2;
    private java.awt.TextField txtAdd3;
    private java.awt.TextField txtCity;
    private java.awt.TextField txtCompanyName;
    private java.awt.TextField txtECCDate;
    private java.awt.TextField txtECCNo;
    private java.awt.TextField txtState;
    // End of variables declaration//GEN-END:variables

}
