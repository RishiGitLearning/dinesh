/*
 * frmRptGRNInfo.java
 *
 * Created on April 16, 2008, 12:01 PM
 */

package EITLERP.FeltSales.PackingSlipReport;

/**
 *
 * @author  root
 */
import EITLERP.*;
import EITLERP.Finance.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.net.*;
import java.util.*;
import TReportWriter.*;
import java.util.HashMap;
import java.sql.Connection;
import java.sql.Statement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.net.URL;
import javax.swing.JOptionPane;
import java.io.*;
import java.sql.ResultSet;
import javax.swing.JTable;
import EITLERP.FeltSales.PackingSlipReport.ReportRegister;



public class frmRptPackingSlipReport extends javax.swing.JApplet {
    
    private EITLComboModel cmbReceiptTypeModel;
    private EITLComboModel cmbReportTypeModel;
    private TReportEngine objEngine=new TReportEngine();
    private TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
    private EITLTableCellRenderer RowFormat=new EITLTableCellRenderer();
    //private clsExcelExporter exp = new clsExcelExporter();
    EITLTableModel DataModel= new EITLTableModel();
  //  private TReportEngine objEngine=new TReportEngine();
    
    /** Initializes the applet frmRptGRNInfo */
    
    public void init() {
       // setSize(424,264);
        setSize(500,250);
        initComponents();
        
        
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel3 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        txtFromDate = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        txtToDate = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });
        getContentPane().setLayout(null);

        jPanel3.setBackground(new java.awt.Color(0, 153, 204));
        jPanel3.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel3.setLayout(null);

        jLabel6.setFont(new java.awt.Font("DejaVu Sans", 1, 13)); // NOI18N
        jLabel6.setText("Felt Packing Slip Report");
        jPanel3.add(jLabel6);
        jLabel6.setBounds(10, 0, 320, 30);

        getContentPane().add(jPanel3);
        jPanel3.setBounds(0, 0, 450, 30);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("From Date :");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(50, 40, 90, 20);

        txtFromDate.setColumns(10);
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(150, 40, 110, 27);

        jLabel3.setText("To Date :");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(270, 40, 60, 20);

        txtToDate.setColumns(10);
        getContentPane().add(txtToDate);
        txtToDate.setBounds(330, 40, 120, 30);

        jLabel1.setText("Period");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(10, 40, 50, 20);

        jButton2.setText("EXCISE COPY");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton2);
        jButton2.setBounds(240, 120, 170, 30);

        jButton3.setText("Daily Report");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton3);
        jButton3.setBounds(160, 160, 130, 30);

        jButton4.setText("CUSTOMER COPY");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton4);
        jButton4.setBounds(60, 80, 150, 30);

        jButton5.setText("FELT SALES COPY");
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton5);
        jButton5.setBounds(60, 120, 150, 30);

        jButton6.setText("WAREHOUSE COPY");
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton6);
        jButton6.setBounds(240, 80, 170, 30);
    }// </editor-fold>//GEN-END:initComponents
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
    PreviewReport3();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
    DailyReport();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
    PreviewReport();        // TODO add your handling code here:    // TODO add your handling code here:
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
    PreviewReport1();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
    PreviewReport2();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton6ActionPerformed
        
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtToDate;
    // End of variables declaration//GEN-END:variables
    
     private boolean Validate() {
        //Form level validations
        
        if(txtFromDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter from date");
            return false;
        } else if(!EITLERPGLOBAL.isDate(txtFromDate.getText())) {
            JOptionPane.showMessageDialog(null,"Invalid From Date in DD/MM/YYYY format.");
            return false;
        }
        
        if(txtToDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(null,"Please enter To date");
            return false;
        } else if(!EITLERPGLOBAL.isDate(txtToDate.getText())) {
            JOptionPane.showMessageDialog(null,"Invalid To Date in DD/MM/YYYY format.");
            return false;
        }
        
        return true;
    }
    
    @SuppressWarnings("UnusedAssignment")
   private void ReportShow() {
        
        try {
            
            
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            
            objReportData.AddColumn("PKG_BALE_NO");
            objReportData.AddColumn("PKG_BALE_DATE");
            objReportData.AddColumn("PKG_PARTY_NAME");
            objReportData.AddColumn("PKG_PARTY_CODE");
            objReportData.AddColumn("PKG_ORDER_NO");
            objReportData.AddColumn("PKG_ORDER_DATE");
            objReportData.AddColumn("PKG_TRANSPORT_MODE");
            objReportData.AddColumn("PKG_STATION");
            objReportData.AddColumn("PKG_PIECE_NO");
            objReportData.AddColumn("PKG_LENGTH");
            objReportData.AddColumn("PKG_WIDTH");
            objReportData.AddColumn("PKG_GSM");
            objReportData.AddColumn("PKG_WEIGHT");
            objReportData.AddColumn("PKG_SQM");
            objReportData.AddColumn("PKG_MCN_POSITION_DESC");
            objReportData.AddColumn("PKG_SYN_PER");
            objReportData.AddColumn("PKG_STYLE");
            objReportData.AddColumn("PKG_PRODUCT_CODE");
            objReportData.AddColumn("PKG_BOX_SIZE");
            
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("PKG_BALE_NO","");
            objOpeningRow.setValue("PKG_BALE_DATE","");
            objOpeningRow.setValue("PKG_PARTY_NAME","");
            objOpeningRow.setValue("PKG_PARTY_CODE","");
            objOpeningRow.setValue("PKG_ORDER_NO","");
            objOpeningRow.setValue("PKG_ORDER_DATE","");
            objOpeningRow.setValue("PKG_TRANSPORT_MODE","");
            objOpeningRow.setValue("PKG_STATION","");
            objOpeningRow.setValue("PKG_PIECE_NO","");
            objOpeningRow.setValue("PKG_LENGTH","");
            objOpeningRow.setValue("PKG_WIDTH","");
            objOpeningRow.setValue("PKG_GSM","");
            objOpeningRow.setValue("PKG_WEIGHT","");
            objOpeningRow.setValue("PKG_SQM","");
            objOpeningRow.setValue("PKG_MCN_POSITION_DESC","");
            objOpeningRow.setValue("PKG_SYN_PER","");
            objOpeningRow.setValue("PKG_PRODUCT_CODE","");
            objOpeningRow.setValue("PKG_BOX_SIZE","");
            
            //String strSQL="SELECT A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,PKG_TRANSPORT_MODE, A.PKG_STATION,A.PKG_BOX_SIZE, B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH,B.PKG_GSM,B.PKG_SQM,B.PKG_ORDER_NO, B.PKG_ORDER_DATE,B.PKG_MCN_POSITION_DESC,B.PKG_STYLE,B.PKG_SYN_PER,B.PKG_PRODUCT_CODE FROM PRODUCTION.FELT_PKG_SLIP_HEADER A,PRODUCTION.FELT_PKG_SLIP_DETAIL B WHERE  A.PKG_BALE_DATE>='"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"' AND A.PKG_BALE_DATE<='"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"' AND A.PKG_BALE_NO>='"+ txtFromBaleNo.getText()+"' AND A.PKG_BALE_NO<='"+ txtToDate.getText()+"' GROUP BY A.PKG_PARTY_CODE";
           
            String query_str=" ";

            
            if(!"".equals(txtFromDate.getText()))
            {
                query_str = " AND A.PKG_BALE_DATE>='"+ EITLERPGLOBAL.formatDateDB(txtFromDate.getText())+"'";
            }
            
            if(!"".equals(txtToDate.getText()))
            {
                query_str =  query_str +" AND A.PKG_BALE_DATE<='"+ EITLERPGLOBAL.formatDateDB(txtToDate.getText())+"'";
            }

//            if(!"".equals(txtFromBaleNo.getText()))
//            {
//                query_str = query_str +" AND A.PKG_BALE_NO>='"+ txtFromBaleNo.getText()+"'";
//            }
//            
//            if(!"".equals(txtToBaleNo.getText()))
//            {
//                query_str =  query_str +" AND A.PKG_BALE_NO<='"+ txtToBaleNo.getText()+"'";
//            }
            
            String strSQL="SELECT A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,PKG_TRANSPORT_MODE, A.PKG_STATION,A.PKG_BOX_SIZE, B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH,B.PKG_GSM,B.PKG_WEIGHT,B.PKG_SQM,B.PKG_ORDER_NO, B.PKG_ORDER_DATE,B.PKG_MCN_POSITION_DESC,B.PKG_STYLE,B.PKG_SYN_PER,B.PKG_PRODUCT_CODE FROM PRODUCTION.FELT_PKG_SLIP_HEADER A,PRODUCTION.FELT_PKG_SLIP_DETAIL B WHERE A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_BALE_DATE=B.PKG_BALE_DATE AND A.PKG_BALE_NO!='' "+query_str+" AND A.APPROVED=1 AND A.CANCELED=0 ";
            
            System.out.println(strSQL);
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();
                    
                    objRow.setValue("PKG_BALE_NO",UtilFunctions.getString(rsTmp,"PKG_BALE_NO",""));
                    objRow.setValue("PKG_BALE_DATE",UtilFunctions.getString(rsTmp,"PKG_BALE_DATE",""));
                    objRow.setValue("PKG_PARTY_NAME",UtilFunctions.getString(rsTmp,"PKG_PARTY_NAME",""));
                    objRow.setValue("PKG_PARTY_CODE",UtilFunctions.getString(rsTmp,"PKG_PARTY_CODE",""));
                    objRow.setValue("PKG_ORDER_NO",UtilFunctions.getString(rsTmp,"PKG_ORDER_NO",""));
                    objRow.setValue("PKG_ORDER_DATE",UtilFunctions.getString(rsTmp,"PKG_ORDER_DATE",""));
                    objRow.setValue("PKG_TRANSPORT_MODE",UtilFunctions.getString(rsTmp,"PKG_TRANSPORT_MODE",""));
                    objRow.setValue("PKG_STATION",UtilFunctions.getString(rsTmp,"PKG_STATION",""));
                    objRow.setValue("PKG_PIECE_NO",UtilFunctions.getString(rsTmp,"PKG_PIECE_NO",""));
                    objRow.setValue("PKG_LENGTH",UtilFunctions.getString(rsTmp,"PKG_LENGTH",""));
                    objRow.setValue("PKG_WIDTH",UtilFunctions.getString(rsTmp,"PKG_WIDTH",""));
                    objRow.setValue("PKG_WEIGHT",UtilFunctions.getString(rsTmp,"PKG_WEIGHT",""));
                    objRow.setValue("PKG_GSM",UtilFunctions.getString(rsTmp,"PKG_GSM",""));
                    objRow.setValue("PKG_SQM",UtilFunctions.getString(rsTmp,"PKG_SQM",""));
                    objRow.setValue("PKG_MCN_POSITION_DESC",UtilFunctions.getString(rsTmp,"PKG_MCN_POSITION_DESC",""));
                    objRow.setValue("PKG_SYN_PER",UtilFunctions.getString(rsTmp,"PKG_SYN_PER",""));
                    objRow.setValue("PKG_PRODUCT_CODE",UtilFunctions.getString(rsTmp,"PKG_PRODUCT_CODE",""));
                    objRow.setValue("PKG_BOX_SIZE",UtilFunctions.getString(rsTmp,"PKG_BOX_SIZE",""));
                    
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
                }
            }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            
            HashMap Parameters=new HashMap();
            Parameters.put("FROM_DATE",txtFromDate.getText().trim());
            Parameters.put("TO_DATE",txtToDate.getText().trim());
//            Parameters.put("BALE_NO",txtFromBaleNo.getText().trim());
//            Parameters.put("BALE_NO",txtToBaleNo.getText().trim());
            //Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/Production/rptPackingSlip.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
  
    private void PreviewReport() {
        String FromDate =EITLERPGLOBAL.formatDateDB(txtFromDate.getText());
        String ToDate =EITLERPGLOBAL.formatDateDB(txtToDate.getText());
//        String BaleFrom =txtFromBaleNo.getText().trim();
//        String BaleTo =txtToBaleNo.getText().trim();
        Connection Conn = null;
        Statement st = null;
        ResultSet rs = null;
        try {
            Conn = data.getConn();
            st = Conn.createStatement();

            HashMap parameterMap = new HashMap();

            ReportRegister rpt = new ReportRegister(parameterMap, Conn);
            parameterMap.put("CONTEXT","http://200.0.0.227:8080/SDMLERP/");

            String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_BALE_DATE>='"+FromDate+"' AND A.PKG_BALE_DATE<='"+ToDate+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_BALE_DATE=B.PKG_BALE_DATE AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0";
            

            rpt.setReportName("/EITLERP/FeltSales/FeltPacking/Packing.jrxml", 1, strSQL); //productlist is the name of my jasper file.
            rpt.callReport();

        } catch (Exception e) {
            e.printStackTrace();
        } 
    }

    private void PreviewReport1() {
        //String partycode = txtPartyCode.getText().trim();
        String FromDate =EITLERPGLOBAL.formatDateDB(txtFromDate.getText());
        String ToDate =EITLERPGLOBAL.formatDateDB(txtToDate.getText());
//        String BaleTo =txtToBaleNo.getText().trim();
        Connection Conn = null;
        Statement st = null;
        ResultSet rs = null;
        try {
            Conn = data.getConn();
            st = Conn.createStatement();

            HashMap parameterMap = new HashMap();

            ReportRegister rpt = new ReportRegister(parameterMap, Conn);
            parameterMap.put("CONTEXT","http://200.0.0.227:8080/SDMLERP/");

           // String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_DP_NO='"+txtDpNo.getText().trim()+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0";
           String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_BALE_DATE>='"+FromDate+"' AND A.PKG_BALE_DATE<='"+ToDate+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_BALE_DATE=B.PKG_BALE_DATE AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0"; 

            rpt.setReportName("/EITLERP/FeltSales/FeltPacking/Packing1.jrxml", 1, strSQL); //productlist is the name of my jasper file.
            rpt.callReport();

        } catch (Exception e) {
            e.printStackTrace();
        } 
    }
    
    private void PreviewReport2() {
       
        String FromDate =EITLERPGLOBAL.formatDateDB(txtFromDate.getText());
        String ToDate =EITLERPGLOBAL.formatDateDB(txtToDate.getText());

        Connection Conn = null;
        Statement st = null;
        ResultSet rs = null;
        try {
            Conn = data.getConn();
            st = Conn.createStatement();

            HashMap parameterMap = new HashMap();

            ReportRegister rpt = new ReportRegister(parameterMap, Conn);
            parameterMap.put("CONTEXT","http://200.0.0.227:8080/SDMLERP/");

           // String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_DP_NO='"+txtDpNo.getText().trim()+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0";
            String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_BALE_DATE>='"+FromDate+"' AND A.PKG_BALE_DATE<='"+ToDate+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_BALE_DATE=B.PKG_BALE_DATE AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0";

            rpt.setReportName("/EITLERP/FeltSales/FeltPacking/Packing2.jrxml", 1, strSQL); //productlist is the name of my jasper file.
            rpt.callReport();

        } catch (Exception e) {
            e.printStackTrace();
        } 
    }
    
    private void PreviewReport3() {
        
        String FromDate =EITLERPGLOBAL.formatDateDB(txtFromDate.getText());
        String ToDate =EITLERPGLOBAL.formatDateDB(txtToDate.getText());
        
        Connection Conn = null;
        Statement st = null;
        ResultSet rs = null;
        try {
            Conn = data.getConn();
            st = Conn.createStatement();

            HashMap parameterMap = new HashMap();

            ReportRegister rpt = new ReportRegister(parameterMap, Conn);
            parameterMap.put("CONTEXT","http://200.0.0.227:8080/SDMLERP/");

          // String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_DP_NO='"+txtDpNo.getText().trim()+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0";
            String strSQL = "SELECT C.ADDRESS1,D.POSITION_DESC,A.PKG_BALE_NO,A.PKG_BALE_DATE,A.PKG_TRANSACTION_CODE,A.PKG_TRANSPORT_MODE,A.PKG_BOX_SIZE,A.PKG_PARTY_CODE,A.PKG_PARTY_NAME,A.PKG_STATION,B.PKG_PIECE_NO,B.PKG_LENGTH,B.PKG_WIDTH, B.PKG_WEIGHT, B.PKG_GSM, B.PKG_SYN_PER, B.PKG_STYLE,B.PKG_PRODUCT_CODE,B.PKG_PRODUCT_DESC, B.PKG_MCN_POSITION_DESC, B.PKG_ORDER_NO,B.PKG_SQM,B.PKG_ORDER_DATE,B.PKG_MACHINE_NO,B.PKG_PO_NO,B.PKG_PO_DATE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL B,PRODUCTION.FELT_PKG_SLIP_HEADER A,DINESHMILLS.D_SAL_PARTY_MASTER C,PRODUCTION.FELT_MACHINE_POSITION_MST D WHERE D.POSITION_NO=B.PKG_MCN_POSITION_DESC AND A.PKG_BALE_DATE>='"+FromDate+"' AND A.PKG_BALE_DATE<='"+ToDate+"' AND A.PKG_BALE_NO=B.PKG_BALE_NO AND A.PKG_BALE_DATE=B.PKG_BALE_DATE AND A.PKG_PARTY_CODE=C.PARTY_CODE AND A.APPROVED=1 AND A.CANCELED=0";

            rpt.setReportName("/EITLERP/FeltSales/FeltPacking/Packing3.jrxml", 1, strSQL); //productlist is the name of my jasper file.
            rpt.callReport();

        } catch (Exception e) {
            e.printStackTrace();
        } 
    }
    
    private void DailyReport() {
        String FromDate =EITLERPGLOBAL.formatDateDB(txtFromDate.getText());
        String ToDate =EITLERPGLOBAL.formatDateDB(txtToDate.getText());
//        String BaleFrom =txtFromBaleNo.getText().trim();
//        String BaleTo =txtToBaleNo.getText().trim();
        Connection Conn = null;
        Statement st = null;
        ResultSet rs = null;
        try {
            Conn = data.getConn();
            st = Conn.createStatement();

            HashMap parameterMap = new HashMap();
            
            parameterMap.put("RUNDATE", EITLERPGLOBAL.getCurrentDate() + " " + EITLERPGLOBAL.getCurrentTime());
            
            ReportRegister rpt = new ReportRegister(parameterMap, Conn);

            String strSQL = "SELECT B.PKG_BALE_DATE,PKG_PRODUCT_CODE,A.PKG_PIECE_NO,A.PKG_LENGTH,B.PKG_BALE_NO,B.PKG_PARTY_CODE FROM PRODUCTION.FELT_PKG_SLIP_DETAIL A,PRODUCTION.FELT_PKG_SLIP_HEADER B WHERE B.PKG_BALE_NO=A.PKG_BALE_NO AND A.PKG_BALE_DATE=B.PKG_BALE_DATE AND B.PKG_BALE_DATE>='"+FromDate+"' AND B.PKG_BALE_DATE<='"+ToDate+"' AND B.APPROVED=1 AND B.CANCELED=0";
            

            rpt.setReportName("/EITLERP/FeltSales/FeltPacking/DailyPacking.jrxml", 1, strSQL); //productlist is the name of my jasper file.
            rpt.callReport();

        } catch (Exception e) {
            e.printStackTrace();
        } 
    }
}
