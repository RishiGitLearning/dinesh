/*
 * frmChangePassword.java
 *
 * Created on July 3, 2004, 3:36 PM
 */
package EITLERP.FeltSales.WVG_Prod_Loom_WVR;

import SDMLATTPAY.leave.*;
import SDMLATTPAY.AdvanceSearch.*;
import EITLERP.*;
import SDMLATTPAY.Employee.clsMaster;
import java.awt.Color;
import java.awt.Component;
import java.awt.Desktop;
import java.io.File;
import java.sql.*;
import javax.swing.*;
import java.text.DateFormat;
import java.text.DecimalFormat;
//import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.HashMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumnModel;
//import EITLERP.Sales.clsExcelExporter;

/*<APPLET CODE=frmChangePassword HEIGHT=200 WIDTH=430></APPLET>*/
/**
 *
 * @author Daxesh Prajapati
 */
public class FrmRptWeaverIncentive extends javax.swing.JApplet {

    private clsExcel_Exporter exp = new clsExcel_Exporter();

    private EITLTableModel DataModel = new EITLTableModel();

    private EITLComboModel modelDept = new EITLComboModel();
    private EITLComboModel modelShift = new EITLComboModel();
    private EITLComboModel modelMainCategory = new EITLComboModel();
    private EITLComboModel modelCategory = new EITLComboModel();
    public EITLERP.FeltSales.Reports.clsExcelExporter exprt = new EITLERP.FeltSales.Reports.clsExcelExporter();

    //GenerateInvoiceParameterModificationCombo();
    /**
     * Initializes the applet frmChangePassword
     */
    public void init() {
        initComponents();
        setSize(1000, 750);

        jLabel1.setForeground(Color.WHITE);
        
        cmbStatus.setVisible(false);
        
        
        cmbDept.setVisible(false);
        cmbMonth.setVisible(false);
        txtYear.setVisible(false);
        rbtnLCDetail.setVisible(false);
        rbtnLCSummary.setVisible(false);
        //lblDate.setVisible(false);
        //lblDate1.setVisible(false);
        btnClear.setVisible(false);
        lblMonthCmb.setVisible(false);
        lblYearCmb.setVisible(false);
        lblDeptCmb.setVisible(false);
        
        
        
        txtFromDate.setText("");
        txtToDate.setText("");
        //txtFromDate.setEnabled(false);
        //txtToDate.setEnabled(false);
        
        //cmbMonth.setSelectedIndex(EITLERPGLOBAL.getCurrentMonth());
        //txtYear.setText(EITLERPGLOBAL.getCurrentYear()+"");

        //GenerateDeptCombo();
        //GenerateShiftCombo();
        //GenerateMainCategoryCombo();
        
        
    }

    /**
     * This method is called from within the init() method to initialize the
     * form. WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        ExporttoExcelFileChooser = new javax.swing.JFileChooser();
        file1 = new javax.swing.JFileChooser();
        CoffRokadiBtnGrp = new javax.swing.ButtonGroup();
        LCBtnGrp = new javax.swing.ButtonGroup();
        GatePassBtnGrp = new javax.swing.ButtonGroup();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        lblMonthCmb = new javax.swing.JLabel();
        lblDate = new javax.swing.JLabel();
        txtFromDate = new javax.swing.JTextField();
        cmbMonth = new javax.swing.JComboBox();
        TabList = new javax.swing.JTabbedPane();
        LateComing = new javax.swing.JPanel();
        btnLeaveApplicationView = new javax.swing.JButton();
        rbtnLCDetail = new javax.swing.JRadioButton();
        rbtnLCSummary = new javax.swing.JRadioButton();
        lblperiod = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        lblDate2 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        btnClear = new javax.swing.JButton();
        lblYearCmb = new javax.swing.JLabel();
        lblDeptCmb = new javax.swing.JLabel();
        txtYear = new javax.swing.JTextField();
        cmbShift = new javax.swing.JComboBox();
        jLabel27 = new javax.swing.JLabel();
        jScrollPane25 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        btnEmpMstETE = new javax.swing.JButton();
        lblDate1 = new javax.swing.JLabel();
        txtToDate = new javax.swing.JTextField();
        cmbStatus = new javax.swing.JComboBox();
        cmbDept = new javax.swing.JComboBox();

        getContentPane().setLayout(null);

        jLabel1.setBackground(new java.awt.Color(0, 102, 153));
        jLabel1.setText("Weaver Incentive");
        jLabel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel1.setOpaque(true);
        getContentPane().add(jLabel1);
        jLabel1.setBounds(0, 2, 1000, 25);

        jLabel2.setBackground(new java.awt.Color(0, 102, 153));
        jLabel2.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel2.setOpaque(true);
        getContentPane().add(jLabel2);
        jLabel2.setBounds(0, 120, 1000, 10);

        lblMonthCmb.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblMonthCmb.setText("Month : ");
        getContentPane().add(lblMonthCmb);
        lblMonthCmb.setBounds(680, 60, 60, 20);

        lblDate.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblDate.setText("From Date : ");
        getContentPane().add(lblDate);
        lblDate.setBounds(10, 70, 110, 20);

        txtFromDate = new EITLERP.FeltSales.common.DatePicker.DateTextFieldAdvanceSearch();
        getContentPane().add(txtFromDate);
        txtFromDate.setBounds(130, 70, 100, 20);

        cmbMonth.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Select", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12" }));
        getContentPane().add(cmbMonth);
        cmbMonth.setBounds(740, 60, 100, 20);

        LateComing.setLayout(null);

        btnLeaveApplicationView.setText("View");
        btnLeaveApplicationView.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLeaveApplicationViewActionPerformed(evt);
            }
        });
        LateComing.add(btnLeaveApplicationView);
        btnLeaveApplicationView.setBounds(860, 0, 100, 30);

        LCBtnGrp.add(rbtnLCDetail);
        rbtnLCDetail.setSelected(true);
        rbtnLCDetail.setText("Detail");
        rbtnLCDetail.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                rbtnLCDetailItemStateChanged(evt);
            }
        });
        LateComing.add(rbtnLCDetail);
        rbtnLCDetail.setBounds(30, 10, 110, 20);

        LCBtnGrp.add(rbtnLCSummary);
        rbtnLCSummary.setText("Summary");
        rbtnLCSummary.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                rbtnLCSummaryItemStateChanged(evt);
            }
        });
        rbtnLCSummary.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rbtnLCSummaryActionPerformed(evt);
            }
        });
        LateComing.add(rbtnLCSummary);
        rbtnLCSummary.setBounds(180, 10, 125, 20);
        LateComing.add(lblperiod);
        lblperiod.setBounds(450, 10, 300, 20);

        TabList.addTab("Detail", LateComing);

        jPanel1.setLayout(null);

        lblDate2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblDate2.setText("From Date : ");
        jPanel1.add(lblDate2);
        lblDate2.setBounds(10, 70, 110, 20);

        jButton1.setText("View");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jPanel1.add(jButton1);
        jButton1.setBounds(790, 10, 70, 25);

        jLabel3.setFont(new java.awt.Font("DejaVu Sans", 1, 12)); // NOI18N
        jLabel3.setText("LOOM WISE PER DAY ");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(290, 20, 210, 15);

        TabList.addTab("Analysis", jPanel1);

        getContentPane().add(TabList);
        TabList.setBounds(10, 133, 980, 80);
        TabList.getAccessibleContext().setAccessibleName("Leave Application");

        btnClear.setText("Clear All");
        btnClear.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnClear.setMargin(new java.awt.Insets(2, 7, 2, 7));
        btnClear.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnClearActionPerformed(evt);
            }
        });
        getContentPane().add(btnClear);
        btnClear.setBounds(870, 80, 110, 30);

        lblYearCmb.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblYearCmb.setText("Year : ");
        getContentPane().add(lblYearCmb);
        lblYearCmb.setBounds(680, 90, 60, 20);

        lblDeptCmb.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblDeptCmb.setText("Status :");
        getContentPane().add(lblDeptCmb);
        lblDeptCmb.setBounds(10, 30, 70, 30);
        getContentPane().add(txtYear);
        txtYear.setBounds(740, 90, 80, 20);

        cmbShift.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "ALL", "1", "2", "3" }));
        getContentPane().add(cmbShift);
        cmbShift.setBounds(520, 70, 60, 20);

        jLabel27.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel27.setText("Shift : ");
        getContentPane().add(jLabel27);
        jLabel27.setBounds(450, 70, 60, 20);

        Table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane25.setViewportView(Table);

        getContentPane().add(jScrollPane25);
        jScrollPane25.setBounds(10, 220, 980, 320);

        btnEmpMstETE.setLabel("Export to Excel");
        btnEmpMstETE.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEmpMstETEActionPerformed(evt);
            }
        });
        getContentPane().add(btnEmpMstETE);
        btnEmpMstETE.setBounds(830, 550, 150, 30);

        lblDate1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblDate1.setText("To Date : ");
        getContentPane().add(lblDate1);
        lblDate1.setBounds(240, 70, 90, 20);

        txtToDate = new EITLERP.FeltSales.common.DatePicker.DateTextFieldAdvanceSearch();
        getContentPane().add(txtToDate);
        txtToDate.setBounds(340, 70, 100, 20);

        cmbStatus.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Approved", "Unapproved", "Cancelled" }));
        cmbStatus.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cmbStatusItemStateChanged(evt);
            }
        });
        cmbStatus.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbStatusActionPerformed(evt);
            }
        });
        getContentPane().add(cmbStatus);
        cmbStatus.setBounds(90, 30, 130, 30);

        cmbDept.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cmbDept.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbDeptActionPerformed(evt);
            }
        });
        getContentPane().add(cmbDept);
        cmbDept.setBounds(560, 30, 60, 30);
    }// </editor-fold>//GEN-END:initComponents

    private void btnClearActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnClearActionPerformed
        txtFromDate.setText("");
        txtToDate.setText("");
        txtYear.setText("");
        cmbMonth.setSelectedIndex(0);
        cmbDept.setSelectedIndex(0);
        cmbShift.setSelectedIndex(0);        
        
        cmbMonth.setSelectedIndex(EITLERPGLOBAL.getCurrentMonth());
        txtYear.setText(EITLERPGLOBAL.getCurrentYear()+"");
    }//GEN-LAST:event_btnClearActionPerformed


    private void btnEmpMstETEActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEmpMstETEActionPerformed
        // TODO add your handling code here:
        try {
            File file = null;
            file1.setVisible(true);
            int returnVal = file1.showSaveDialog(this);
            if (returnVal == file1.APPROVE_OPTION) {
                file = file1.getSelectedFile();
            }
            file1.setVisible(false);

            exprt.fillData(Table, new File(file1.getSelectedFile().toString() + ".xls"), "Sheet1");
            JOptionPane.showMessageDialog(null, "Data saved at "
                    + file.toString() + " successfully ...", "Message",
                    JOptionPane.INFORMATION_MESSAGE);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }//GEN-LAST:event_btnEmpMstETEActionPerformed

    private void cmbDeptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbDeptActionPerformed
        // TODO add your handling code here:

    }//GEN-LAST:event_cmbDeptActionPerformed

    private void btnLeaveApplicationViewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLeaveApplicationViewActionPerformed
          FormatGridIncentiveDetail();
          GenerateIncentiveDetail();
    }//GEN-LAST:event_btnLeaveApplicationViewActionPerformed

    private void rbtnLCDetailItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_rbtnLCDetailItemStateChanged
        // TODO add your handling code here:
        FormatGridIncentiveDetail();
        
        txtFromDate.setEnabled(true);
        txtToDate.setEnabled(true);
        txtYear.setEnabled(true);
        cmbMonth.setEnabled(true);
        cmbDept.setEnabled(true);        
        cmbShift.setEnabled(true);
        
    }//GEN-LAST:event_rbtnLCDetailItemStateChanged

    private void rbtnLCSummaryItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_rbtnLCSummaryItemStateChanged
        // TODO add your handling code here:
        FormatGridLateComingSummary();
        
        txtFromDate.setEnabled(false);
        txtToDate.setEnabled(false);
        txtYear.setEnabled(true);
        cmbMonth.setEnabled(true);
        cmbDept.setEnabled(true);
        cmbShift.setEnabled(true);
        
    }//GEN-LAST:event_rbtnLCSummaryItemStateChanged

    private void cmbStatusItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cmbStatusItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_cmbStatusItemStateChanged

    private void cmbStatusActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbStatusActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cmbStatusActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
    if(!txtFromDate.getText().equals("") && !txtToDate.getText().equals("")){
        FormatGridAnalysis();
        GenerateLoomWiseDetail();
        GenerateAnalysis();
    }else{
        JOptionPane.showMessageDialog(this, "Please Select From date and To date...", "ERROR", JOptionPane.ERROR_MESSAGE);         
            return;
    }
        
    }//GEN-LAST:event_jButton1ActionPerformed

    private void rbtnLCSummaryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rbtnLCSummaryActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_rbtnLCSummaryActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup CoffRokadiBtnGrp;
    private javax.swing.JFileChooser ExporttoExcelFileChooser;
    private javax.swing.ButtonGroup GatePassBtnGrp;
    private javax.swing.ButtonGroup LCBtnGrp;
    private javax.swing.JPanel LateComing;
    private javax.swing.JTabbedPane TabList;
    private javax.swing.JTable Table;
    private javax.swing.JButton btnClear;
    private javax.swing.JButton btnEmpMstETE;
    private javax.swing.JButton btnLeaveApplicationView;
    private javax.swing.JComboBox cmbDept;
    private javax.swing.JComboBox cmbMonth;
    private javax.swing.JComboBox cmbShift;
    private javax.swing.JComboBox cmbStatus;
    private javax.swing.JFileChooser file1;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane25;
    private javax.swing.JLabel lblDate;
    private javax.swing.JLabel lblDate1;
    private javax.swing.JLabel lblDate2;
    private javax.swing.JLabel lblDeptCmb;
    private javax.swing.JLabel lblMonthCmb;
    private javax.swing.JLabel lblYearCmb;
    private javax.swing.JLabel lblperiod;
    private javax.swing.JRadioButton rbtnLCDetail;
    private javax.swing.JRadioButton rbtnLCSummary;
    private javax.swing.JTextField txtFromDate;
    private javax.swing.JTextField txtToDate;
    private javax.swing.JTextField txtYear;
    // End of variables declaration//GEN-END:variables

    private void GenerateDeptCombo() {

        HashMap List = new HashMap();
        clsMaster ObjDept;

        cmbDept.setModel(modelDept);
        modelDept.removeAllElements();  //Clearing previous contents

        ComboData aData = new ComboData();
        aData.Text = "Select Dept";
        aData.Code = 0;
        modelDept.addElement(aData);

        List = clsMaster.getDepartmentList("");

        for (int i = 1; i <= List.size(); i++) {
            ObjDept = (clsMaster) List.get(Integer.toString(i));
//            ComboData aData = new ComboData();
            aData.Text = (String) ObjDept.getAttribute("Name").getObj();
            aData.Code = (long) ObjDept.getAttribute("DPTID").getVal();
            modelDept.addElement(aData);
        }
    }

    private void GenerateShiftCombo() {

        HashMap List = new HashMap();
        clsMaster ObjShift;
        
        modelShift.removeAllElements();  //Clearing previous contents

        ComboData aData = new ComboData();
        aData.Text = "Select Shift";
        aData.Code = 0;
        modelShift.addElement(aData);

        List = clsMaster.getShiftList("");

        for (int i = 1; i <= List.size(); i++) {
            ObjShift = (clsMaster) List.get(Integer.toString(i));
//            ComboData aData = new ComboData();
            aData.Text = (String) ObjShift.getAttribute("SHIFT_NAME").getObj();
            aData.Code = (long) ObjShift.getAttribute("SHIFT_ID").getVal();
            modelShift.addElement(aData);
        }
    }

    /*
    private void GenerateMainCategoryCombo() {

        HashMap List = new HashMap();
        clsMaster ObjMainCategory;

        cmbMainCategory.setModel(modelMainCategory);
        modelMainCategory.removeAllElements();  //Clearing previous contents

        ComboData aData = new ComboData();
        aData.Text = "Select Main Category";
        aData.Code = 0;
        modelMainCategory.addElement(aData);

        List = clsMaster.getMainCategoryList("");

        for (int i = 1; i <= List.size(); i++) {
            ObjMainCategory = (clsMaster) List.get(Integer.toString(i));
//            ComboData aData = new ComboData();
            aData.Text = (String) ObjMainCategory.getAttribute("Name").getObj();
            aData.Code = (long) ObjMainCategory.getAttribute("SECID").getVal();
            modelMainCategory.addElement(aData);
        }
    }*/
    

    private void FormatGridBasicPunches() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");         //0
        DataModel.addColumn("Emp Pay No");  //1
        DataModel.addColumn("Emp Name");    //2
        DataModel.addColumn("Department");  //3
        DataModel.addColumn("Punch Date");  //4
        DataModel.addColumn("Shift");       //5     
        DataModel.addColumn("Time");        //6
        DataModel.addColumn("Machine");     //7    
        DataModel.addColumn("Category");    //8
        DataModel.addColumn("Sub Category");//9

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateBasicPunches() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridBasicPunches(); //clear existing content of table
            ResultSet rsTmp;
            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                //grp_cndtn += " WHERE EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
                cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                cndtn += " AND EMP_MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }
            
            if (!cmbMonth.getSelectedItem().equals("Select")) {
                cndtn += " AND MONTH(A_DATE)= " + cmbMonth.getSelectedIndex() + " ";
            }
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND YEAR(A_DATE)= '" + txtYear.getText().trim() + "'";
            }
            if (!txtFromDate.getText().trim().equals("")) {
                cndtn += " AND A_DATE>= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "'";
            }
            if (!txtToDate.getText().trim().equals("")) {
                cndtn += " AND A_DATE<= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "'";
            }

            String strSQL = "";

            strSQL = "SELECT DISTINCT EMP_CODE AS EMPID,A_DATE,P_TIME,MACHINE,CASE WHEN A_SHIFT='WO' THEN 0 ELSE A_SHIFT END AS A_SHIFT,"
                    + "EMP_NAME,DPTNAME,SECNAME,CTGNAME,DPTID AS EMP_DEPARTMENT,SEC.SECID AS MAIN_CATEGORY,CTG.CTGID AS CATEGORY  FROM SDMLATTPAY.ATT_DATA DAS "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON DAS.EMP_CODE=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=EMP.EMP_MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=EMP.EMP_CATEGORY "
                    + "WHERE 1=1 " + cndtn
                    + " ORDER BY EMP_CODE,A_DATE,P_TIME";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("EMPID");
                    rowData[2] = rsTmp.getString("EMP_NAME");
                    rowData[3] = rsTmp.getString("DPTNAME");
                    rowData[4] = EITLERPGLOBAL.formatDate(rsTmp.getString("A_DATE"));
                    rowData[5] = rsTmp.getString("A_SHIFT");
                    rowData[6] = rsTmp.getString("P_TIME");
                    rowData[7] = rsTmp.getString("MACHINE");
                    rowData[8] = rsTmp.getString("SECNAME");
                    rowData[9] = rsTmp.getString("CTGNAME");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridDailyAtt() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Punch Date");
        DataModel.addColumn("No of Punches");
        DataModel.addColumn("Shift");
        DataModel.addColumn("Status");
        DataModel.addColumn("In Time");
        DataModel.addColumn("Out Time");
        DataModel.addColumn("Working Hours");
        DataModel.addColumn("Personal GP 1st Half");
        DataModel.addColumn("Personal GP 2st Half");
        DataModel.addColumn("Official GP 1st Half");
        DataModel.addColumn("Official GP 2st Half");
        DataModel.addColumn("Late Hours");
        DataModel.addColumn("Punches");
        DataModel.addColumn("Personal GP Punches");
        DataModel.addColumn("Official GP Punches");
        DataModel.addColumn("Category");
        DataModel.addColumn("Sub Category");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateDailyAtt() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridDailyAtt(); //clear existing content of table
            ResultSet rsTmp;
            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                grp_cndtn += " WHERE EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                cndtn += " AND MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }
            
            if (!cmbMonth.getSelectedItem().equals("Select")) {
                cndtn += " AND MM= " + cmbMonth.getSelectedIndex() + " ";
            }
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND YYYY= '" + txtYear.getText().trim() + "'";
            }
            if (!txtFromDate.getText().trim().equals("")) {
                cndtn += " AND PUNCHDATE>= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "'";
            }
            if (!txtToDate.getText().trim().equals("")) {
                cndtn += " AND PUNCHDATE<= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "'";
            }

            String strSQL = "";

            strSQL = "SELECT * FROM ( SELECT * FROM SDMLATTPAY.ATT_DATA_DAILY_SUMMARY WHERE 1=1 " + cndtn + " ) AS DAS "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON DAS.EMPID=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=DAS.MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=DAS.CATEGORY " + grp_cndtn + " ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("EMPID");
                    rowData[2] = rsTmp.getString("EMP_NAME");
                    rowData[3] = rsTmp.getString("DPTNAME");
                    rowData[4] = EITLERPGLOBAL.formatDate(rsTmp.getString("PUNCHDATE"));
                    rowData[5] = rsTmp.getString("PUNCHES_NOS");
                    rowData[6] = rsTmp.getString("SHIFT");
                    rowData[7] = rsTmp.getString("PRESENT_FIRST") + " " + rsTmp.getString("PRESENT_SECOND");
                    rowData[8] = rsTmp.getString("INTIME").substring(11, 16);
                    rowData[9] = rsTmp.getString("OUTTIME").substring(11, 16);
                    rowData[10] = rsTmp.getString("TOTAL_WORKING_HRS").substring(0, 5);
                    rowData[11] = rsTmp.getString("GP_FIRST_HALF").substring(0, 5);
                    rowData[12] = rsTmp.getString("GP_SECOND_HALF").substring(0, 5);
                    rowData[13] = rsTmp.getString("GPO_FIRST_HALF").substring(0, 5);
                    rowData[14] = rsTmp.getString("GPO_SECOND_HALF").substring(0, 5);
                    rowData[15] = rsTmp.getString("GATEPASS_LATE").substring(0, 5);
                    rowData[16] = rsTmp.getString("ALL_PUNCHES");
                    rowData[17] = rsTmp.getString("ALL_PERSONAL_GATEPASS_PUNCHES");
                    rowData[18] = rsTmp.getString("ALL_OFFICIAL_GATEPASS_PUNCHES");
                    rowData[19] = rsTmp.getString("SECNAME");
                    rowData[20] = rsTmp.getString("CTGNAME");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridMonthlySummary() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Month");
        DataModel.addColumn("Year");
        DataModel.addColumn("Total Days");
        DataModel.addColumn("Paid Days");
        DataModel.addColumn("Present Days");
        DataModel.addColumn("LC Days");
        DataModel.addColumn("LWP Days");
        DataModel.addColumn("PL");
        DataModel.addColumn("CL");
        DataModel.addColumn("SL");
        DataModel.addColumn("OD");
        DataModel.addColumn("LOFF");
        DataModel.addColumn("EOFF");
        DataModel.addColumn("ESIC");
        DataModel.addColumn("WO");
        DataModel.addColumn("WOFF");
//        DataModel.addColumn("NPH"); on 09112019
        DataModel.addColumn("PH");
        DataModel.addColumn("NWOF");
        DataModel.addColumn("COFF");
        DataModel.addColumn("NPL");
        DataModel.addColumn("Personal GP");
        DataModel.addColumn("Official GP");
        DataModel.addColumn("Absent");
        DataModel.addColumn("Category");
        DataModel.addColumn("Sub Category");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateMonthlySummary() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridMonthlySummary(); //clear existing content of table
            ResultSet rsTmp;

            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                grp_cndtn += " AND EMP_MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }
            
            if (!cmbMonth.getSelectedItem().equals("Select")) {
                cndtn += " AND MS_MM= " + cmbMonth.getSelectedIndex() + " ";
            }
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND MS_YYYY= '" + txtYear.getText().trim() + "'";
            }

            String strSQL = "";

            strSQL = "SELECT * FROM ( SELECT * FROM SDMLATTPAY.ATT_MTH_SUMMARY WHERE 1=1 " + cndtn + " ) AS MAS "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_SHIFT_ID,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON MAS.MS_EMPID=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=EMP.EMP_MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=EMP.EMP_CATEGORY "
                    + "LEFT JOIN ( SELECT SHIFT_ID,SHIFT_NAME FROM SDMLATTPAY.ATT_SHIFT ) AS SFT "
                    + "ON SFT.SHIFT_ID=EMP.EMP_SHIFT_ID WHERE 1=1 " + grp_cndtn + " ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("MS_EMPID");
                    rowData[2] = rsTmp.getString("EMP_NAME");
                    rowData[3] = rsTmp.getString("DPTNAME");
                    rowData[4] = rsTmp.getString("MS_MM");
                    rowData[5] = rsTmp.getString("MS_YYYY");
                    rowData[6] = rsTmp.getString("TOTAL_MONTH_DAYS");
                    rowData[7] = rsTmp.getString("PAID_DAYS");
                    rowData[8] = rsTmp.getString("PRESENT_DAYS");
                    rowData[9] = rsTmp.getString("LC_DAYS");
                    rowData[10] = rsTmp.getString("LWP_DAYS");
                    rowData[11] = rsTmp.getString("PL");
                    rowData[12] = rsTmp.getString("CL");
                    rowData[13] = rsTmp.getString("SL");
                    rowData[14] = rsTmp.getString("OD");
                    rowData[15] = rsTmp.getString("LOFF");
                    rowData[16] = rsTmp.getString("EOFF");
                    rowData[17] = rsTmp.getString("ESIC");
                    rowData[18] = rsTmp.getString("WO");
                    rowData[19] = rsTmp.getString("WOFF");
//                    rowData[20] = rsTmp.getString("NPH"); on 09112019
                    rowData[20] = rsTmp.getString("HL");
                    rowData[21] = rsTmp.getString("NWOF");
                    rowData[22] = rsTmp.getString("COFFE");
                    rowData[23] = rsTmp.getString("NPL");
                    rowData[24] = rsTmp.getString("P_GP");
                    rowData[25] = rsTmp.getString("O_GP");
                    rowData[26] = rsTmp.getString("ABST");
                    rowData[27] = rsTmp.getString("SECNAME");
                    rowData[28] = rsTmp.getString("CTGNAME");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridAnalysis() {
        String fromdate=txtFromDate.getText().trim();
        String todate=txtToDate.getText().trim();
        int fdate=Integer.parseInt(fromdate.substring(0, 2));
        int tdate=Integer.parseInt(todate.substring(0, 2));
        System.out.println(fdate);
        System.out.println(tdate);
        
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Loom No");
        for(int i=fdate;i<=tdate;i++){
        DataModel.addColumn(i);
    }
        

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
        //for(int i=fdate;i<=tdate;i++){
        //Table.getColumnModel().getColumn(i+1).setMaxWidth(30);
    //}
    }

    

    private void FormatGridOddPunches() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Date");
        DataModel.addColumn("No of Punches");
        DataModel.addColumn("Punches");
        DataModel.addColumn("Shift");
        DataModel.addColumn("Category");
        DataModel.addColumn("Sub Category");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateOddPunches() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridOddPunches(); //clear existing content of table
            ResultSet rsTmp;

            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                grp_cndtn += " AND EMP_MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }
            
            if (!cmbMonth.getSelectedItem().equals("Select")) {
                cndtn += " AND MONTH(A_DATE)= " + cmbMonth.getSelectedIndex() + " ";
            }
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND YEAR(A_DATE)= '" + txtYear.getText().trim() + "'";
            }
            if (!txtFromDate.getText().trim().equals("")) {
                cndtn += " AND A_DATE>= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "'";
            }
            if (!txtToDate.getText().trim().equals("")) {
                cndtn += " AND A_DATE<= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "'";
            }

            String strSQL = "";

            strSQL = "SELECT * FROM (SELECT EMP_CODE,DATE_FORMAT(A_DATE,'%d/%m/%Y') AS PUNCH_DATE,GROUP_CONCAT(P_TIME ORDER BY P_TIME SEPARATOR' || ') AS PUNCHES,"
                    + "COUNT(0) AS NO_OF_PUNCHES,A_SHIFT FROM (SELECT DISTINCT EMP_CODE,A_DATE,P_TIME,A_SHIFT FROM SDMLATTPAY.ATT_DATA WHERE 1=1 AND COALESCE(UPDATE_IND,'')!='DELETION' " + cndtn + " ) AS AA "
                    + "GROUP BY PUNCH_DATE,EMP_CODE HAVING (COUNT(A_DATE)%2<>0) ORDER BY A_DATE) AS ODD "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_SHIFT_ID,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON ODD.EMP_CODE=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=EMP.EMP_MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=EMP.EMP_CATEGORY "
                    + "LEFT JOIN ( SELECT SHIFT_ID,SHIFT_NAME FROM SDMLATTPAY.ATT_SHIFT ) AS SFT "
                    + "ON SFT.SHIFT_ID=ODD.A_SHIFT WHERE 1=1 " + grp_cndtn + " ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("EMP_CODE");
                    rowData[2] = rsTmp.getString("EMP_NAME");
                    rowData[3] = rsTmp.getString("DPTNAME");
                    rowData[4] = rsTmp.getString("PUNCH_DATE");
                    rowData[5] = rsTmp.getString("NO_OF_PUNCHES");
                    rowData[6] = rsTmp.getString("PUNCHES");
                    rowData[7] = rsTmp.getString("A_SHIFT");
                    rowData[8] = rsTmp.getString("SECNAME");
                    rowData[9] = rsTmp.getString("CTGNAME");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridMonthlySummarySPP() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("EMP CODE");
        DataModel.addColumn("Employee Name");
        DataModel.addColumn("Pay Days");
        DataModel.addColumn("Present Days");
        DataModel.addColumn("LOP");
        DataModel.addColumn("COFF");
        DataModel.addColumn("CW");
        DataModel.addColumn("OOD");
        DataModel.addColumn("PL");
        DataModel.addColumn("CL");
        DataModel.addColumn("SL");
        DataModel.addColumn("LOFF");
        DataModel.addColumn("EOFF");
        DataModel.addColumn("PH");
        DataModel.addColumn("WOFF");
        DataModel.addColumn("NPH");
        DataModel.addColumn("WOF");
        DataModel.addColumn("NWOF");
        DataModel.addColumn("COFFE");
        DataModel.addColumn("NPL");
        DataModel.addColumn("ESIC");
        DataModel.addColumn("Remarks");

        DataModel.TableReadOnly(true);
    }

    private void GenerateMonthlySummarySPP() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridMonthlySummarySPP(); //clear existing content of table
            ResultSet rsTmp;

            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                grp_cndtn += " AND EMP_MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }
            
            if (!cmbMonth.getSelectedItem().equals("Select")) {
                cndtn += " AND MS_MM= " + cmbMonth.getSelectedIndex() + " ";
            }
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND MS_YYYY= '" + txtYear.getText().trim() + "'";
            }

            String strSQL = "";

            strSQL = "SELECT * FROM ( SELECT *,SUM(LC_DAYS+LWP_DAYS) AS LOP FROM SDMLATTPAY.ATT_MTH_SUMMARY WHERE 1=1 " + cndtn + " GROUP BY MS_EMPID,MS_MM,MS_YYYY ) AS MAS "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_SHIFT_ID,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON MAS.MS_EMPID=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=EMP.EMP_MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=EMP.EMP_CATEGORY "
                    + "LEFT JOIN ( SELECT SHIFT_ID,SHIFT_NAME FROM SDMLATTPAY.ATT_SHIFT ) AS SFT "
                    + "ON SFT.SHIFT_ID=EMP.EMP_SHIFT_ID WHERE 1=1 " + grp_cndtn + " ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = rsTmp.getString("MS_EMPID");
                    rowData[1] = rsTmp.getString("EMP_NAME");
                    rowData[2] = rsTmp.getString("PAID_DAYS");
                    rowData[3] = rsTmp.getString("PRESENT_DAYS");
                    rowData[4] = rsTmp.getString("LOP");
                    rowData[5] = rsTmp.getString("COFFE");
                    rowData[6] = "0";
                    rowData[7] = rsTmp.getString("OD");
                    rowData[8] = rsTmp.getString("PL");
                    rowData[9] = rsTmp.getString("CL");
                    rowData[10] = rsTmp.getString("SL");
                    rowData[11] = rsTmp.getString("LOFF");
                    rowData[12] = rsTmp.getString("EOFF");
                    rowData[13] = "0";
                    rowData[14] = rsTmp.getString("WO");
//                    rowData[15] = rsTmp.getString("NPH"); on 09112019
                    rowData[15] = rsTmp.getString("HL");
                    rowData[16] = rsTmp.getString("WOFF");
                    rowData[17] = rsTmp.getString("NWOF");
                    rowData[18] = rsTmp.getString("COFFE");
                    rowData[19] = rsTmp.getString("NPL");
                    rowData[20] = rsTmp.getString("ESIC");
                    rowData[21] = "";

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridIncentiveDetail() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");        
        DataModel.addColumn("Emp No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Total Rewards");
        DataModel.addColumn("Incentive");
        DataModel.addColumn("Date-Shift-Picks(Picks for Rewards Detail)");
        

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(35);
    }

     private void GenerateIncentiveDetail() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridIncentiveDetail(); //clear existing content of table
            ResultSet rsEmpno,rsTmp,rsIncentiveCheck,rsLoomDetail;
            
//            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
//                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
//            }

//            if (!cmbMainCategory.getSelectedItem().equals("Select Main Category")) {
//                cndtn += " AND MAIN_CATEGORY= " + cmbMainCategory.getSelectedIndex() + " ";
//            }
//
//            if (!cmbMonth.getSelectedItem().equals("Select")) {
//                cndtn += " AND MM= " + cmbMonth.getSelectedIndex() + " ";
//            }
//            if (!txtYear.getText().trim().equals("")) {
//                cndtn += " AND YYYY= '" + txtYear.getText().trim() + "'";
//            }
            int shift = cmbShift.getSelectedIndex();
            if (shift == 0) {
                cndtn += " ";
            }
            if (shift == 1) {
                cndtn += " AND SHIFT_ID=1 ";
            }
            if (shift == 2) {
                cndtn += " AND SHIFT_ID=2 ";
            }
            if (shift == 3) {
                cndtn += " AND SHIFT_ID=3 ";
            }
            
            if (!txtFromDate.getText().trim().equals("")) {
                cndtn += " AND DOC_DATE>= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "'";
            }
            if (!txtToDate.getText().trim().equals("")) {
                cndtn += " AND DOC_DATE<= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "'";
            }
                        
            
            String strSQL = "",strSQLEmpno = "",strIncentiveCheck="",strLoomdetail="",strperiod="";
            strperiod = "SELECT CONCAT(\"From :\",DATE_FORMAT(MIN(DOC_DATE),\"%d/%m/%Y\"),\" To :\",DATE_FORMAT(MAX(DOC_DATE),\"%d/%m/%Y\")) PERIOD FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO!='' "
                    + ""+ cndtn +" ORDER BY DOC_DATE;";
            lblperiod.setText(data.getStringValueFromDB(strperiod)); 
            strSQLEmpno = "SELECT DISTINCT EMP_NO FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO!='' "
                    + " "+ cndtn +" ORDER BY EMP_NO";
            rsEmpno=data.getResult(strSQLEmpno);
            rsEmpno.first();
            if (rsEmpno.getRow() > 0) {            
                String empno="";
                int cnt = 0;
                 while (!rsEmpno.isAfterLast()) {                
                    empno=rsEmpno.getString("EMP_NO");
                     System.out.println(empno); 
                      //strIncentiveCheck = "SELECT SHIFT_ID,LOOM_ENG,WEFT_DETAILS,PICK FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO='"+empno+"' "
                      //       + " "+ cndtn +" ORDER BY DOC_DATE";
                     strIncentiveCheck = "SELECT SHIFT_ID,LOOM_ENG,WEFT_DETAILS,PICK,DATE_FORMAT(DOC_DATE,\"%d\") DT,MC_RPM FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO='"+empno+"' "
                             + " "+ cndtn +" ORDER BY DOC_DATE";
                     rsIncentiveCheck=data.getResult(strIncentiveCheck);
                     rsIncentiveCheck.first();
                     if (rsIncentiveCheck.getRow() > 0) {            
                         String shiftid="",loom="",weftdetail="",pick="",dt="",rpm="";
                         int rewardseligible=0;
                         String shiftdatedetail="";
                         while (!rsIncentiveCheck.isAfterLast()) {                
                             shiftid=rsIncentiveCheck.getString("SHIFT_ID");
                             loom=rsIncentiveCheck.getString("LOOM_ENG");
                             //weftdetail=rsIncentiveCheck.getString("WEFT_DETAILS");
                             weftdetail=rsIncentiveCheck.getString("WEFT_DETAILS").trim();
                             String regex = "\\b"+weftdetail+"\\b";
                             Pattern pattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);
                             
                             pick=rsIncentiveCheck.getString("PICK").trim();
                             rpm=rsIncentiveCheck.getString("MC_RPM");
                             //shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                             
                             if(!weftdetail.equals("") && !pick.equals("")){
                             strLoomdetail="SELECT * FROM PRODUCTION.WEAVER_PRODUCTION_TARGETS WHERE LOOM='"+loom+"'";
                             rsLoomDetail=data.getResult(strLoomdetail);
                             rsLoomDetail.first();
                             if (rsLoomDetail.getRow() > 0) {            
                                 String masterweftdetail="",pickforrewards12="",pickforrewards3="",masterrpm="";
                                 String pickforrewards2_12="",pickforrewards2_3="";
                                 while (!rsLoomDetail.isAfterLast()) {  
                                     masterweftdetail=rsLoomDetail.getString("WEFT_DETAILS");
                                     masterrpm=rsLoomDetail.getString("RPM");
                                     Matcher matcher = pattern.matcher(masterweftdetail);
                                     
                                     pickforrewards12=rsLoomDetail.getString("SHIFT_AB_PICKS_FOR_REWARDS");
                                     pickforrewards3=rsLoomDetail.getString("SHIFT_C_PICKS_FOR_REWARDS");
                                     if(rsLoomDetail.getString("SHIFT_AB_PICKS_FOR_REWARDS2")== null){
                                     pickforrewards2_12="999999";
                                 }else{
                                         pickforrewards2_12=rsLoomDetail.getString("SHIFT_AB_PICKS_FOR_REWARDS2");
                                     }
                                     if(rsLoomDetail.getString("SHIFT_C_PICKS_FOR_REWARDS2") == null){
                                        pickforrewards2_3="999999"; 
                                     }else{
                                         pickforrewards2_3=rsLoomDetail.getString("SHIFT_C_PICKS_FOR_REWARDS2");
                                     }
                                     //pickforrewards2_12=rsLoomDetail.getString("SHIFT_AB_PICKS_FOR_REWARDS2");
                                     //pickforrewards2_3=rsLoomDetail.getString("SHIFT_C_PICKS_FOR_REWARDS2");
                                     
                                     //if(shiftid.equals("1") && masterweftdetail.contains(weftdetail)){
                                     //if(shiftid.equals("1") && matcher.find() && masterrpm.equals(rpm)){ 
                                     if(shiftid.equals("1") && matcher.find()){ 
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards12)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards12+")";
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards12+")";
                                            }
                                         }
                                         if (Integer.parseInt(pick) >= Integer.parseInt(pickforrewards2_12)) {
                                             rewardseligible++;
                                             if (shiftdatedetail.equals("")) {
                                                 //shiftdatedetail=shiftdatedetail;
                                                 shiftdatedetail = rsIncentiveCheck.getString("DT") + "-" + rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards2_12+")";
                                             } else {
                                                 //shiftdatedetail=","+shiftdatedetail;
                                                 shiftdatedetail = shiftdatedetail + "," + rsIncentiveCheck.getString("DT") + "-" + rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards2_12+")";
                                             }
                                         }
                                     }
                                     //if(shiftid.equals("2") && masterweftdetail.contains(weftdetail)){
                                     //if(shiftid.equals("2") && matcher.find() && masterrpm.equals(rpm)){
                                     if(shiftid.equals("2") && matcher.find()){
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards12)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards12+")";
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards12+")";
                                            }
                                         }
                                         if (Integer.parseInt(pick) >= Integer.parseInt(pickforrewards2_12)) {
                                             rewardseligible++;
                                             if (shiftdatedetail.equals("")) {
                                                 //shiftdatedetail=shiftdatedetail;
                                                 shiftdatedetail = rsIncentiveCheck.getString("DT") + "-" + rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards2_12+")";
                                             } else {
                                                 //shiftdatedetail=","+shiftdatedetail;
                                                 shiftdatedetail = shiftdatedetail + "," + rsIncentiveCheck.getString("DT") + "-" + rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards2_12+")";
                                             }
                                         }
                                     }
                                     //if(shiftid.equals("3") && masterweftdetail.contains(weftdetail)){
                                     //if(shiftid.equals("3") && matcher.find() && masterrpm.equals(rpm)){
                                     if(shiftid.equals("3") && matcher.find()){
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards3)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards3+")";
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards3+")";
                                            }
                                         }
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards2_3)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards2_3+")";
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID")+"-"+pick+"("+pickforrewards2_3+")";
                                            }
                                         }
                                     }                                     
                                     rsLoomDetail.next();
                                 }
                             }
                             }
                             rsIncentiveCheck.next();
                         }                             
                         if(rewardseligible>0){
                             cnt++;
                          Object[] rowData = new Object[10];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsEmpno.getString("EMP_NO");
                    //rowData[2] = data.getStringValueFromDB("SELECT EMP_NAME FROM SDMLATTPAY.EMP_CATEGORY WHERE EMP_NO='"+rsEmpno.getString("EMP_NO")+"'");
                    rowData[2] = data.getStringValueFromDB("SELECT DISTINCT EMP_NAME FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NAME!='' AND EMP_NO='"+rsEmpno.getString("EMP_NO")+"'");
                    rowData[3] = rewardseligible;
                    rowData[4] = rewardseligible*50;
                    rowData[5] = shiftdatedetail;

                    DataModel.addRow(rowData);                 
                         }
                     }                     
                    rsEmpno.next(); 
                 }
            }            

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridLateComingSummary() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Month");
        DataModel.addColumn("Year");
        DataModel.addColumn("Total Late Coming");
        DataModel.addColumn("Category");
        DataModel.addColumn("Sub Category");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateLoomWiseDetail() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridIncentiveDetail();
            ResultSet rsEmpno,rsTmp,rsIncentiveCheck,rsLoomDetail;
                         
//            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
//                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
//            }

//            if (!cmbMainCategory.getSelectedItem().equals("Select Main Category")) {
//                cndtn += " AND MAIN_CATEGORY= " + cmbMainCategory.getSelectedIndex() + " ";
//            }
//
//            if (!cmbMonth.getSelectedItem().equals("Select")) {
//                cndtn += " AND MM= " + cmbMonth.getSelectedIndex() + " ";
//            }
//            if (!txtYear.getText().trim().equals("")) {
//                cndtn += " AND YYYY= '" + txtYear.getText().trim() + "'";
//            }
            
            data.Execute("DELETE FROM PRODUCTION.FELT_WVG_PROD_LOOM_WISE_DETAIL_TEMP WHERE DOC_DATE BETWEEN '"+EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim())+"' AND '"+EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim())+"'");
            
            int shift = cmbShift.getSelectedIndex();
            if (shift == 0) {
                cndtn += " ";
            }
            if (shift == 1) {
                cndtn += " AND SHIFT_ID=1 ";
            }
            if (shift == 2) {
                cndtn += " AND SHIFT_ID=2 ";
            }
            if (shift == 3) {
                cndtn += " AND SHIFT_ID=3 ";
            }
            
            if (!txtFromDate.getText().trim().equals("")) {
                cndtn += " AND DOC_DATE>= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "'";
            }
            if (!txtToDate.getText().trim().equals("")) {
                cndtn += " AND DOC_DATE<= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "'";
            }
                        
            
            String strSQL = "",strSQLEmpno = "",strIncentiveCheck="",strLoomdetail="",strperiod="";
            strperiod = "SELECT CONCAT(\"From :\",DATE_FORMAT(MIN(DOC_DATE),\"%d/%m/%Y\"),\" To :\",DATE_FORMAT(MAX(DOC_DATE),\"%d/%m/%Y\")) PERIOD FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO!='' \n"
                    + ""+ cndtn +" ORDER BY DOC_DATE;";
            lblperiod.setText(data.getStringValueFromDB(strperiod)); 
            strSQLEmpno = "SELECT DISTINCT EMP_NO FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO!='' "
                    + " "+ cndtn +" ORDER BY EMP_NO";
            rsEmpno=data.getResult(strSQLEmpno);
            rsEmpno.first();
            if (rsEmpno.getRow() > 0) {            
                String empno="";
                int cnt = 0;
                 while (!rsEmpno.isAfterLast()) {                
                    empno=rsEmpno.getString("EMP_NO");
                     System.out.println(empno); 
                      //strIncentiveCheck = "SELECT SHIFT_ID,LOOM_ENG,WEFT_DETAILS,PICK FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO='"+empno+"' "
                      //       + " "+ cndtn +" ORDER BY DOC_DATE";
                     strIncentiveCheck = "SELECT SHIFT_ID,LOOM_ENG,WEFT_DETAILS,PICK,DATE_FORMAT(DOC_DATE,\"%d\") DT,MC_RPM,DOC_DATE,DOC_NO,EMP_NO FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO='"+empno+"' "
                             + " "+ cndtn +" ORDER BY DOC_DATE";
                     rsIncentiveCheck=data.getResult(strIncentiveCheck);
                     rsIncentiveCheck.first();
                     if (rsIncentiveCheck.getRow() > 0) {            
                         String shiftid="",loom="",weftdetail="",pick="",dt="",rpm="";
                         int rewardseligible=0;
                         String shiftdatedetail="";
                         while (!rsIncentiveCheck.isAfterLast()) {                
                             shiftid=rsIncentiveCheck.getString("SHIFT_ID");
                             loom=rsIncentiveCheck.getString("LOOM_ENG");
                             //weftdetail=rsIncentiveCheck.getString("WEFT_DETAILS");
                             weftdetail=rsIncentiveCheck.getString("WEFT_DETAILS").trim();
                             String regex = "\\b"+weftdetail+"\\b";
                             Pattern pattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);
                             
                             pick=rsIncentiveCheck.getString("PICK").trim();
                             rpm=rsIncentiveCheck.getString("MC_RPM");
                             //shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                             
                             if(!weftdetail.equals("") && !pick.equals("")){
                             strLoomdetail="SELECT * FROM PRODUCTION.WEAVER_PRODUCTION_TARGETS WHERE LOOM='"+loom+"'";
                             rsLoomDetail=data.getResult(strLoomdetail);
                             rsLoomDetail.first();
                             if (rsLoomDetail.getRow() > 0) {            
                                 String masterweftdetail="",pickforrewards12="",pickforrewards3="",masterrpm="";
                                 while (!rsLoomDetail.isAfterLast()) {  
                                     masterweftdetail=rsLoomDetail.getString("WEFT_DETAILS");
                                     masterrpm=rsLoomDetail.getString("RPM");
                                     Matcher matcher = pattern.matcher(masterweftdetail);
                                     
                                     pickforrewards12=rsLoomDetail.getString("SHIFT_AB_PICKS_FOR_REWARDS");
                                     pickforrewards3=rsLoomDetail.getString("SHIFT_C_PICKS_FOR_REWARDS");
                                     
                                     //if(shiftid.equals("1") && masterweftdetail.contains(weftdetail)){
                                     //if(shiftid.equals("1") && matcher.find() && masterrpm.equals(rpm)){ 
                                     if(shiftid.equals("1") && matcher.find()){ 
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards12)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                                            }                                           
                                                    
                                             String strInsert = "INSERT INTO PRODUCTION.FELT_WVG_PROD_LOOM_WISE_DETAIL_TEMP (DOC_NO,DOC_DATE,SHIFT_ID,EMP_NO,LOOM_ENG)"
                                                     + " VALUES ('" + rsIncentiveCheck.getString("DOC_NO") + "',"
                                                     + "'" + rsIncentiveCheck.getString("DOC_DATE") + "',"
                                                     + "'" + rsIncentiveCheck.getString("SHIFT_ID") + "',"
                                                     + "'" + rsIncentiveCheck.getString("EMP_NO") + "',"
                                                     + "'" + rsIncentiveCheck.getString("LOOM_ENG") + "')";
                                             System.out.println(strInsert);
                                             data.Execute(strInsert);
                                         }
                                     }
                                     //if(shiftid.equals("2") && masterweftdetail.contains(weftdetail)){
                                     //if(shiftid.equals("2") && matcher.find() && masterrpm.equals(rpm)){
                                     if(shiftid.equals("2") && matcher.find()){
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards12)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                                            }
                                            String strInsert = "INSERT INTO PRODUCTION.FELT_WVG_PROD_LOOM_WISE_DETAIL_TEMP (DOC_NO,DOC_DATE,SHIFT_ID,EMP_NO,LOOM_ENG)"
                                                     + " VALUES ('" + rsIncentiveCheck.getString("DOC_NO") + "',"
                                                     + "'" + rsIncentiveCheck.getString("DOC_DATE") + "',"
                                                     + "'" + rsIncentiveCheck.getString("SHIFT_ID") + "',"
                                                     + "'" + rsIncentiveCheck.getString("EMP_NO") + "',"
                                                     + "'" + rsIncentiveCheck.getString("LOOM_ENG") + "')";
                                             System.out.println(strInsert);
                                             data.Execute(strInsert);
                                         }
                                     }
                                     //if(shiftid.equals("3") && masterweftdetail.contains(weftdetail)){
                                     //if(shiftid.equals("3") && matcher.find() && masterrpm.equals(rpm)){
                                     if(shiftid.equals("3") && matcher.find()){
                                         if(Integer.parseInt(pick)>=Integer.parseInt(pickforrewards3)){
                                            rewardseligible++;                
                                            if(shiftdatedetail.equals("")){
                                                //shiftdatedetail=shiftdatedetail;
                                                shiftdatedetail=rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                                            }else{
                                                //shiftdatedetail=","+shiftdatedetail;
                                                shiftdatedetail=shiftdatedetail+","+rsIncentiveCheck.getString("DT")+"-"+rsIncentiveCheck.getString("SHIFT_ID");
                                            }
                                            String strInsert = "INSERT INTO PRODUCTION.FELT_WVG_PROD_LOOM_WISE_DETAIL_TEMP (DOC_NO,DOC_DATE,SHIFT_ID,EMP_NO,LOOM_ENG)"
                                                     + " VALUES ('" + rsIncentiveCheck.getString("DOC_NO") + "',"
                                                     + "'" + rsIncentiveCheck.getString("DOC_DATE") + "',"
                                                     + "'" + rsIncentiveCheck.getString("SHIFT_ID") + "',"
                                                     + "'" + rsIncentiveCheck.getString("EMP_NO") + "',"
                                                     + "'" + rsIncentiveCheck.getString("LOOM_ENG") + "')";
                                             System.out.println(strInsert);
                                             data.Execute(strInsert);
                                             
                                         }
                                     }                                     
                                     rsLoomDetail.next();
                                 }
                             }
                             }
                             rsIncentiveCheck.next();
                         }                             
                         /*if(rewardseligible>0){
                             cnt++;
                          Object[] rowData = new Object[10];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsEmpno.getString("EMP_NO");
                    //rowData[2] = data.getStringValueFromDB("SELECT EMP_NAME FROM SDMLATTPAY.EMP_CATEGORY WHERE EMP_NO='"+rsEmpno.getString("EMP_NO")+"'");
                    rowData[2] = data.getStringValueFromDB("SELECT DISTINCT EMP_NAME FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NAME!='' AND EMP_NO='"+rsEmpno.getString("EMP_NO")+"'");
                    rowData[3] = rewardseligible;
                    rowData[4] = rewardseligible*50;
                    rowData[5] = shiftdatedetail;

                    DataModel.addRow(rowData);                 
                         }*/
                     }                     
                    rsEmpno.next(); 
                 }
            }            

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridMaster() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Code");
        DataModel.addColumn("Name");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateAnalysis() {
        try {
            FormatGridAnalysis(); //clear existing content of table
            ResultSet rsTmp;

            String strSQL = "";
            String dynamicSQL="";
            String dynamicSumSQL="";
            String dynamicSumSQL1="";
            
            int fdate=Integer.parseInt(txtFromDate.getText().trim().substring(0, 2));
            int tdate=Integer.parseInt(txtToDate.getText().trim().substring(0, 2));
            
            for(int i=fdate;i<=tdate;i++){
                //sql = sql + ",'' AS '" + i + "'";
        dynamicSQL=dynamicSQL+",SUM(IF(DAY(DOC_DATE)=" + i + ",CNT,0)) AS '" + i + "' ";
        dynamicSumSQL=dynamicSumSQL+",SUM(IF(DAY(DOC_DATE)=" + i + ",CNT,0)) AS '_" + i + "' ";
        dynamicSumSQL1=dynamicSumSQL1+",SUM(_" + i + ") AS '" + i + "' ";
    }
            
            strSQL = "SELECT LOOM_ENG" + dynamicSQL + " FROM "
                    //+ " (SELECT DOC_DATE,LOOM_ENG,COUNT(EMP_NO) CNT FROM PRODUCTION.FELT_WVG_PROD_LOOM_WVR_NEW_DETAIL WHERE EMP_NO!='' AND LOOM_ENG!='' AND DOC_DATE BETWEEN '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "' AND '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "' GROUP BY LOOM_ENG,DOC_DATE ORDER BY DOC_NO,SHIFT_ID,LOOM_ENG) AS VIEW1 GROUP BY LOOM_ENG "
                    + " (SELECT DOC_DATE,LOOM_ENG,COUNT(EMP_NO) CNT FROM PRODUCTION.FELT_WVG_PROD_LOOM_WISE_DETAIL_TEMP WHERE EMP_NO!='' AND LOOM_ENG!='' AND DOC_DATE BETWEEN '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "' AND '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "' GROUP BY LOOM_ENG,DOC_DATE ORDER BY DOC_NO,SHIFT_ID,LOOM_ENG) AS VIEW1 GROUP BY LOOM_ENG "
                    +" UNION ALL "    
                    +"SELECT 'TOTAL' AS LOOM_ENG"+dynamicSumSQL1+" FROM (SELECT LOOM_ENG" + dynamicSumSQL + " FROM "
                    + " (SELECT DOC_DATE,LOOM_ENG,COUNT(EMP_NO) CNT FROM PRODUCTION.FELT_WVG_PROD_LOOM_WISE_DETAIL_TEMP WHERE EMP_NO!='' AND LOOM_ENG!='' AND DOC_DATE BETWEEN '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "' AND '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "' GROUP BY LOOM_ENG,DOC_DATE ORDER BY DOC_NO,SHIFT_ID,LOOM_ENG) AS VIEW1 GROUP BY LOOM_ENG ) AS VIEW1 ";
            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[40];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("LOOM_ENG");
                    //for (int i = fdate; i <= tdate; i++) {                
                   //rowData[1+i] = rsTmp.getString(1+i);
            //} 
                  for(int i=2,j=fdate;i<=Table.getColumnCount()-1;j++,i++)       {
                rowData[i]=rsTmp.getString(i);
            } 

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void GenerateDesignationMst() {
        try {
            FormatGridMaster(); //clear existing content of table
            ResultSet rsTmp;

            String strSQL = "";

            strSQL = "SELECT * FROM SDMLATTPAY.ATT_DESIGNATION_MASTER";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("DSGCODE");
                    rowData[2] = rsTmp.getString("Name");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void GenerateCategoryMst() {
        try {
            FormatGridMaster(); //clear existing content of table
            ResultSet rsTmp;

            String strSQL = "";

            strSQL = "SELECT * FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("SECCODE");
                    rowData[2] = rsTmp.getString("Name");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void GenerateSubCategoryMst() {
        try {
            FormatGridMaster(); //clear existing content of table
            ResultSet rsTmp;

            String strSQL = "";

            strSQL = "SELECT * FROM SDMLATTPAY.ATT_CATEGORY_MASTER";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("CTGCODE");
                    rowData[2] = rsTmp.getString("Name");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridShiftMaster() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Code");
        DataModel.addColumn("Name");
        DataModel.addColumn("In Time");
        DataModel.addColumn("Out Time");
        DataModel.addColumn("Lunch In");
        DataModel.addColumn("Lunch Out");
        DataModel.addColumn("Working Hours");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateShiftMst() {
        try {
            FormatGridShiftMaster(); //clear existing content of table
            ResultSet rsTmp;

            String strSQL = "";

            strSQL = "SELECT * FROM SDMLATTPAY.ATT_SHIFT";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("SHIFT_ID");
                    rowData[2] = rsTmp.getString("SHIFT_NAME");
                    rowData[3] = rsTmp.getString("SHIFT_IN_TIME");
                    rowData[4] = rsTmp.getString("SHIFT_OUT_TIME");
                    rowData[5] = rsTmp.getString("SHIFT_LUNCH_IN");
                    rowData[6] = rsTmp.getString("SHIFT_LUNCH_OUT");
                    rowData[7] = rsTmp.getString("SHIFT_WRK_HRS");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridGatePass() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Shift");
        DataModel.addColumn("Designation");
        DataModel.addColumn("GP Date");
        DataModel.addColumn("Nature of Work");
        DataModel.addColumn("Leaving Time");
        DataModel.addColumn("Arrival Time");
        DataModel.addColumn("Total Time");
        DataModel.addColumn("Remark");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateGatePass() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridGatePass(); //clear existing content of table
            ResultSet rsTmp;


            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                cndtn += " AND GP_EMP_DEPT= '" + cmbDept.getSelectedItem() + "' ";
            }

            if (!cmbMonth.getSelectedItem().equals("Select")) {
                cndtn += " AND MONTH(GP_DATE)= " + cmbMonth.getSelectedIndex() + " ";
            }
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND YEAR(GP_DATE)= '" + txtYear.getText().trim() + "' ";
            }
            if (!txtFromDate.getText().trim().equals("")) {
                cndtn += " AND GP_DATE>= '" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText().trim()) + "'";
            }
            if (!txtToDate.getText().trim().equals("")) {
                cndtn += " AND GP_DATE<= '" + EITLERPGLOBAL.formatDateDB(txtToDate.getText().trim()) + "'";
            }

            String strSQL = "";

            strSQL = "SELECT * FROM SDMLATTPAY.GATEPASS_ENTRY " + cndtn + " ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("GP_EMP_NO");
                    rowData[2] = rsTmp.getString("GP_EMP_NAME");
                    rowData[3] = rsTmp.getString("GP_EMP_DEPT");
                    rowData[4] = rsTmp.getString("GP_EMP_SHIFT");
                    rowData[5] = rsTmp.getString("GP_EMP_DESN");
                    rowData[6] = EITLERPGLOBAL.formatDate(rsTmp.getString("GP_DATE"));
                    rowData[7] = rsTmp.getString("GP_NATURE_OF_WORK");
                    rowData[8] = rsTmp.getString("GP_TOL");
                    rowData[9] = rsTmp.getString("GP_TOA");
                    rowData[10] = rsTmp.getString("GP_TOT_HOURS");
                    rowData[11] = rsTmp.getString("GP_REMARKS");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private void FormatGridLeaveAvail() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Leave Type");
        DataModel.addColumn("From Date");
        DataModel.addColumn("To Date");
        DataModel.addColumn("Days");
        DataModel.addColumn("Mention Time");
        DataModel.addColumn("Remark");
        DataModel.addColumn("Category");
        DataModel.addColumn("Sub Category");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateLeaveAvail() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridLeaveAvail(); //clear existing content of table
            ResultSet rsTmp;


//            if (!cmbMonth.getSelectedItem().equals("Select")) {
//                cndtn += " AND " + cmbMonth.getSelectedIndex() + " >= MONTH(LVT_FROMDATE) AND " + cmbMonth.getSelectedIndex() + " <= MONTH(LVT_TODATE) ";
//            }
//            if (!txtYear.getText().trim().equals("")) {
//                cndtn += " AND '" + txtYear.getText().trim() + "' >= YEAR(LVT_FROMDATE) AND '" + txtYear.getText().trim() + "' <= YEAR(LVT_TODATE) ";
//            }
            
//            if (!cmbMonth.getSelectedItem().equals("Select") && !txtYear.getText().trim().equals("")) {
//                cndtn += " AND ((MONTH(LVT_FROMDATE)= " + cmbMonth.getSelectedIndex() + "  AND YEAR(LVT_FROMDATE)= '" + txtYear.getText().trim() + "' ) OR (MONTH(LVT_TODATE)= " + cmbMonth.getSelectedIndex() + "  AND YEAR(LVT_TODATE)= '" + txtYear.getText().trim() + "' )) ";
//            }
            
            if (!txtYear.getText().trim().equals("")) {
                cndtn += " AND LVT_YEAR = '" + txtYear.getText().trim() + "' ";
            }
            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                grp_cndtn += " AND EMP_MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }


            String strSQL = "";

            strSQL = "SELECT * FROM ( SELECT * FROM SDMLATTPAY.ATT_LEAVE_TRN WHERE LVT_LEAVE_TYPE=3 "
                    + "AND COALESCE(AMEND_TYPE,'') NOT IN ('DELETE') " + cndtn + " ) AS LA "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON LA.LVT_PAY_EMPID=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=EMP.EMP_MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=EMP.EMP_CATEGORY WHERE 1=1 " + grp_cndtn + " "
                    + "ORDER BY LVT_PAY_EMPID,LVT_FROMDATE DESC ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("LVT_PAY_EMPID");
                    rowData[2] = rsTmp.getString("EMP_NAME");
                    rowData[3] = rsTmp.getString("DPTNAME");
                    rowData[4] = rsTmp.getString("LVT_LEAVE_CODE");
                    rowData[5] = EITLERPGLOBAL.formatDate(rsTmp.getString("LVT_FROMDATE"));
                    rowData[6] = EITLERPGLOBAL.formatDate(rsTmp.getString("LVT_TODATE"));
                    rowData[7] = rsTmp.getString("LVT_DAYS");
                    rowData[8] = rsTmp.getString("LVT_MENTION_TIME");
                    rowData[9] = rsTmp.getString("LVT_REMARK");
                    rowData[10] = rsTmp.getString("SECNAME");
                    rowData[11] = rsTmp.getString("CTGNAME");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }
    
    private void FormatGridLeaveBalance() {
        DataModel = new EITLTableModel();
        Table.removeAll();
        Table.setModel(DataModel);

        Table.setAutoResizeMode(Table.AUTO_RESIZE_OFF);

        DataModel.addColumn("Sr.");
        DataModel.addColumn("Emp Pay No");
        DataModel.addColumn("Emp Name");
        DataModel.addColumn("Department");
        DataModel.addColumn("Type");
        DataModel.addColumn("Opening");
        DataModel.addColumn("Credit");
        DataModel.addColumn("Avail");
        DataModel.addColumn("Lapse");
        DataModel.addColumn("Encash");
        DataModel.addColumn("Closing");
        DataModel.addColumn("Category");
        DataModel.addColumn("Sub Category");

        DataModel.TableReadOnly(true);
        Table.getColumnModel().getColumn(0).setMaxWidth(50);
    }

    private void GenerateLeaveBalance() {
        String cndtn = "";
        String grp_cndtn = "";
        try {
            FormatGridLeaveBalance(); //clear existing content of table
            ResultSet rsTmp;

            
            if (!cmbDept.getSelectedItem().equals("Select Dept")) {
                grp_cndtn += " AND EMP_DEPARTMENT= " + cmbDept.getSelectedIndex() + " ";
            }
            if (!cmbShift.getSelectedItem().equals("Select Main Category")) {
                grp_cndtn += " AND EMP_MAIN_CATEGORY= " + cmbShift.getSelectedIndex() + " ";
            }
            

            String strSQL = "";

            strSQL = "SELECT * FROM ( SELECT * FROM SDMLATTPAY.ATT_LEAVE_BALANCE WHERE 1=1 " + cndtn + " ) AS LB "
                    + "LEFT JOIN ( SELECT PAY_EMP_NO,EMP_NAME,EMP_DEPARTMENT,EMP_MAIN_CATEGORY,EMP_CATEGORY FROM SDMLATTPAY.ATTPAY_EMPMST ) AS EMP "
                    + "ON LB.LVBAL_PAYEMPCD=EMP.PAY_EMP_NO "
                    + "LEFT JOIN ( SELECT DPTID,NAME AS DPTNAME FROM SDMLATTPAY.ATT_DEPARTMENT_MASTER ) AS DPT "
                    + "ON DPT.DPTID=EMP.EMP_DEPARTMENT "
                    + "LEFT JOIN ( SELECT SECID,NAME AS SECNAME FROM SDMLATTPAY.ATT_MAIN_CATEGORY_MASTER ) AS SEC "
                    + "ON SEC.SECID=EMP.EMP_MAIN_CATEGORY "
                    + "LEFT JOIN ( SELECT CTGID,NAME AS CTGNAME FROM SDMLATTPAY.ATT_CATEGORY_MASTER ) AS CTG "
                    + "ON CTG.CTGID=EMP.EMP_CATEGORY WHERE 1=1 " + grp_cndtn + " ";

            System.out.println("Query..." + strSQL);
            rsTmp = data.getResult(strSQL);
            rsTmp.first();
            System.out.println("Row no." + rsTmp.getRow());
            if (rsTmp.getRow() > 0) {
                int cnt = 0;
                DecimalFormat df = new DecimalFormat("###.##");
                while (!rsTmp.isAfterLast()) {
                    cnt++;

                    Object[] rowData = new Object[100];

                    rowData[0] = Integer.toString(cnt);
                    rowData[1] = rsTmp.getString("LVBAL_PAYEMPCD");
                    rowData[2] = rsTmp.getString("EMP_NAME");
                    rowData[3] = rsTmp.getString("DPTNAME");
                    rowData[4] = rsTmp.getString("LVBAL_LEAVE_CD");
                    rowData[5] = rsTmp.getString("LVBAL_OPENING");
                    rowData[6] = rsTmp.getString("LVBAL_CREDIT");
                    rowData[7] = rsTmp.getString("LVBAL_AVAIL");
                    rowData[8] = rsTmp.getString("LVBAL_LAPSE");
                    rowData[9] = rsTmp.getString("LVBAL_ENCASH");
                    rowData[10] = rsTmp.getString("LVBAL_CLOSING");        
                    rowData[11] = rsTmp.getString("SECNAME");
                    rowData[12] = rsTmp.getString("CTGNAME");

                    DataModel.addRow(rowData);
                    rsTmp.next();
                }
                final TableColumnModel columnModel = Table.getColumnModel();
                for (int column = 0; column < Table.getColumnCount(); column++) {
                    int width = 60; // Min width
                    for (int row = 0; row < Table.getRowCount(); row++) {
                        TableCellRenderer renderer = Table.getCellRenderer(row, column);
                        Component comp = Table.prepareRenderer(renderer, row, column);
                        width = Math.max(comp.getPreferredSize().width + 10, width);
                    }
                    if (width > 300) {
                        width = 300;
                    }
                    columnModel.getColumn(column).setPreferredWidth(width);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    private boolean DateValidate() {
        if (txtFromDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter From Date");
            txtFromDate.setText("");
            return false;
        }
        if (data.getIntValueFromDB("SELECT DATEDIFF('" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText()) + "',CURDATE()) FROM DUAL") > 0) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter Less than or Equals Current Date in From Date");
            txtFromDate.setText("");
            return false;
        }

        if (txtToDate.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter To Date");
            txtToDate.setText("");
            return false;
        }
        if (data.getIntValueFromDB("SELECT DATEDIFF('" + EITLERPGLOBAL.formatDateDB(txtToDate.getText()) + "','" + EITLERPGLOBAL.formatDateDB(txtFromDate.getText()) + "') FROM DUAL") < 0) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter Greater Date than From Date in To Date");
            txtToDate.setText("");
            return false;
        }

        return true;
    }

    private boolean MonthYearValidate() {
        if (cmbMonth.getSelectedItem().equals("Select")) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Select Month");
            return false;
        }
        if (txtYear.getText().trim().equals("")) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter Year");
            txtYear.setText("");
            return false;
        }
        if (txtYear.getText().trim().length() != 4) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter Valid Year");
            txtYear.setText("");
            return false;
        }
        if (!EITLERPGLOBAL.IsNumber(txtYear.getText().trim())) {
            JOptionPane.showMessageDialog(FrmRptWeaverIncentive.this, "Please Enter Valid Year");
            txtYear.setText("");
            return false;
        }

        return true;
    }
}
