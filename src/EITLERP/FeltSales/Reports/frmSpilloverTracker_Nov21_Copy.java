/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package EITLERP.FeltSales.Reports;

import EITLERP.ComboData;
import EITLERP.EITLComboModel;
import EITLERP.EITLERPGLOBAL;
import EITLERP.EITLTableModel;
import EITLERP.Finance.UtilFunctions;
import EITLERP.ReportRegister;
import EITLERP.data;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.event.KeyEvent;
import java.io.File;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.Statement;
import java.text.DecimalFormat;
import java.util.Date;
import java.util.HashMap;
import javax.swing.JOptionPane;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;
import javax.swing.text.JTextComponent;

/**
 *
 * @author Dharmendra
 */
public class frmSpilloverTracker_Nov21_Copy extends javax.swing.JApplet {

    /**
     * Initializes the frmOverDueOutStanding
     */
    private int EditMode = 0;
    private boolean DoNotEvaluate = false;
    private EITLTableModel DataModel = new EITLTableModel();
    private EITLComboModel cmbOCMonthModel;
    public EITLERP.FeltSales.Reports.clsExcelExporter exprt = new EITLERP.FeltSales.Reports.clsExcelExporter();

    @Override
    public void init() {
        /* Create and display the applet */
        initComponents();
        file1.show(false);
        GraphicsDevice gd = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
        int scrwidth = gd.getDisplayMode().getWidth();
        int scrheight = gd.getDisplayMode().getHeight();
//        setSize(scrwidth, scrheight);
        setSize(1000, 540);
        GenerateCombo();
        FormatGrid();
    }

    /**
     * This method is called from within the init() method to initialize the
     * form. WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        cmdview = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        Table = new javax.swing.JTable();
        cmdWhStkExporttoExcel = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        file1 = new javax.swing.JFileChooser();
        jLabel1 = new javax.swing.JLabel();
        cmbOCMonth = new javax.swing.JComboBox();

        getContentPane().setLayout(null);

        cmdview.setText("View");
        cmdview.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdviewActionPerformed(evt);
            }
        });
        getContentPane().add(cmdview);
        cmdview.setBounds(310, 40, 120, 30);

        Table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        Table.getTableHeader().setReorderingAllowed(false);
        jScrollPane1.setViewportView(Table);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(10, 80, 970, 410);

        cmdWhStkExporttoExcel.setText("Export to Excel");
        cmdWhStkExporttoExcel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdWhStkExporttoExcelActionPerformed(evt);
            }
        });
        getContentPane().add(cmdWhStkExporttoExcel);
        cmdWhStkExporttoExcel.setBounds(810, 40, 150, 30);

        jPanel1.setBackground(new java.awt.Color(0, 102, 255));
        jPanel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel1.setMinimumSize(new java.awt.Dimension(1000, 29));
        jPanel1.setLayout(null);

        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("Felt Sales Spillover Tracker");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(2, 4, 460, 20);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(2, 1, 980, 30);
        getContentPane().add(file1);
        file1.setBounds(510, 50, 220, 420);

        jLabel1.setText("OC MONTH :");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(20, 45, 100, 20);

        getContentPane().add(cmbOCMonth);
        cmbOCMonth.setBounds(110, 40, 180, 30);
    }// </editor-fold>//GEN-END:initComponents

    private void cmdviewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdviewActionPerformed
        // TODO add your handling code here:
        GenerateData();
    }//GEN-LAST:event_cmdviewActionPerformed

    private void cmdWhStkExporttoExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdWhStkExporttoExcelActionPerformed
        // TODO add your handling code here:
        try {
            File file = null;
            file1.setVisible(true);
            int returnVal = file1.showSaveDialog(this);
            if (returnVal == file1.APPROVE_OPTION) {
                file = file1.getSelectedFile();
            }
            file1.setVisible(false);

            exprt.fillData(Table, new File(file1.getSelectedFile().toString() + ".xls"), "Spillover Tracker");

            JOptionPane.showMessageDialog(null, "Data saved at "
                    + file.toString() + " successfully ...", "Message",
                    JOptionPane.INFORMATION_MESSAGE);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }//GEN-LAST:event_cmdWhStkExporttoExcelActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable Table;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox cmbOCMonth;
    private javax.swing.JButton cmdWhStkExporttoExcel;
    private javax.swing.JButton cmdview;
    private javax.swing.JFileChooser file1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    // End of variables declaration//GEN-END:variables

    private void GenerateCombo() {
        //Generates Combo Boxes
        ComboData objData2 = new ComboData();
        cmbOCMonthModel = new EITLComboModel();
        cmbOCMonth.removeAllItems();
        cmbOCMonth.setModel(cmbOCMonthModel);

        try {
            ResultSet rs = data.getResult("SELECT DISTINCT OC_MONTH FROM PRODUCTION.SPILLOVER_OC_REPORT WHERE SP_MONTH_DATE<=LAST_DAY(CURDATE()) ORDER BY OC_MONTH_DATE DESC");
            rs.first();

            while (!rs.isAfterLast()) {
                objData2 = new ComboData();
                objData2.Text = rs.getString("OC_MONTH");
                objData2.strCode = rs.getString("OC_MONTH");
                cmbOCMonthModel.addElement(objData2);
                rs.next();
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void FormatGrid() {
        try {
            // objRow=objReportData.newRow();
            DataModel = new EITLTableModel();
            Table.removeAll();
            Table.setModel(DataModel);
            Table.setAutoResizeMode(0);

            DataModel.addColumn("OC SO Month");
            DataModel.addColumn("SP Month");
            DataModel.addColumn("Total");
            DataModel.addColumn("Mar - 2021");
            DataModel.addColumn("Apr - 2021");
            DataModel.addColumn("May - 2021");
            DataModel.addColumn("Jun - 2021");
            DataModel.addColumn("Jul - 2021");
            DataModel.addColumn("Aug - 2021");
            DataModel.addColumn("Sep - 2021");
            DataModel.addColumn("Oct - 2021");
            DataModel.addColumn("Nov - 2021");
            DataModel.addColumn("Dec - 2021");
            DataModel.addColumn("Jan - 2022");
            DataModel.addColumn("Feb - 2022");
            DataModel.addColumn("Mar - 2022");
            DataModel.addColumn("FY 2022-2023");
            DataModel.addColumn("Run DateTime");

            Table.setEnabled(false);
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Mar - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Apr - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("May - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Jun - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Jul - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
                Table.getColumnModel().getColumn(7).setMinWidth(0);
                Table.getColumnModel().getColumn(7).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Aug - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
                Table.getColumnModel().getColumn(7).setMinWidth(0);
                Table.getColumnModel().getColumn(7).setMaxWidth(0);
                Table.getColumnModel().getColumn(8).setMinWidth(0);
                Table.getColumnModel().getColumn(8).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Sep - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
                Table.getColumnModel().getColumn(7).setMinWidth(0);
                Table.getColumnModel().getColumn(7).setMaxWidth(0);
                Table.getColumnModel().getColumn(8).setMinWidth(0);
                Table.getColumnModel().getColumn(8).setMaxWidth(0);
                Table.getColumnModel().getColumn(9).setMinWidth(0);
                Table.getColumnModel().getColumn(9).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Oct - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
                Table.getColumnModel().getColumn(7).setMinWidth(0);
                Table.getColumnModel().getColumn(7).setMaxWidth(0);
                Table.getColumnModel().getColumn(8).setMinWidth(0);
                Table.getColumnModel().getColumn(8).setMaxWidth(0);
                Table.getColumnModel().getColumn(9).setMinWidth(0);
                Table.getColumnModel().getColumn(9).setMaxWidth(0);
                Table.getColumnModel().getColumn(10).setMinWidth(0);
                Table.getColumnModel().getColumn(10).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Nov - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
                Table.getColumnModel().getColumn(7).setMinWidth(0);
                Table.getColumnModel().getColumn(7).setMaxWidth(0);
                Table.getColumnModel().getColumn(8).setMinWidth(0);
                Table.getColumnModel().getColumn(8).setMaxWidth(0);
                Table.getColumnModel().getColumn(9).setMinWidth(0);
                Table.getColumnModel().getColumn(9).setMaxWidth(0);
                Table.getColumnModel().getColumn(10).setMinWidth(0);
                Table.getColumnModel().getColumn(10).setMaxWidth(0);
                Table.getColumnModel().getColumn(11).setMinWidth(0);
                Table.getColumnModel().getColumn(11).setMaxWidth(0);
            }
            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Dec - 2021")) {
                Table.getColumnModel().getColumn(3).setMinWidth(0);
                Table.getColumnModel().getColumn(3).setMaxWidth(0);
                Table.getColumnModel().getColumn(4).setMinWidth(0);
                Table.getColumnModel().getColumn(4).setMaxWidth(0);
                Table.getColumnModel().getColumn(5).setMinWidth(0);
                Table.getColumnModel().getColumn(5).setMaxWidth(0);
                Table.getColumnModel().getColumn(6).setMinWidth(0);
                Table.getColumnModel().getColumn(6).setMaxWidth(0);
                Table.getColumnModel().getColumn(7).setMinWidth(0);
                Table.getColumnModel().getColumn(7).setMaxWidth(0);
                Table.getColumnModel().getColumn(8).setMinWidth(0);
                Table.getColumnModel().getColumn(8).setMaxWidth(0);
                Table.getColumnModel().getColumn(9).setMinWidth(0);
                Table.getColumnModel().getColumn(9).setMaxWidth(0);
                Table.getColumnModel().getColumn(10).setMinWidth(0);
                Table.getColumnModel().getColumn(10).setMaxWidth(0);
                Table.getColumnModel().getColumn(11).setMinWidth(0);
                Table.getColumnModel().getColumn(11).setMaxWidth(0);
                Table.getColumnModel().getColumn(12).setMinWidth(0);
                Table.getColumnModel().getColumn(12).setMaxWidth(0);
            }

        } catch (Exception e) {

        }
    }

    private void GenerateData() {
        FormatGrid();

        try {

            String str = "SELECT DISTINCT OC_MONTH FROM PRODUCTION.SPILLOVER_OC_REPORT "
                    + "WHERE SP_MONTH_DATE<=LAST_DAY(CURDATE()) "
                    + "AND OC_MONTH='" + cmbOCMonth.getSelectedItem().toString().trim() + "' "//Added
                    + "ORDER BY OC_MONTH_DATE ";
//            System.out.println(str);

            ResultSet rsTmp = data.getResult(str);
            rsTmp.first();
            int Counter = 0;
            if (rsTmp.getRow() > 0) {
                while (!rsTmp.isAfterLast()) {
                    Counter++;
                    DecimalFormat df = new DecimalFormat("###.##");

                    Object[] rowData = new Object[20];

                    DataModel.addRow(rowData);

                    rowData[0] = UtilFunctions.getString(rsTmp, "OC_MONTH", "");
                    rowData[1] = "";
                    rowData[2] = "";
                    rowData[3] = "";
                    rowData[4] = "";
                    rowData[5] = "";
                    rowData[6] = "";
                    rowData[7] = "";
                    rowData[8] = "";
                    rowData[9] = "";
                    rowData[10] = "";
                    rowData[11] = "";
                    rowData[12] = "";
                    rowData[13] = "";
                    rowData[14] = "";
                    rowData[15] = "";
                    rowData[16] = "";
                    rowData[17] = EITLERPGLOBAL.getCurrentDateTimeDB();

                    DataModel.addRow(rowData);

                    String str1 = "SELECT * FROM PRODUCTION.SPILLOVER_OC_REPORT "
                            + "WHERE SP_MONTH_DATE<=LAST_DAY(CURDATE()) AND OC_MONTH='" + rsTmp.getString("OC_MONTH") + "' "
                            + "ORDER BY SP_MONTH_DATE ";
//            System.out.println(str1);

                    ResultSet rsTmpD = data.getResult(str1);
                    rsTmpD.first();
                    int CounterD = 0;
                    if (rsTmpD.getRow() > 0) {
                        while (!rsTmpD.isAfterLast()) {
                            CounterD++;

                            rowData = new Object[20];

//                            DataModel.addRow(rowData);
                            rowData[0] = "";
                            rowData[1] = UtilFunctions.getString(rsTmpD, "SP_MONTH", "");
                            rowData[2] = UtilFunctions.getString(rsTmpD, "RSC_TOTAL", "");
                            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Mar - 2021")) {
                                rowData[3] = "";
                            } else {
                                rowData[3] = UtilFunctions.getString(rsTmpD, "RSC_MAR_P", "");
                            }
                            rowData[4] = UtilFunctions.getString(rsTmpD, "RSC_APR", "");
                            rowData[5] = UtilFunctions.getString(rsTmpD, "RSC_MAY", "");
                            rowData[6] = UtilFunctions.getString(rsTmpD, "RSC_JUN", "");
                            rowData[7] = UtilFunctions.getString(rsTmpD, "RSC_JUL", "");
                            rowData[8] = UtilFunctions.getString(rsTmpD, "RSC_AUG", "");
                            rowData[9] = UtilFunctions.getString(rsTmpD, "RSC_SEP", "");
                            rowData[10] = UtilFunctions.getString(rsTmpD, "RSC_OCT", "");
                            rowData[11] = UtilFunctions.getString(rsTmpD, "RSC_NOV", "");
                            rowData[12] = UtilFunctions.getString(rsTmpD, "RSC_DEC", "");
                            rowData[13] = UtilFunctions.getString(rsTmpD, "RSC_JAN", "");
                            rowData[14] = UtilFunctions.getString(rsTmpD, "RSC_FEB", "");
                            rowData[15] = UtilFunctions.getString(rsTmpD, "RSC_MAR", "");
                            rowData[16] = UtilFunctions.getString(rsTmpD, "RSC_NEXT_YEAR", "");
                            rowData[17] = EITLERPGLOBAL.getCurrentDateTimeDB();

                            DataModel.addRow(rowData);

                            rowData[0] = "";
                            rowData[1] = "Addtion";
                            rowData[2] = UtilFunctions.getString(rsTmpD, "ADD_TOTAL", "");
                            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Mar - 2021")) {
                                rowData[3] = "";
                            } else {
                                rowData[3] = UtilFunctions.getString(rsTmpD, "ADD_MAR_P", "");
                            }
                            rowData[4] = UtilFunctions.getString(rsTmpD, "ADD_APR", "");
                            rowData[5] = UtilFunctions.getString(rsTmpD, "ADD_MAY", "");
                            rowData[6] = UtilFunctions.getString(rsTmpD, "ADD_JUN", "");
                            rowData[7] = UtilFunctions.getString(rsTmpD, "ADD_JUL", "");
                            rowData[8] = UtilFunctions.getString(rsTmpD, "ADD_AUG", "");
                            rowData[9] = UtilFunctions.getString(rsTmpD, "ADD_SEP", "");
                            rowData[10] = UtilFunctions.getString(rsTmpD, "ADD_OCT", "");
                            rowData[11] = UtilFunctions.getString(rsTmpD, "ADD_NOV", "");
                            rowData[12] = UtilFunctions.getString(rsTmpD, "ADD_DEC", "");
                            rowData[13] = UtilFunctions.getString(rsTmpD, "ADD_JAN", "");
                            rowData[14] = UtilFunctions.getString(rsTmpD, "ADD_FEB", "");
                            rowData[15] = UtilFunctions.getString(rsTmpD, "ADD_MAR", "");
                            rowData[16] = UtilFunctions.getString(rsTmpD, "ADD_NEXT_YEAR", "");
                            rowData[17] = EITLERPGLOBAL.getCurrentDateTimeDB();

                            DataModel.addRow(rowData);

                            rowData[0] = "";
                            rowData[1] = "Act Inv/Div/Obs";
                            rowData[2] = UtilFunctions.getString(rsTmpD, "ASC_TOTAL", "");
                            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Mar - 2021")) {
                                rowData[3] = "";
                            } else {
                                rowData[3] = UtilFunctions.getString(rsTmpD, "ASC_MAR_P", "");
                            }
                            rowData[4] = UtilFunctions.getString(rsTmpD, "ASC_APR", "");
                            rowData[5] = UtilFunctions.getString(rsTmpD, "ASC_MAY", "");
                            rowData[6] = UtilFunctions.getString(rsTmpD, "ASC_JUN", "");
                            rowData[7] = UtilFunctions.getString(rsTmpD, "ASC_JUL", "");
                            rowData[8] = UtilFunctions.getString(rsTmpD, "ASC_AUG", "");
                            rowData[9] = UtilFunctions.getString(rsTmpD, "ASC_SEP", "");
                            rowData[10] = UtilFunctions.getString(rsTmpD, "ASC_OCT", "");
                            rowData[11] = UtilFunctions.getString(rsTmpD, "ASC_NOV", "");
                            rowData[12] = UtilFunctions.getString(rsTmpD, "ASC_DEC", "");
                            rowData[13] = UtilFunctions.getString(rsTmpD, "ASC_JAN", "");
                            rowData[14] = UtilFunctions.getString(rsTmpD, "ASC_FEB", "");
                            rowData[15] = UtilFunctions.getString(rsTmpD, "ASC_MAR", "");
                            rowData[16] = UtilFunctions.getString(rsTmpD, "ASC_NEXT_YEAR", "");
                            rowData[17] = EITLERPGLOBAL.getCurrentDateTimeDB();

                            DataModel.addRow(rowData);

                            rowData[0] = "";
                            rowData[1] = "Diff";
                            rowData[2] = UtilFunctions.getInt(rsTmpD, "RSC_TOTAL", 0) + UtilFunctions.getInt(rsTmpD, "ADD_TOTAL", 0) - UtilFunctions.getInt(rsTmpD, "ASC_TOTAL", 0);
                            if (cmbOCMonth.getSelectedItem().toString().equalsIgnoreCase("Mar - 2021")) {
                                rowData[3] = "";
                            } else {
                                rowData[3] = UtilFunctions.getInt(rsTmpD, "RSC_MAR_P", 0) + UtilFunctions.getInt(rsTmpD, "ADD_MAR_P", 0) - UtilFunctions.getInt(rsTmpD, "ASC_MAR_P", 0);
                            }
                            rowData[4] = UtilFunctions.getInt(rsTmpD, "RSC_APR", 0) + UtilFunctions.getInt(rsTmpD, "ADD_APR", 0) - UtilFunctions.getInt(rsTmpD, "ASC_APR", 0);
                            rowData[5] = UtilFunctions.getInt(rsTmpD, "RSC_MAY", 0) + UtilFunctions.getInt(rsTmpD, "ADD_MAY", 0) - UtilFunctions.getInt(rsTmpD, "ASC_MAY", 0);
                            rowData[6] = UtilFunctions.getInt(rsTmpD, "RSC_JUN", 0) + UtilFunctions.getInt(rsTmpD, "ADD_JUN", 0) - UtilFunctions.getInt(rsTmpD, "ASC_JUN", 0);
                            rowData[7] = UtilFunctions.getInt(rsTmpD, "RSC_JUL", 0) + UtilFunctions.getInt(rsTmpD, "ADD_JUL", 0) - UtilFunctions.getInt(rsTmpD, "ASC_JUL", 0);
                            rowData[8] = UtilFunctions.getInt(rsTmpD, "RSC_AUG", 0) + UtilFunctions.getInt(rsTmpD, "ADD_AUG", 0) - UtilFunctions.getInt(rsTmpD, "ASC_AUG", 0);
                            rowData[9] = UtilFunctions.getInt(rsTmpD, "RSC_SEP", 0) + UtilFunctions.getInt(rsTmpD, "ADD_SEP", 0) - UtilFunctions.getInt(rsTmpD, "ASC_SEP", 0);
                            rowData[10] = UtilFunctions.getInt(rsTmpD, "RSC_OCT", 0) + UtilFunctions.getInt(rsTmpD, "ADD_OCT", 0) - UtilFunctions.getInt(rsTmpD, "ASC_OCT", 0);
                            rowData[11] = UtilFunctions.getInt(rsTmpD, "RSC_NOV", 0) + UtilFunctions.getInt(rsTmpD, "ADD_NOV", 0) - UtilFunctions.getInt(rsTmpD, "ASC_NOV", 0);
                            rowData[12] = UtilFunctions.getInt(rsTmpD, "RSC_DEC", 0) + UtilFunctions.getInt(rsTmpD, "ADD_DEC", 0) - UtilFunctions.getInt(rsTmpD, "ASC_DEC", 0);
                            rowData[13] = UtilFunctions.getInt(rsTmpD, "RSC_JAN", 0) + UtilFunctions.getInt(rsTmpD, "ADD_JAN", 0) - UtilFunctions.getInt(rsTmpD, "ASC_JAN", 0);
                            rowData[14] = UtilFunctions.getInt(rsTmpD, "RSC_FEB", 0) + UtilFunctions.getInt(rsTmpD, "ADD_FEB", 0) - UtilFunctions.getInt(rsTmpD, "ASC_FEB", 0);
                            rowData[15] = UtilFunctions.getInt(rsTmpD, "RSC_MAR", 0) + UtilFunctions.getInt(rsTmpD, "ADD_MAR", 0) - UtilFunctions.getInt(rsTmpD, "ASC_MAR", 0);
                            rowData[16] = UtilFunctions.getInt(rsTmpD, "RSC_NEXT_YEAR", 0) + UtilFunctions.getInt(rsTmpD, "ADD_NEXT_YEAR", 0) - UtilFunctions.getInt(rsTmpD, "ASC_NEXT_YEAR", 0);
                            rowData[17] = EITLERPGLOBAL.getCurrentDateTimeDB();

                            DataModel.addRow(rowData);

                            rowData = new Object[20];
                            DataModel.addRow(rowData);

                            rsTmpD.next();

                        }
                    }

                    Table.changeSelection(Table.getRowCount() - 1, 1, false, false);
                    Table.requestFocus();

                    rsTmp.next();

                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}
