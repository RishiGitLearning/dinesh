/*
 * frmFindFeltMending.java
 * This form is used for searching  the details of Felt Production Mending
 * 
 * Created on April 24, 2013, 18:17 PM
 */
package EITLERP.FeltSales.DispatchPlanner;

/**
 *
 * @author Vivek Kumar
 */
/*<APPLET CODE=frmGRNFind.class HEIGHT=405 WIDTH=565></APPLET>*/
import EITLERP.EITLERPGLOBAL;
import EITLERP.FeltSales.common.FeltInvCalc;
import EITLERP.FeltSales.common.clsOrderValueCalc;
import EITLERP.clsSales_Party;
import sdml.felt.commonUI.data;

public class TickDiscChargeCode extends javax.swing.JApplet {

    public boolean Cancelled = true;
    public String stringFindQuery = "";

    public void init() {
        System.gc();
        setSize(320, 320);
        initComponents();
    }

    /**
     * This method is called from within the init() method to initialize the
     * form. WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        cmdOk = new javax.swing.JButton();
        cmdCancel = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        lblProductCode = new javax.swing.JLabel();
        lblPartyCode = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        lblPreDisc = new javax.swing.JLabel();
        lblCurDisc = new javax.swing.JLabel();
        lblPreChrge = new javax.swing.JLabel();
        lblCurCharge = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        chkDisc = new javax.swing.JCheckBox();
        chkCharge = new javax.swing.JCheckBox();
        jLabel1 = new javax.swing.JLabel();
        lblPieceNo = new javax.swing.JLabel();
        lblPartyName = new javax.swing.JLabel();

        cmdOk.setText("Ok");
        cmdOk.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        cmdOk.setNextFocusableComponent(cmdCancel);
        cmdOk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdOkActionPerformed(evt);
            }
        });

        cmdCancel.setText("Cancel");
        cmdCancel.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        cmdCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdCancelActionPerformed(evt);
            }
        });

        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        lblProductCode.setText("Product Code : ");

        lblPartyCode.setText("Party");

        jLabel6.setText("Disc %");

        jLabel7.setText("ChargeCode");

        jLabel8.setText("Pre Dispatch");

        jLabel9.setText("Current");

        lblPreDisc.setText("jLabel8");

        lblCurDisc.setText("jLabel9");

        lblPreChrge.setText("jLabel10");

        lblCurCharge.setText("jLabel11");

        jLabel14.setText("Tick if OK");

        jLabel1.setText("Piece No : ");

        lblPieceNo.setText("jLabel2");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(12, 12, 12)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblProductCode)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(lblPartyCode, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(12, 12, 12)
                        .addComponent(jLabel7))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(lblPreDisc, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(lblPreChrge, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(lblCurDisc, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(lblCurCharge, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(chkDisc, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(24, 24, 24)
                        .addComponent(chkCharge, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))))
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblPieceNo))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                    .addComponent(lblPieceNo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblProductCode, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(12, 12, 12)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblPartyCode, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(12, 12, 12)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPreDisc, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPreChrge, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblCurDisc, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblCurCharge, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(chkDisc, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(chkCharge, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        lblPartyName.setText("jLabel1");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(lblPartyName, javax.swing.GroupLayout.PREFERRED_SIZE, 280, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(40, 40, 40)
                        .addComponent(cmdOk, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(80, 80, 80)
                        .addComponent(cmdCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addComponent(lblPartyName)
                .addGap(5, 5, 5)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cmdOk, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmdCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void cmdCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdCancelActionPerformed
        stringFindQuery = "";
        Cancelled = true;
        getParent().getParent().getParent().getParent().show(false);
    }//GEN-LAST:event_cmdCancelActionPerformed

    private void cmdOkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdOkActionPerformed
        Cancelled = false;
        String pieceNo = lblPieceNo.getText().trim();
        int cDisc = 0, cCharge = 0;
        if (chkDisc.isSelected()) {
            cDisc = 1;
        }
        if (chkCharge.isSelected()) {
            cCharge = 1;
        }
        EITLERP.data.Execute("UPDATE PRODUCTION.FELT_DISPATCH_SELECTION_DATA "
                + "SET DISCOUNT_CHECK=" + cDisc + " , CHARGE_CODE_CHECK=" + cCharge + "  "
                + "WHERE PIECE_NO='" + pieceNo + "'");

        getParent().getParent().getParent().getParent().show(false);
    }//GEN-LAST:event_cmdOkActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JCheckBox chkCharge;
    private javax.swing.JCheckBox chkDisc;
    private javax.swing.JButton cmdCancel;
    private javax.swing.JButton cmdOk;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JLabel lblCurCharge;
    private javax.swing.JLabel lblCurDisc;
    private javax.swing.JLabel lblPartyCode;
    private javax.swing.JLabel lblPartyName;
    private javax.swing.JLabel lblPieceNo;
    private javax.swing.JLabel lblPreChrge;
    private javax.swing.JLabel lblPreDisc;
    private javax.swing.JLabel lblProductCode;
    // End of variables declaration//GEN-END:variables

    public void showDiscChargeCode(String pPiece, String pParty) {
        String prdCode = data.getStringValueFromDB("SELECT PR_BILL_PRODUCT_CODE FROM PRODUCTION.FELT_SALES_PIECE_REGISTER WHERE PR_PIECE_NO='" + pPiece + "'");
        String prdGrp = data.getStringValueFromDB("SELECT PR_GROUP FROM PRODUCTION.FELT_SALES_PIECE_REGISTER WHERE PR_PIECE_NO='" + pPiece + "'");
        String preChCd = data.getStringValueFromDB("SELECT CHARGE_CODE FROM PRODUCTION.FELT_SAL_INVOICE_HEADER WHERE PARTY_CODE='" + pParty + "' AND PRODUCT_CODE='" + prdCode + "' AND APPROVED=1 AND CANCELLED=0 ORDER BY INVOICE_DATE DESC,INVOICE_NO DESC");
        String preDisc = data.getStringValueFromDB("SELECT DISC_PER FROM PRODUCTION.FELT_SAL_INVOICE_HEADER WHERE PARTY_CODE='" + pParty + "' AND PRODUCT_CODE='" + prdCode + "' AND APPROVED=1 AND CANCELLED=0 ORDER BY INVOICE_DATE DESC,INVOICE_NO DESC");

        lblPartyName.setText(clsSales_Party.getPartyName(EITLERPGLOBAL.gCompanyID, pParty));
        lblProductCode.setText("Product : " + prdGrp + " : " + prdCode);
        lblPieceNo.setText(pPiece);
        lblPartyCode.setText(pParty);
        lblPreChrge.setText(preChCd);
        lblPreDisc.setText(preDisc);
        lblCurCharge.setText(clsSales_Party.getChargeCode(EITLERPGLOBAL.gCompanyID, pParty));

        FeltInvCalc inv_calc;
        try {
            inv_calc = clsOrderValueCalc.calculateWithoutGSTINNO(pPiece, prdCode, pParty, Float.parseFloat("5"), Float.parseFloat("3"),
                    Float.parseFloat("25"), Float.parseFloat("15"), EITLERPGLOBAL.getCurrentDateDB());
            lblCurDisc.setText(String.valueOf(EITLERPGLOBAL.round(inv_calc.getFicDiscPer(), 2)));
        } catch (Exception e) {
            System.out.println("Erro on Disc : " + e.getMessage());
        }
    }
}
