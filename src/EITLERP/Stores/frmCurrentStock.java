/*
 * frmCurrentStock.java
 *
 * Created on June 8, 2004, 2:45 PM
 */

package EITLERP.Stores;

/**
 *
 * @author  nrpithva
 */
/*<APPLET CODE=frmCurrentStock.class HEIGHT=525 WIDTH=758></APPLET>*/

import javax.swing.*;
import java.awt.*;
import EITLERP.*;
import java.util.*;
import javax.swing.table.*;
import javax.swing.event.*;
import java.awt.event.*;
import java.sql.*;
import java.net.*;


public class frmCurrentStock extends javax.swing.JApplet {
    
    private EITLComboModel cmbWareHouseModel;
    private EITLTableModel DataModel;
    
    private String SelWareHouseID="";
    
    /** Initializes the applet frmCurrentStock */
    public void init() {
        setSize(676,315);
        initComponents();
        GenerateCombo();
        txtAsOnDate.setText(EITLERPGLOBAL.getCurrentDate());
        txtItemID.requestFocus();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jLabel1 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        cmbWareHouse = new javax.swing.JComboBox();
        jLabel3 = new javax.swing.JLabel();
        txtItemID = new javax.swing.JTextField();
        txtItemName = new javax.swing.JTextField();
        cmdShow = new javax.swing.JButton();
        cmdShow1 = new javax.swing.JButton();
        lblLocation = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        txtOnHand = new javax.swing.JTextField();
        txtAllocated = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        txtAvailable = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        txtAsOnDate = new javax.swing.JTextField();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jLabel1.setBackground(new java.awt.Color(0, 102, 153));
        jLabel1.setForeground(java.awt.Color.white);
        jLabel1.setText(" ITEM CURRENT STOCK INFORMATION");
        jLabel1.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel1.setOpaque(true);
        getContentPane().add(jLabel1);
        jLabel1.setBounds(2, 2, 754, 25);

        jPanel1.setLayout(null);

        jPanel1.setBorder(new javax.swing.border.EtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel2.setDisplayedMnemonic('W');
        jLabel2.setLabelFor(cmbWareHouse);
        jLabel2.setText("Warehouse");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(10, 18, 72, 15);

        cmbWareHouse.setNextFocusableComponent(txtItemID);
        cmbWareHouse.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                cmbWareHouseFocusGained(evt);
            }
        });
        cmbWareHouse.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cmbWareHouseItemStateChanged(evt);
            }
        });

        jPanel1.add(cmbWareHouse);
        cmbWareHouse.setBounds(86, 14, 258, 24);

        jLabel3.setDisplayedMnemonic('I');
        jLabel3.setLabelFor(txtItemID);
        jLabel3.setText("Item ID");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(36, 54, 48, 15);

        txtItemID.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtItemIDFocusLost(evt);
            }
        });
        txtItemID.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtItemIDKeyPressed(evt);
            }
        });

        jPanel1.add(txtItemID);
        txtItemID.setBounds(86, 50, 102, 19);

        txtItemName.setEditable(false);
        jPanel1.add(txtItemName);
        txtItemName.setBounds(194, 50, 300, 19);

        cmdShow.setText("Show Current Stock");
        cmdShow.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdShowActionPerformed(evt);
            }
        });

        jPanel1.add(cmdShow);
        cmdShow.setBounds(92, 133, 180, 25);

        cmdShow1.setText("Show Item History");
        cmdShow1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdShow1ActionPerformed(evt);
            }
        });

        jPanel1.add(cmdShow1);
        cmdShow1.setBounds(280, 133, 160, 25);

        lblLocation.setText(".");
        jPanel1.add(lblLocation);
        lblLocation.setBounds(197, 75, 172, 18);

        jLabel4.setFont(new java.awt.Font("Default", 1, 12));
        jLabel4.setText("On Hand");
        jPanel1.add(jLabel4);
        jLabel4.setBounds(14, 167, 68, 15);

        jPanel1.add(txtOnHand);
        txtOnHand.setBounds(92, 166, 114, 19);

        jPanel1.add(txtAllocated);
        txtAllocated.setBounds(92, 187, 114, 19);

        jLabel5.setFont(new java.awt.Font("Default", 1, 12));
        jLabel5.setText("Allocated");
        jPanel1.add(jLabel5);
        jLabel5.setBounds(11, 189, 68, 15);

        jLabel6.setFont(new java.awt.Font("Default", 1, 12));
        jLabel6.setText("Available");
        jPanel1.add(jLabel6);
        jLabel6.setBounds(11, 213, 68, 15);

        jPanel1.add(txtAvailable);
        txtAvailable.setBounds(92, 210, 114, 19);

        jLabel7.setDisplayedMnemonic('I');
        jLabel7.setLabelFor(txtItemID);
        jLabel7.setText("As On");
        jPanel1.add(jLabel7);
        jLabel7.setBounds(41, 108, 48, 15);

        jPanel1.add(txtAsOnDate);
        txtAsOnDate.setBounds(90, 106, 102, 19);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(6, 38, 650, 240);

    }//GEN-END:initComponents
    
    private void cmdShow1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdShow1ActionPerformed
        // TODO add your handling code here:
        try {
            String lItemID=txtItemID.getText();
            
            EITLERPGLOBAL.ChangeCursorToWait(this);
            frmItemHistory ObjItem=new frmItemHistory();
            ObjItem.ShowForm(lItemID);
            EITLERPGLOBAL.ChangeCursorToDefault(this);
        }
        catch(Exception e)
        {}
    }//GEN-LAST:event_cmdShow1ActionPerformed
    
    private void cmbWareHouseFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_cmbWareHouseFocusGained
        // TODO add your handling code here:
        SelWareHouseID=EITLERPGLOBAL.getCombostrCode(cmbWareHouse);
    }//GEN-LAST:event_cmbWareHouseFocusGained
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
    }//GEN-LAST:event_formMouseClicked
    
    private void cmdShowActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdShowActionPerformed
        // TODO add your handling code here:]
        try {
            SelWareHouseID=EITLERPGLOBAL.getCombostrCode(cmbWareHouse);
            String SelItemID=txtItemID.getText();
            
            if(txtAsOnDate.getText().trim().equals(""))
            {
               JOptionPane.showMessageDialog(null,"Please enter date");
               return;
            }

            if (clsItem.IsOneTime(EITLERPGLOBAL.gCompanyID, txtItemID.getText().trim())) {
               JOptionPane.showMessageDialog(null,"Cannot display Stock of one time item.");
               return;
            }
            
            clsStockInfo objStock=(new clsItemStock()).getOnHandQtyOn(EITLERPGLOBAL.gCompanyID,SelItemID,EITLERPGLOBAL.formatDateDB(txtAsOnDate.getText()));
            double OnHand=objStock.StockQty;
            double Allocated=clsItem.getAllocatedQty(EITLERPGLOBAL.gCompanyID, SelItemID);
            double Available=OnHand;
            
            //Showing Current Stock Information
            txtOnHand.setText(Double.toString(OnHand));
            txtAllocated.setText(Double.toString(Allocated));
            txtAvailable.setText(Double.toString(Available));
        }
        catch(Exception e) {
            
        }
    }//GEN-LAST:event_cmdShowActionPerformed
    
    private void txtItemIDFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtItemIDFocusLost
        // TODO add your handling code here:
        txtItemName.setText(clsItem.getItemName(EITLERPGLOBAL.gCompanyID,txtItemID.getText()));
        
        //Set appropriate warehouse
        EITLERPGLOBAL.setComboIndex(cmbWareHouse, clsItem.getItemWareHouseID(EITLERPGLOBAL.gCompanyID, txtItemID.getText()));
        lblLocation.setText(clsItem.getItemLocationID(EITLERPGLOBAL.gCompanyID, txtItemID.getText()));
        
    }//GEN-LAST:event_txtItemIDFocusLost
    
    private void txtItemIDKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtItemIDKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==112) //F1 Key pressed
        {
            LOV aList=new LOV();
            
            aList.SQL="SELECT ITEM_ID,ITEM_DESCRIPTION FROM D_INV_ITEM_MASTER WHERE COMPANY_ID="+EITLERPGLOBAL.gCompanyID+" AND APPROVED=1 AND CANCELLED=0 ORDER BY ITEM_ID";
            aList.ReturnCol=1;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=2;
            
            if(aList.ShowLOV()) {
                txtItemID.setText(aList.ReturnVal);
                txtItemName.setText(clsItem.getItemName(EITLERPGLOBAL.gCompanyID,aList.ReturnVal));
                lblLocation.setText(clsItem.getItemLocationID(EITLERPGLOBAL.gCompanyID, aList.ReturnVal));
            }
        }
    }//GEN-LAST:event_txtItemIDKeyPressed
    
    private void cmbWareHouseItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cmbWareHouseItemStateChanged
        // TODO add your handling code here:
        SelWareHouseID=EITLERPGLOBAL.getCombostrCode(cmbWareHouse);
    }//GEN-LAST:event_cmbWareHouseItemStateChanged
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox cmbWareHouse;
    private javax.swing.JButton cmdShow;
    private javax.swing.JButton cmdShow1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JLabel lblLocation;
    private javax.swing.JTextField txtAllocated;
    private javax.swing.JTextField txtAsOnDate;
    private javax.swing.JTextField txtAvailable;
    private javax.swing.JTextField txtItemID;
    private javax.swing.JTextField txtItemName;
    private javax.swing.JTextField txtOnHand;
    // End of variables declaration//GEN-END:variables
    
    private void GenerateCombo() {
        HashMap List=new HashMap();
        
        //----- Generate cmbWareHouse ------- //
        cmbWareHouseModel=new EITLComboModel();
        cmbWareHouse.removeAllItems();
        cmbWareHouse.setModel(cmbWareHouseModel);
        
        List=clsWarehouse.getList(" WHERE COMPANY_ID="+Long.toString(EITLERPGLOBAL.gCompanyID));
        for(int i=1;i<=List.size();i++) {
            clsWarehouse ObjWareHouse=(clsWarehouse) List.get(Integer.toString(i));
            ComboData aData=new ComboData();
            aData.strCode=(String)ObjWareHouse.getAttribute("WAREHOUSE_ID").getObj();
            aData.Text=(String)ObjWareHouse.getAttribute("WAREHOUSE_NAME").getObj();
            cmbWareHouseModel.addElement(aData);
        }
        //------------------------------ //
        
    }
    
}
