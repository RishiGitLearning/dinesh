/*
 * frmRptDeptWiseComparison.java
 *
 * Created on March 20, 2010, 2:36 PM
 */

package EITLERP.Stores;

import EITLERP.*;
import java.sql.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import TReportWriter.*;
import java.util.*;
import javax.swing.*;
/**
 *
 * @author  root
 */
public class frmRptDeptWiseComparison extends javax.swing.JApplet {
    
    private EITLComboModel cmbFirstYearModel=new EITLComboModel();
    private EITLComboModel cmbSecondYearModel=new EITLComboModel();
    
    private TReportEngine objEngine=new TReportEngine();
    private TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
    
    /** Initializes the applet frmRptDeptWiseComparison */
    public void init() {
        setSize(400,200);
        initComponents();
        GenerateCombo();
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        cmbFirstYear = new javax.swing.JComboBox();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        cmbSecondYear = new javax.swing.JComboBox();
        cmdpreview = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();

        getContentPane().setLayout(null);

        getContentPane().add(cmbFirstYear);
        cmbFirstYear.setBounds(110, 50, 120, 24);

        jLabel2.setText("First Year :");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(30, 50, 66, 15);

        jLabel3.setText("Second Year :");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(10, 90, 90, 15);

        getContentPane().add(cmbSecondYear);
        cmbSecondYear.setBounds(110, 90, 120, 24);

        cmdpreview.setText("Preview");
        cmdpreview.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdpreviewActionPerformed(evt);
            }
        });

        getContentPane().add(cmdpreview);
        cmdpreview.setBounds(290, 120, 82, 25);

        jLabel1.setBackground(new java.awt.Color(0, 51, 255));
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("COMPARISION OF DEPARTMENT WISE STORES & SPARES");
        jLabel1.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel1.setOpaque(true);
        getContentPane().add(jLabel1);
        jLabel1.setBounds(0, 0, 400, 27);

    }//GEN-END:initComponents
    
    private void cmdpreviewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdpreviewActionPerformed
        // TODO add your handling code here:
        GenerateReport();
    }//GEN-LAST:event_cmdpreviewActionPerformed
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox cmbFirstYear;
    private javax.swing.JComboBox cmbSecondYear;
    private javax.swing.JButton cmdpreview;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    // End of variables declaration//GEN-END:variables
    private void GenerateReport() {
        
        try {
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            String Condition = "";
            if(EITLERPGLOBAL.gCompanyID==2) {
                Condition = " AND (B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%' OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '4%' " +
                "OR B.ITEM_CODE LIKE '5%' OR B.ITEM_CODE LIKE '6%' OR B.ITEM_CODE LIKE '7%' OR B.ITEM_CODE LIKE '8%' OR B.ITEM_CODE LIKE '90%' " +
                "OR B.ITEM_CODE LIKE '91%' OR B.ITEM_CODE LIKE '92%' OR B.ITEM_CODE LIKE '93%'  OR B.ITEM_CODE LIKE '94%' OR B.ITEM_CODE LIKE '95%') ";
            }
            
            if(EITLERPGLOBAL.gCompanyID==3) {
                Condition = " AND (B.ITEM_CODE LIKE '10%' OR B.ITEM_CODE LIKE '20%' OR B.ITEM_CODE LIKE '30%' OR B.ITEM_CODE LIKE '40%' " +
                "OR B.ITEM_CODE LIKE '50%' OR B.ITEM_CODE LIKE '60%' OR B.ITEM_CODE LIKE '70%' OR B.ITEM_CODE LIKE '80%' OR B.ITEM_CODE LIKE '81%' " +
                "OR B.ITEM_CODE LIKE '95%' OR B.ITEM_CODE LIKE '96%' OR B.ITEM_CODE LIKE '98%' ) ";
            }
            
            objReportData.AddColumn("DEPT");
            objReportData.AddColumn("APR1");
            objReportData.AddColumn("APR2");
            objReportData.AddColumn("MAY1");
            objReportData.AddColumn("MAY2");
            objReportData.AddColumn("JUN1");
            objReportData.AddColumn("JUN2");
            objReportData.AddColumn("QTR11");
            objReportData.AddColumn("QTY12");
            objReportData.AddColumn("JULY1");
            objReportData.AddColumn("JULY2");
            objReportData.AddColumn("AUG1");
            objReportData.AddColumn("AUG2");
            objReportData.AddColumn("SEP1");
            objReportData.AddColumn("SEP2");
            objReportData.AddColumn("QTR21");
            objReportData.AddColumn("QTR22");
            objReportData.AddColumn("OCT1");
            objReportData.AddColumn("OCT2");
            objReportData.AddColumn("NOV1");
            objReportData.AddColumn("NOV2");
            objReportData.AddColumn("DEC1");
            objReportData.AddColumn("DEC2");
            objReportData.AddColumn("QTR31");
            objReportData.AddColumn("QTR32");
            objReportData.AddColumn("JAN1");
            objReportData.AddColumn("JAN2");
            objReportData.AddColumn("FEB1");
            objReportData.AddColumn("FEB2");
            objReportData.AddColumn("MAR1");
            objReportData.AddColumn("MAR2");
            objReportData.AddColumn("QTR41");
            objReportData.AddColumn("QTR42");
            objReportData.AddColumn("TOTAL");
            
            
            
            
            
            
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            
            objOpeningRow.setValue("DEPT","");
            objOpeningRow.setValue("APR1","");
            objOpeningRow.setValue("APR2","");
            objOpeningRow.setValue("MAY1","");
            objOpeningRow.setValue("MAY2","");
            objOpeningRow.setValue("JUN1","");
            objOpeningRow.setValue("JUN2","");
            objOpeningRow.setValue("QTR11","");
            objOpeningRow.setValue("QTY12","");
            objOpeningRow.setValue("JULY1","");
            objOpeningRow.setValue("JULY2","");
            objOpeningRow.setValue("AUG1","");
            objOpeningRow.setValue("AUG2","");
            objOpeningRow.setValue("SEP1","");
            objOpeningRow.setValue("SEP2","");
            objOpeningRow.setValue("QTR21","");
            objOpeningRow.setValue("QTR22","");
            objOpeningRow.setValue("OCT1","");
            objOpeningRow.setValue("OCT2","");
            objOpeningRow.setValue("NOV1","");
            objOpeningRow.setValue("NOV2","");
            objOpeningRow.setValue("DEC1","");
            objOpeningRow.setValue("DEC2","");
            objOpeningRow.setValue("QTR31","");
            objOpeningRow.setValue("QTR32","");
            objOpeningRow.setValue("JAN1","");
            objOpeningRow.setValue("JAN2","");
            objOpeningRow.setValue("FEB1","");
            objOpeningRow.setValue("FEB2","");
            objOpeningRow.setValue("MAR1","");
            objOpeningRow.setValue("MAR2","");
            objOpeningRow.setValue("QTR41","");
            objOpeningRow.setValue("QTR42","");
            objOpeningRow.setValue("TOTAL","");
            
            
            
            
            
            
            
            
            /*objRow=objReportData.newRow();
             
            objRow.setValue("SR_NO","1");
             
             
             
            objReportData.AddRow(objRow);
             */
            
            
            String FirstYear = String.valueOf(EITLERPGLOBAL.getComboCode(cmbFirstYear));
            String SecondYear = String.valueOf(EITLERPGLOBAL.getComboCode(cmbSecondYear));
            
            
            if(FirstYear.equals(SecondYear)) {
                JOptionPane.showMessageDialog(null,"First Year & Sceond Year can not be same");
                return ;
            }
            
            if(Integer.parseInt(FirstYear) > Integer.parseInt(SecondYear)) {
                int t = Integer.parseInt(SecondYear);
                SecondYear = FirstYear;
                FirstYear = String.valueOf(t);
            }
            
            String FirstYear1 = FirstYear.substring(0,4);
            String FirstYear2 = FirstYear.substring(4,8);
            
            String SecondYear1 = SecondYear.substring(0,4);
            String SecondYear2 = SecondYear.substring(4,8);
            
            String strQry="";
            String strQry1="";
            String strQry2="";
            
            
            double AprilFirst=0.0,AprilSecond=0.0;
            double MayFirst=0.0,MaySecond=0.0;
            double JuneFirst=0.0,JuneSecond=0.0;
            double JulyFirst=0.0,JulySecond=0.0;
            double AugFirst=0.0,AugSecond=0.0;
            double SepFirst=0.0,SepSecond=0.0;
            double OctFirst=0.0,OctSecond=0.0;
            double NovFirst=0.0,NovSecond=0.0;
            double DecFirst=0.0,DecSecond=0.0;
            double JanFirst=0.0,JanSecond=0.0;
            double FebFirst=0.0,FebSecond=0.0;
            double MarFirst=0.0,MarSecond=0.0;
            double FirstQtr1=0.0,FirstQtr2=0.0;
            double SecondQtr1=0.0,SecondQtr2=0.0;
            double ThirdQtr1=0.0,ThirdQtr2=0.0;
            double FourthQtr1=0.0,FourthQtr2=0.0;
            
            
            strQry="SELECT  DISTINCT DEPT_ID,DEPT_DESC FROM D_COM_DEPT_COST_CENTER_MAPPING "+
            "WHERE COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " AND APPROVED= 1 AND CANCELLED = 0 ORDER BY DEPT_ID";
            ResultSet rsDept = data.getResult(strQry);
            rsDept.first();
            
            while(!rsDept.isAfterLast()) {
                
                objRow=objReportData.newRow();
                
                String DeptId= rsDept.getString("DEPT_ID");
                String DeptName= rsDept.getString("DEPT_DESC");
                objRow.setValue("DEPT",DeptName);
                
                
                AprilFirst=0.0;
                AprilSecond=0.0;
                MayFirst=0.0;
                MaySecond=0.0;
                JuneFirst=0.0;
                JuneSecond=0.0;
                
                JulyFirst=0.0;
                JulySecond=0.0;
                AugFirst=0.0;
                AugSecond=0.0;
                SepFirst=0.0;
                SepSecond=0.0;
                
                OctFirst=0.0;
                OctSecond=0.0;
                NovFirst=0.0;
                NovSecond=0.0;
                DecFirst=0.0;
                DecSecond=0.0;
                
                JanFirst=0.0;
                JanSecond=0.0;
                FebFirst=0.0;
                FebSecond=0.0;
                MarFirst=0.0;
                MarSecond=0.0;
                
                FirstQtr1=0.0;
                FirstQtr2=0.0;
                SecondQtr1=0.0;
                SecondQtr2=0.0;
                ThirdQtr1=0.0;
                ThirdQtr2=0.0;
                FourthQtr1=0.0;
                FourthQtr2=0.0;
                if(!DeptId.equals("30")) {
                    strQry="SELECT COST_CENTER_ID FROM D_COM_DEPT_COST_CENTER_MAPPING "+
                    "WHERE COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " AND DEPT_ID = " + DeptId + " ";
                }
                else{
                    strQry="SELECT COST_CENTER_ID FROM D_COM_DEPT_COST_CENTER_MAPPING "+
                    "WHERE COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " AND DEPT_ID <> 30";
                }
                ResultSet rsCostCenter = data.getResult(strQry);
                rsCostCenter.first();
                
                String CostCenterId="D.COST_CENTER_ID ";
                
                if(DeptId.equals("30")) {
                    CostCenterId += "NOT IN ";
                }
                else {
                    CostCenterId += "IN ";
                }
                
                CostCenterId += "(";
                while(!rsCostCenter.isAfterLast()) {
                    
                    if(!rsCostCenter.isLast()) {
                        CostCenterId += rsCostCenter.getString("COST_CENTER_ID") + ",";
                    }
                    else{
                        CostCenterId += rsCostCenter.getString("COST_CENTER_ID");
                    }
                    rsCostCenter.next();
                }
                
                CostCenterId +=")";
                
                String CostCenterIdNotIn="";
                if(EITLERPGLOBAL.gCompanyID==2) {
                    CostCenterIdNotIn = "D.COST_CENTER_ID NOT IN (1181,1999,2999,3999) ";
                }
                if(EITLERPGLOBAL.gCompanyID==3) {
                    CostCenterIdNotIn = " D.COST_CENTER_ID NOT IN (5101,5111,5999) AND D.COST_CENTER_ID NOT LIKE '4%' ";
                }
                
                String day = "01";
                int month = EITLERPGLOBAL.getCurrentMonth();
                int year = EITLERPGLOBAL.getCurrentYear();
                int days = EITLERPGLOBAL.getCurrentDay();
                String CurrentDatet = EITLERPGLOBAL.getCurrentDateDB().substring(0,8)+"01";
                String CurrentDate = EITLERPGLOBAL.getCurrentDateDB();
                for(int i=4 ;i<=12;i++) {
                    
                    //if(year == Integer.parseInt(SecondYear1) & i == month) {
                    
                    /*if(year == Integer.parseInt(SecondYear1) & i >= month) {
                        continue;
                    }*/
                    
                    String CheckDate = SecondYear1 +"-" + EITLERPGLOBAL.padLeftEx(Integer.toString(i), "0", 2)+"-01";
                    if(java.sql.Date.valueOf(CurrentDate).before(java.sql.Date.valueOf(CheckDate)) || java.sql.Date.valueOf(CurrentDatet).compareTo(java.sql.Date.valueOf(CheckDate))==0) {
                        continue;
                    }
                    
                    strQry1="SELECT ROUND(SUM(B.ISSUE_VALUE),0) AS VALUE "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " " +
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+i+" AND YEAR(A.ISSUE_DATE) = "+FirstYear1+"  "+ Condition;
                    
                                        
                    /*strQry1="SELECT SUM(VALUE) FROM "+
                    "(SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " " +
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+i+" AND YEAR(A.ISSUE_DATE) = "+FirstYear1+"  "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')  GROUP BY COST_CENTER_ID "+
                    ") T ";*/
                    /*"UNION "+
                    "SELECT 0 AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+i+" AND YEAR(A.ISSUE_DATE) = "+FirstYear1+"  "+
                    "AND ( B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')AND B.COST_CENTER_ID NOT IN ( SELECT B.COST_CENTER_ID FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO AND A.CANCELED=0 AND A.APPROVED=1 AND A.ISSUE_DATE>='2007-04-01' AND A.ISSUE_DATE<='2007-10-31' AND ( B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%' "+
                    "OR B.ITEM_CODE LIKE '93%'))ORDER BY COST_CENTER_ID" +
                    ") T ";*/
                    
                    /*strQry1="SELECT SUM(T.VALUE) FROM ( "+
                    "SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND MONTH(A.ISSUE_DATE) = " + i + "  AND YEAR(A.ISSUE_DATE) = "+FirstYear1+" "+
                    "AND " + CostCenterId + " "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%' "+
                    "OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%' "+
                    "OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%') "+
                    "GROUP BY B.COST_CENTER_ID ) T";
                     */
                    
                    //if(!EITLERPGLOBAL.isWithinDate(year+ "-" + EITLERPGLOBAL.padLeftEx(Integer.toString(month), "0", 2) +"-01",Integer.parseInt(SecondYear1))) {
                    strQry2="SELECT ROUND(SUM(B.ISSUE_VALUE),0) AS VALUE "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " " +
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+i+" AND YEAR(A.ISSUE_DATE) = "+SecondYear1+"  "+ Condition;
                    
                    /*
                    "AND (B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%' OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%' OR B.ITEM_CODE " +
                    "LIKE '6%' OR B.ITEM_CODE LIKE '7%' OR B.ITEM_CODE LIKE '8%' OR B.ITEM_CODE LIKE '90%' OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%' OR B.ITEM_CODE LIKE '94%' OR B.ITEM_CODE LIKE '91%' OR B.ITEM_CODE LIKE '92%' OR B.ITEM_CODE LIKE '93%') ";
                     */
                    
                    /*strQry2="SELECT SUM(VALUE) FROM "+
                    "(SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+i+" AND YEAR(A.ISSUE_DATE) = "+SecondYear1+"  "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')  GROUP BY COST_CENTER_ID "+
                    ") T ";*/
                    /*"UNION "+
                    "SELECT 0 AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+i+" AND YEAR(A.ISSUE_DATE) = "+SecondYear1+"  "+
                    "AND ( B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')AND B.COST_CENTER_ID NOT IN ( SELECT B.COST_CENTER_ID FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO AND A.CANCELED=0 AND A.APPROVED=1 AND A.ISSUE_DATE>='2007-04-01' AND A.ISSUE_DATE<='2007-10-31' AND ( B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%' "+
                    "OR B.ITEM_CODE LIKE '93%'))ORDER BY COST_CENTER_ID" +
                    ") T ";*/
                    
                    /*strQry2="SELECT SUM(T.VALUE) FROM ( "+
                    "SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND MONTH(A.ISSUE_DATE) = " + i + "  AND YEAR(A.ISSUE_DATE) = "+SecondYear1+" "+
                    "AND "+ CostCenterId + " "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%' "+
                    "OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%' "+
                    "OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%') "+
                    "GROUP BY B.COST_CENTER_ID ) T";
                     */
                    if(i==4) {
                        AprilFirst+=data.getDoubleValueFromDB(strQry1);
                        AprilSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        FirstQtr1+=AprilFirst;
                        FirstQtr2+=AprilSecond;
                    }
                    else if(i==5) {
                        MayFirst+=data.getDoubleValueFromDB(strQry1);
                        MaySecond+=data.getDoubleValueFromDB(strQry2);
                        
                        FirstQtr1+=MayFirst;
                        FirstQtr2+=MaySecond;
                    }
                    else if(i==6) {
                        JuneFirst+=data.getDoubleValueFromDB(strQry1);
                        JuneSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        FirstQtr1+=JuneFirst;
                        FirstQtr2+=JuneSecond;
                    }
                    else if(i==7) {
                        JulyFirst+=data.getDoubleValueFromDB(strQry1);
                        JulySecond+=data.getDoubleValueFromDB(strQry2);
                        
                        SecondQtr1+=JulyFirst;
                        SecondQtr2+=JulySecond;
                    }
                    else if(i==8) {
                        AugFirst+=data.getDoubleValueFromDB(strQry1);
                        AugSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        SecondQtr1+=AugFirst;
                        SecondQtr2+=AugSecond;
                    }
                    else if(i==9) {
                        SepFirst+=data.getDoubleValueFromDB(strQry1);
                        SepSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        SecondQtr1+=SepFirst;
                        SecondQtr2+=SepSecond;
                    }
                    else if(i==10) {
                        OctFirst+=data.getDoubleValueFromDB(strQry1);
                        OctSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        ThirdQtr1 +=OctFirst;
                        ThirdQtr2 +=OctSecond;
                    }
                    else if(i==11) {
                        NovFirst+=data.getDoubleValueFromDB(strQry1);
                        NovSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        ThirdQtr1 +=NovFirst;
                        ThirdQtr2 +=NovSecond;
                    }
                    else if(i==12) {
                        DecFirst+=data.getDoubleValueFromDB(strQry1);
                        DecSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        ThirdQtr1 +=DecFirst;
                        ThirdQtr2 +=DecSecond;
                    }
                    
                }
                
                
                for(int j=1 ;j<=3;j++) {
                    
                    //if(month != j) {
                    /*if(year == Integer.parseInt(SecondYear2) & j <= month) {
                        continue;
                    }*/
                    String CheckDate = SecondYear2 +"-" + EITLERPGLOBAL.padLeftEx(Integer.toString(j), "0", 2)+"-01";
                    /*if(java.sql.Date.valueOf(CurrentDate).before(java.sql.Date.valueOf(CheckDate))) {
                        continue;
                    }*/
                    if(java.sql.Date.valueOf(CurrentDate).before(java.sql.Date.valueOf(CheckDate)) || java.sql.Date.valueOf(CurrentDatet).compareTo(java.sql.Date.valueOf(CheckDate))==0) {
                        continue;
                    }
                    
                    strQry1="SELECT ROUND(SUM(B.ISSUE_VALUE),0) AS VALUE "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON (D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON (C.ITEM_ID=B.ITEM_CODE) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " " +
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+j+" AND YEAR(A.ISSUE_DATE) = "+FirstYear2+"  "+ Condition;
                    
                    
                    /*
                    "AND (B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%' OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%' " +
                    "OR B.ITEM_CODE LIKE '6%' OR B.ITEM_CODE LIKE '7%' OR B.ITEM_CODE LIKE '8%' OR B.ITEM_CODE LIKE '90%' OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%' OR B.ITEM_CODE LIKE '94%' OR B.ITEM_CODE LIKE '91%' OR B.ITEM_CODE LIKE '92%' OR B.ITEM_CODE LIKE '93%') ";
                     */
                    
                    /*strQry1="SELECT SUM(VALUE) FROM "+
                    "(SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+j+" AND YEAR(A.ISSUE_DATE) = "+FirstYear2+"  "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')  GROUP BY COST_CENTER_ID "+
                    ") T ";*/
                    /*"UNION "+
                    "SELECT 0 AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+j+" AND YEAR(A.ISSUE_DATE) = "+FirstYear2+"  "+
                    "AND ( B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')AND B.COST_CENTER_ID NOT IN ( SELECT B.COST_CENTER_ID FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO AND A.CANCELED=0 AND A.APPROVED=1 AND A.ISSUE_DATE>='2007-04-01' AND A.ISSUE_DATE<='2007-10-31' AND ( B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%' "+
                    "OR B.ITEM_CODE LIKE '93%'))ORDER BY COST_CENTER_ID" +
                    ") T ";
                     */
                    /*strQry1="SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND MONTH(A.ISSUE_DATE) = " + j + "  AND YEAR(A.ISSUE_DATE) = "+FirstYear2+" "+
                    "AND B.COST_CENTER_ID IN " + CostCenterId + " "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%' "+
                    "OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%' "+
                    "OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%') "+
                    "GROUP BY B.COST_CENTER_ID";
                     */
                    
                    strQry2="SELECT ROUND(SUM(B.ISSUE_VALUE),0) AS VALUE "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " " +
                    "AND "+ CostCenterIdNotIn+" "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+j+" AND YEAR(A.ISSUE_DATE) = "+SecondYear2+"  "+ Condition;
                    
                    /*
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%') ";
                     */
                    
                    
                    /*strQry2="SELECT SUM(VALUE) FROM "+
                    "(SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+j+" AND YEAR(A.ISSUE_DATE) = "+SecondYear2+"  "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')  GROUP BY COST_CENTER_ID "+
                    ") T ";*/
                    /*"UNION "+
                    "SELECT 0 AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND " + CostCenterId + " "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND A.COMPANY_ID ="+EITLERPGLOBAL.gCompanyID+" "+
                    "AND MONTH(A.ISSUE_DATE) = "+j+" AND YEAR(A.ISSUE_DATE) = "+SecondYear2+"  "+
                    "AND ( B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%')AND B.COST_CENTER_ID NOT IN ( SELECT B.COST_CENTER_ID FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO AND A.CANCELED=0 AND A.APPROVED=1 AND A.ISSUE_DATE>='2007-04-01' AND A.ISSUE_DATE<='2007-10-31' AND ( B.ITEM_CODE LIKE '1%' OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%'OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%' "+
                    "OR B.ITEM_CODE LIKE '4%'OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%' "+
                    "OR B.ITEM_CODE LIKE '93%'))ORDER BY COST_CENTER_ID" +
                    ") T ";*/
                    /*strQry2="SELECT SUM(B.ISSUE_VALUE) AS VALUE, B.COST_CENTER_ID AS CCID, D.COST_CENTER_NAME AS CCNAME,B.COST_CENTER_ID "+
                    "FROM D_INV_ISSUE_HEADER A, D_INV_ISSUE_DETAIL B "+
                    "LEFT JOIN D_COM_COST_CENTER D ON ( D.COST_CENTER_ID= B.COST_CENTER_ID) "+
                    "LEFT JOIN D_INV_ITEM_MASTER C ON ( C.ITEM_ID=B.ITEM_CODE ) "+
                    "WHERE A.ISSUE_NO=B.ISSUE_NO  "+
                    "AND A.CANCELED=0 AND A.APPROVED=1 "+
                    "AND MONTH(A.ISSUE_DATE) = " + j + "  AND YEAR(A.ISSUE_DATE) = "+SecondYear2+" "+
                    "AND B.COST_CENTER_ID IN "+ CostCenterId + " "+
                    "AND (B.ITEM_CODE LIKE '1%'OR B.ITEM_CODE LIKE '2%'OR B.ITEM_CODE LIKE '3%' OR B.ITEM_CODE LIKE '5%'OR B.ITEM_CODE LIKE '6%' "+
                    "OR B.ITEM_CODE LIKE '7%'OR B.ITEM_CODE LIKE '8%'OR B.ITEM_CODE LIKE '90%'OR B.ITEM_CODE LIKE '95%'OR B.ITEM_CODE LIKE '4%' "+
                    "OR B.ITEM_CODE LIKE '94%'OR B.ITEM_CODE LIKE '91%'OR B.ITEM_CODE LIKE '92%'OR B.ITEM_CODE LIKE '93%') "+
                    "GROUP BY B.COST_CENTER_ID";
                     */
                    if(j==1) {
                        JanFirst+=data.getDoubleValueFromDB(strQry1);
                        JanSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        FourthQtr1+=JanFirst;
                        FourthQtr2+=JanSecond;
                    }
                    else if(j==2) {
                        FebFirst+=data.getDoubleValueFromDB(strQry1);
                        FebSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        FourthQtr1+=FebFirst;
                        FourthQtr2+=FebSecond;
                    }
                    else if(j==3) {
                        MarFirst+=data.getDoubleValueFromDB(strQry1);
                        MarSecond+=data.getDoubleValueFromDB(strQry2);
                        
                        FourthQtr1+=MarFirst;
                        FourthQtr2+=MarSecond;
                    }
                    //}
                }
                
                
               /* if(AprilSecond ==0) {
                    AprilFirst=0;
                }
                if(MaySecond ==0) {
                    MayFirst=0;
                }
                if(JuneSecond ==0) {
                    JuneFirst=0;
                }*/
                objRow.setValue("APR1",String.valueOf(EITLERPGLOBAL.round(AprilFirst,0)));
                objRow.setValue("APR2",String.valueOf(EITLERPGLOBAL.round(AprilSecond,0)));
                objRow.setValue("MAY1",String.valueOf(EITLERPGLOBAL.round(MayFirst,0)));
                objRow.setValue("MAY2",String.valueOf(EITLERPGLOBAL.round(MaySecond,0)));
                objRow.setValue("JUN1",String.valueOf(EITLERPGLOBAL.round(JuneFirst,0)));
                objRow.setValue("JUN2",String.valueOf(EITLERPGLOBAL.round(JuneSecond,0)));
                objRow.setValue("QTR11",String.valueOf(EITLERPGLOBAL.round(FirstQtr1,0)));
                objRow.setValue("QTR12",String.valueOf(EITLERPGLOBAL.round(FirstQtr2,0)));
                
                /*if(AprilSecond == 0) {
                    AprilFirst=0;
                }
                if(MaySecond == 0) {
                    MayFirst=0;
                }
                if(JuneSecond == 0) {
                    JuneFirst=0;
                }
                 
                 
                if(JulySecond == 0) {
                    JulyFirst=0;
                }
                if(AugSecond ==0) {
                    AugFirst=0;
                }
                if( SepSecond== 0) {
                    SepFirst =0;
                }*/
                
                objRow.setValue("JULY1",String.valueOf(EITLERPGLOBAL.round(JulyFirst,0)));
                objRow.setValue("JULY2",String.valueOf(EITLERPGLOBAL.round(JulySecond,0)));
                objRow.setValue("AUG1",String.valueOf(EITLERPGLOBAL.round(AugFirst,0)));
                objRow.setValue("AUG2",String.valueOf(EITLERPGLOBAL.round(AugSecond,0)));
                objRow.setValue("SEP1",String.valueOf(EITLERPGLOBAL.round(SepFirst,0)));
                objRow.setValue("SEP2",String.valueOf(EITLERPGLOBAL.round(SepSecond,0)));
                objRow.setValue("QTR21",String.valueOf(EITLERPGLOBAL.round(SecondQtr1,0)));
                objRow.setValue("QTR22",String.valueOf(EITLERPGLOBAL.round(SecondQtr2,0)));
                
                
                objRow.setValue("OCT1",String.valueOf(EITLERPGLOBAL.round(OctFirst,0)));
                objRow.setValue("OCT2",String.valueOf(EITLERPGLOBAL.round(OctSecond,0)));
                objRow.setValue("NOV1",String.valueOf(EITLERPGLOBAL.round(NovFirst,0)));
                objRow.setValue("NOV2",String.valueOf(EITLERPGLOBAL.round(NovSecond,0)));
                objRow.setValue("DEC1",String.valueOf(EITLERPGLOBAL.round(DecFirst,0)));
                objRow.setValue("DEC2",String.valueOf(EITLERPGLOBAL.round(DecSecond,0)));
                objRow.setValue("QTR31",String.valueOf(EITLERPGLOBAL.round(ThirdQtr1,0)));
                objRow.setValue("QTR32",String.valueOf(EITLERPGLOBAL.round(ThirdQtr2,0)));
                
                
                /*if(JanSecond == 0) {
                    JanFirst=0;
                }
                 
                if(FebSecond == 0) {
                    FebFirst = 0;
                }
                 
                if(MarSecond == 0) {
                    MarFirst = 0;
                }*/
                
                objRow.setValue("JAN1",String.valueOf(EITLERPGLOBAL.round(JanFirst,0)));
                objRow.setValue("JAN2",String.valueOf(EITLERPGLOBAL.round(JanSecond,0)));
                objRow.setValue("FEB1",String.valueOf(EITLERPGLOBAL.round(FebFirst,0)));
                objRow.setValue("FEB2",String.valueOf(EITLERPGLOBAL.round(FebSecond,0)));
                objRow.setValue("MAR1",String.valueOf(EITLERPGLOBAL.round(MarFirst,0)));
                objRow.setValue("MAR2",String.valueOf(EITLERPGLOBAL.round(MarSecond,0)));
                objRow.setValue("QTR41",String.valueOf(EITLERPGLOBAL.round(FourthQtr1,0)));
                objRow.setValue("QTR42",String.valueOf(EITLERPGLOBAL.round(FourthQtr2,0)));
                
                rsDept.next();
                
                
                
                objReportData.AddRow(objRow);
                
            }
            String City="";
            if(EITLERPGLOBAL.gCompanyID==2) {
                City="BARODA";
            }
            else {
                City="ANKLESHWAR";
            }
            HashMap Parameters=new HashMap();
            Parameters.put("COMPANY_ID",Integer.toString(EITLERPGLOBAL.gCompanyID));
            Parameters.put("CITY",City);
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            Parameters.put("FIRSTYEAR1",FirstYear1.substring(2));
            Parameters.put("FIRSTYEAR2",FirstYear2.substring(2));
            Parameters.put("SECONDYEAR1",SecondYear1.substring(2));
            Parameters.put("SECONDYEAR2",SecondYear2.substring(2));
            
            if(EITLERPGLOBAL.getComboCode(cmbFirstYear) >= EITLERPGLOBAL.getComboCode(cmbSecondYear)) {
                Parameters.put("YEAR1",cmbSecondYear.getSelectedItem());
                Parameters.put("YEAR2",cmbFirstYear.getSelectedItem());
            }
            else {
                Parameters.put("YEAR1",cmbFirstYear.getSelectedItem());
                Parameters.put("YEAR2",cmbSecondYearModel.getSelectedItem());
            }
            //EITLERPGLOBAL.getCurrentMonth();
            
            if(EITLERPGLOBAL.getCurrentFinYear() < Integer.parseInt(SecondYear2)) {
                
                Parameters.put("MONTH","UPTO MONTH " + data.getStringValueFromDB("SELECT MONTHNAME(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) FROM DUAL").toUpperCase());
            }
            else {
                Parameters.put("MONTH","");
            }
            
            
            
            
            objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptDeptwiseComparison.rpt",Parameters,objReportData);
            
        }catch(Exception e) {
            e.printStackTrace();
        }
        
        //System.out.println("");
    }
    
    private void GenerateCombo() {
        
        cmbFirstYearModel=new EITLComboModel();
        cmbFirstYear.removeAll();
        cmbFirstYear.setModel(cmbFirstYearModel);
        
        
        cmbSecondYearModel=new EITLComboModel();
        cmbSecondYear.removeAll();
        cmbSecondYear.setModel(cmbSecondYearModel);
        
        String Qry = "SELECT YEAR_FROM,YEAR_TO FROM D_COM_FIN_YEAR WHERE COMPANY_ID = " + EITLERPGLOBAL.gCompanyID + " ";
        try{
            ResultSet rs = data.getResult(Qry);
            ComboData objData;
            while(rs.next()) {
                objData=new ComboData();
                objData.Code=Long.parseLong(rs.getString("YEAR_FROM")+rs.getString("YEAR_TO"));
                objData.Text=rs.getString("YEAR_FROM")+"-"+rs.getString("YEAR_TO");
                cmbFirstYearModel.addElement(objData);
                
                objData=new ComboData();
                objData.Code=Long.parseLong(rs.getString("YEAR_FROM")+rs.getString("YEAR_TO"));
                objData.Text=rs.getString("YEAR_FROM")+"-"+rs.getString("YEAR_TO");
                cmbSecondYearModel.addElement(objData);
            }
        }
        catch(Exception e) {
            
        }
    }
}
