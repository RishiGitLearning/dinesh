/*
 * frmRptGRNInfo.java
 *
 * Created on April 16, 2008, 12:01 PM
 */

package EITLERP.Sales.ReportsUI;

/**
 *
 * @author  root
 */
import EITLERP.*;
import EITLERP.Finance.*;
import EITLERP.Utils.*;
import EITLERP.Utils.SimpleDataProvider.*;
import javax.swing.*;
import java.awt.*;
import java.sql.*;
import java.net.*;
import java.util.*;
import TReportWriter.*;
import java.util.HashMap;
import java.sql.Connection;
import java.sql.Statement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.net.URL;
import javax.swing.JOptionPane;
import java.io.*;
import java.sql.ResultSet;
import javax.swing.JTable;
import EITLERP.Production.ReportUI.JTextFieldHint;


public class frmRptLC extends javax.swing.JApplet {
    
    private EITLComboModel cmbReceiptTypeModel;
    private EITLComboModel cmbReportTypeModel;
    private TReportEngine objEngine=new TReportEngine();
    private TReportWriter.SimpleDataProvider.TTable objData=new TReportWriter.SimpleDataProvider.TTable();
    private EITLTableCellRenderer RowFormat=new EITLTableCellRenderer();
    private clsExcelExporter exp = new clsExcelExporter();
    EITLTableModel DataModel= new EITLTableModel();
  //  private TReportEngine objEngine=new TReportEngine();
    
    /** Initializes the applet frmRptGRNInfo */
    
    public void init() {
        setSize(600,400);
        initComponents();
        formatGrid()  ;   // TODO add your handling code here:
        
        
    }
    
    /** This method is called from within the init() method to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jPanel3 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        TResult = new javax.swing.JTable();
        jButton2 = new javax.swing.JButton();
        txtLcOpenerCode = new javax.swing.JTextField();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();

        getContentPane().setLayout(null);

        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
        });

        jPanel3.setLayout(null);

        jPanel3.setBackground(new java.awt.Color(0, 153, 204));
        jPanel3.setBorder(new javax.swing.border.BevelBorder(javax.swing.border.BevelBorder.RAISED));
        jLabel6.setText("LC Report");
        jPanel3.add(jLabel6);
        jLabel6.setBounds(20, 10, 230, 15);

        getContentPane().add(jPanel3);
        jPanel3.setBounds(0, 0, 580, 30);

        jLabel1.setText("LC Opener Code");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(10, 40, 110, 15);

        jButton1.setText("Show Selected LC Opener Party List ");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton1);
        jButton1.setBounds(260, 40, 300, 25);

        jScrollPane1.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        TResult.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        TResult.getTableHeader().setFont(new Font("Plain", Font.BOLD, 12));
        jScrollPane1.setViewportView(TResult);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(20, 100, 550, 200);

        jButton2.setText("Excel To Export");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton2);
        jButton2.setBounds(430, 310, 140, 25);

        txtLcOpenerCode = new JTextFieldHint(new JTextField(),"Search by F1");
        txtLcOpenerCode.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtLcOpenerCodeFocusLost(evt);
            }
        });
        txtLcOpenerCode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtLcOpenerCodeKeyPressed(evt);
            }
        });

        getContentPane().add(txtLcOpenerCode);
        txtLcOpenerCode.setBounds(130, 40, 120, 19);

        jButton3.setText("Lc Opener/Parties  Register");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton3);
        jButton3.setBounds(20, 310, 240, 25);

        jButton4.setText("Nearest Expiry Date");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton4);
        jButton4.setBounds(270, 310, 156, 25);

        jButton5.setText("Show All LC Opener Parties List ");
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton5);
        jButton5.setBounds(260, 70, 300, 25);

        jButton6.setText("All Lc Opener/Parties Register ");
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton6);
        jButton6.setBounds(20, 340, 240, 25);

    }//GEN-END:initComponents

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
        AllLCReport();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton6ActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
                formatGrid();   // TODO add your handling code here:
               ShowAll();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
            formatGrid();
            NerestExpDate();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
       GenerateReport1();//  GenerateReport1();
    }//GEN-LAST:event_jButton3ActionPerformed

    private void txtLcOpenerCodeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtLcOpenerCodeFocusLost
      try{
            if(!txtLcOpenerCode.getText().equals("")){
                String strSQL="";
                ResultSet rsTmp;
                strSQL= "";
                strSQL+="SELECT LCO_OPENER_CODE,LCO_OPENER_NAME FROM DINESHMILLS.D_SAL_LC_OPENER_MASTER WHERE LCO_OPENER_CODE = "+txtLcOpenerCode.getText().trim()+"";
                rsTmp=data.getResult(strSQL);
                rsTmp.first();
                txtLcOpenerCode.setText(rsTmp.getString("LCO_OPENER_CODE"));
                
            }
        }
        catch(Exception e){
            // TODO add your handling code here:
        }
    }//GEN-LAST:event_txtLcOpenerCodeFocusLost

    private void txtLcOpenerCodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtLcOpenerCodeKeyPressed
     if(evt.getKeyCode()==112) //F1 Key pressed
        {
            LOV aList=new LOV();
            
            aList.SQL="SELECT LCO_OPENER_CODE,LCO_OPENER_NAME FROM DINESHMILLS.D_SAL_LC_OPENER_MASTER";
            aList.ReturnCol=1;
            aList.ShowReturnCol=true;
            aList.DefaultSearchOn=1;
            //aList.DefaultSearchOn=1;
            
            if(aList.ShowLOV()) {
                txtLcOpenerCode.setText(aList.ReturnVal);
               
            }
        }
        // TODO add your handling code here:        
    }//GEN-LAST:event_txtLcOpenerCodeKeyPressed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
          try{
            
           exp.fillData(TResult,new File("/root/Desktop/LC_Report.xls"));
            //exp.fillData(TableI,new File("C://ProductionProcess.xls"));
            exp.fillData(TResult,new File("D://LC_Report.xls"));
            JOptionPane.showMessageDialog(null, "Data saved at " +
            //"'C: \\ result.xls' successfully", "Message",
           "'/root/Desktop/LC_Report.xls' successfully in Linux PC or 'D://LC_Report.xls' successfully in Windows PC    ", "Message",
            JOptionPane.INFORMATION_MESSAGE);
        }
        catch(Exception ex) {
            ex.printStackTrace();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
               formatGrid()  ;   // TODO add your handling code here:
               GenerateReport();
    }//GEN-LAST:event_jButton1ActionPerformed
    
    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_formMouseClicked
        
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable TResult;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextField txtLcOpenerCode;
    // End of variables declaration//GEN-END:variables
    
    private void GenerateReport() {
        try {
           
          
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
           /* 
            objReportData.AddColumn("LC_OPENER_CODE");
            objReportData.AddColumn("PARTY_CODE");
            objReportData.AddColumn("EXP_DATE");
            objReportData.AddColumn("IND");
            objReportData.AddColumn("DISC");
            objReportData.AddColumn("BNKHUN");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("ADDRESS");
            objReportData.AddColumn("AMT");
            objReportData.AddColumn("BANK_NAME");
            objReportData.AddColumn("BANK_CITY");
            objReportData.AddColumn("LOCALBANK");
            objReportData.AddColumn("LOCADD2");
            objReportData.AddColumn("INST1");
            objReportData.AddColumn("PARTY_STATUS");
            
            
          
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            objOpeningRow.setValue("LC_OPENER_CODE","");
            objOpeningRow.setValue("PARTY_CODE","");
            objOpeningRow.setValue("EXP_DATE","");
            objOpeningRow.setValue("IND","");
            objOpeningRow.setValue("DISC","");
            objOpeningRow.setValue("BNKHUN","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("ADDRESS","");
            objOpeningRow.setValue("AMT","");
            objOpeningRow.setValue("BANK_NAME","");
            objOpeningRow.setValue("BANK_CITY","");
            objOpeningRow.setValue("LOCALBANK","");
            objOpeningRow.setValue("LOCADD2","");
            objOpeningRow.setValue("INST1","");
            objOpeningRow.setValue("PARTY_STATUS","");
                        
            
            //String strSQL = "";
         */   
          
            String strSQL="SELECT PARTY_STATUS,PARTY_CODE,LC_PARTY_NAME,EXP_DATE,LC_OPENER_CODE,OPENER_NAME,IND,DISC,BNKHUN,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1 FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER WHERE LC_OPENER_CODE = "+txtLcOpenerCode.getText().trim()+"";
           // String strSQL="SELECT PARTY_STATUS,PARTY_CODE,EXP_DATE,LC_OPENER_CODE,IND,DISC,BNKHUN,OPENER_NAME,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1 FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER WHERE LC_OPENER_CODE = "+txtLcOpenerCode.getText().trim()+"";
           ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();                    
                    Object[] rowData=new Object[17];
                    
                    //objRow=objReportData.newRow();
                    objRow.setValue("PARTY_STATUS",UtilFunctions.getString(rsTmp,"PARTY_STATUS",""));
                    rowData[0]=UtilFunctions.getString(rsTmp,"PARTY_STATUS","");
                    objRow.setValue("PARTY_CODE",UtilFunctions.getString(rsTmp,"PARTY_CODE",""));
                    rowData[1]=UtilFunctions.getString(rsTmp,"PARTY_CODE","");  
                    objRow.setValue("LC_PARTY_NAME",UtilFunctions.getString(rsTmp,"LC_PARTY_NAME",""));
                    rowData[2]=UtilFunctions.getString(rsTmp,"LC_PARTY_NAME","");
                    objRow.setValue("EXP_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"EXP_DATE","")));
                    rowData[3]=EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"EXP_DATE",""));
                    objRow.setValue("LC_OPENER_CODE",UtilFunctions.getString(rsTmp,"LC_OPENER_CODE",""));
                    rowData[4]=UtilFunctions.getString(rsTmp,"LC_OPENER_CODE","");
                    objRow.setValue("OPENER_NAME",UtilFunctions.getString(rsTmp,"OPENER_NAME",""));
                    rowData[5]=UtilFunctions.getString(rsTmp,"OPENER_NAME","");
                    objRow.setValue("IND",UtilFunctions.getString(rsTmp,"IND",""));
                    rowData[6]=UtilFunctions.getString(rsTmp,"IND","");
                    objRow.setValue("DISC",UtilFunctions.getString(rsTmp,"DISC",""));
                    rowData[7]=UtilFunctions.getString(rsTmp,"DISC","");
                    objRow.setValue("BNKHUN",UtilFunctions.getString(rsTmp,"BNKHUN",""));
                    rowData[8]=UtilFunctions.getString(rsTmp,"BNKHUN","");
                    objRow.setValue("ADDRESS",UtilFunctions.getString(rsTmp,"ADDRESS",""));
                    rowData[9]=UtilFunctions.getString(rsTmp,"ADDRESS","");
                    objRow.setValue("AMT",UtilFunctions.getString(rsTmp,"AMT",""));
                    rowData[10]=UtilFunctions.getString(rsTmp,"AMT","");
                    objRow.setValue("BANK_NAME",UtilFunctions.getString(rsTmp,"BANK_NAME",""));
                    rowData[11]=UtilFunctions.getString(rsTmp,"BANK_NAME","");
                    objRow.setValue("BANK_CITY",UtilFunctions.getString(rsTmp,"BANK_CITY",""));
                    rowData[12]=UtilFunctions.getString(rsTmp,"BANK_CITY","");
                    objRow.setValue("LOCALBANK",UtilFunctions.getString(rsTmp,"LOCALBANK",""));
                    rowData[13]=UtilFunctions.getString(rsTmp,"LOCALBANK","");
                    objRow.setValue("LOCADD2",UtilFunctions.getString(rsTmp,"LOCADD2",""));
                    rowData[14]=UtilFunctions.getString(rsTmp,"LOCADD2","");
                    objRow.setValue("INST1",UtilFunctions.getString(rsTmp,"INST1",""));
                    rowData[15]=UtilFunctions.getString(rsTmp,"INST1","");
                    
                    
                    
                    objReportData.AddRow(objRow);
                    DataModel.addRow(rowData);
                    rsTmp.next();
                    
                }
            }
            
   
            
          //  int Comp_ID = EITLERPGLOBAL.gCompanyID;
          //  HashMap Parameters=new HashMap();
           // Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
           // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
          //  Parameters.put("TO_DATE",txtToDate.getText().trim());
          // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
          // objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objData); 
            //objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objReportData);
          // objEngine.PreviewReport("http://200.0.0.227:8080/jmx-console/dinesh/EITLERP/Reports/Sales/rptLCD.rpt",Parameters,objData);
           
           }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
    
   
    private void formatGrid() {
        try {
           // objRow=objReportData.newRow();
            DataModel=new EITLTableModel();
            TResult.removeAll();
            TResult.setModel(DataModel);
            TResult.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
            
            DataModel.addColumn("Party Status");//0
            DataModel.addColumn("Party Code"); //1
            DataModel.addColumn("Party Name"); //2
            DataModel.addColumn("Exp Date");//3
            DataModel.addColumn("Lc Opener Code");//4
            DataModel.addColumn("Lc Opener Name");//5
            DataModel.addColumn("Ind");//6
            DataModel.addColumn("Disc"); //7
            DataModel.addColumn("Bank Hundi");//8
            DataModel.addColumn("Party Address");//9
            DataModel.addColumn("Lc Amount");//10
            DataModel.addColumn("Bank Name"); //11
            DataModel.addColumn("Bank Address");//12
            DataModel.addColumn("Local ADDRESS"); //13
            DataModel.addColumn("Local BANK");//14
            DataModel.addColumn("Special Instruction");//15
          
            
            RowFormat =new EITLTableCellRenderer();
            
            for(int j=0;j<TResult.getColumnCount();j++) {
                TResult.getColumnModel().getColumn(j).setCellRenderer(RowFormat);
            }
            
        }
        catch(Exception e) {
            
        }
                
    }
    
    private void AllLCReport() {
        try {
           
          
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            
            objReportData.AddColumn("LC_OPENER_CODE");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("PARTY_CODE");
            objReportData.AddColumn("LC_PARTY_NAME");
            objReportData.AddColumn("EXP_DATE");
            objReportData.AddColumn("IND");
            objReportData.AddColumn("DISC");
            objReportData.AddColumn("BNKHUN");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("ADDRESS");
            objReportData.AddColumn("AMT");
            objReportData.AddColumn("BANK_NAME");
            objReportData.AddColumn("BANK_CITY");
            objReportData.AddColumn("LOCALBANK");
            objReportData.AddColumn("LOCADD2");
            objReportData.AddColumn("INST1");
            objReportData.AddColumn("PARTY_STATUS");
            
            
          
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("LC_OPENER_CODE","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("PARTY_CODE","");
            objOpeningRow.setValue("LC_PARTY_NAME","");
            objOpeningRow.setValue("EXP_DATE","");
            objOpeningRow.setValue("IND","");
            objOpeningRow.setValue("DISC","");
            objOpeningRow.setValue("BNKHUN","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("ADDRESS","");
            objOpeningRow.setValue("AMT","");
            objOpeningRow.setValue("BANK_NAME","");
            objOpeningRow.setValue("BANK_CITY","");
            objOpeningRow.setValue("LOCALBANK","");
            objOpeningRow.setValue("LOCADD2","");
            objOpeningRow.setValue("INST1","");
            objOpeningRow.setValue("PARTY_STATUS","");
                        
            
            //String strSQL = "";
           
          
            String strSQL="SELECT LC_OPENER_CODE,OPENER_NAME,PARTY_CODE,LC_PARTY_NAME,EXP_DATE,IND,DISC,BNKHUN,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1,PARTY_STATUS FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER";
            
            System.out.println(strSQL);
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
          if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                   objRow=objReportData.newRow();
                    
                   objRow.setValue("PARTY_STATUS",UtilFunctions.getString(rsTmp,"PARTY_STATUS",""));
                   objRow.setValue("PARTY_CODE",UtilFunctions.getString(rsTmp,"PARTY_CODE",""));
                   objRow.setValue("LC_PARTY_NAME",UtilFunctions.getString(rsTmp,"LC_PARTY_NAME",""));
                   objRow.setValue("EXP_DATE",UtilFunctions.getString(rsTmp,"EXP_DATE",""));
                   objRow.setValue("LC_OPENER_CODE",UtilFunctions.getString(rsTmp,"LC_OPENER_CODE",""));
                   objRow.setValue("IND",UtilFunctions.getString(rsTmp,"IND",""));
                   objRow.setValue("DISC",UtilFunctions.getString(rsTmp,"DISC",""));
                   objRow.setValue("BNKHUN",UtilFunctions.getString(rsTmp,"BNKHUN",""));
                   objRow.setValue("OPENER_NAME",UtilFunctions.getString(rsTmp,"OPENER_NAME",""));
                   objRow.setValue("ADDRESS",UtilFunctions.getString(rsTmp,"ADDRESS",""));
                   objRow.setValue("AMT",UtilFunctions.getString(rsTmp,"AMT",""));
                   objRow.setValue("BANK_NAME",UtilFunctions.getString(rsTmp,"BANK_NAME",""));
                   objRow.setValue("BANK_CITY",UtilFunctions.getString(rsTmp,"BANK_CITY",""));
                   objRow.setValue("LOCALBANK",UtilFunctions.getString(rsTmp,"LOCALBANK",""));
                   objRow.setValue("LOCADD2",UtilFunctions.getString(rsTmp,"LOCADD2",""));
                   objRow.setValue("INST1",UtilFunctions.getString(rsTmp,"INST1",""));                     
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
               }
           }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
         //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
           // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            //Parameters.put("FROM_DATE",txtFromDate.getText().trim());
           // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
            objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
    
     private void GenerateReport1() {
        try {
           
          
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
            
            
            objReportData.AddColumn("LC_OPENER_CODE");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("PARTY_CODE");
            objReportData.AddColumn("LC_PARTY_NAME");
            objReportData.AddColumn("EXP_DATE");
            objReportData.AddColumn("IND");
            objReportData.AddColumn("DISC");
            objReportData.AddColumn("BNKHUN");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("ADDRESS");
            objReportData.AddColumn("AMT");
            objReportData.AddColumn("BANK_NAME");
            objReportData.AddColumn("BANK_CITY");
            objReportData.AddColumn("LOCALBANK");
            objReportData.AddColumn("LOCADD2");
            objReportData.AddColumn("INST1");
            objReportData.AddColumn("PARTY_STATUS");
            
            
          
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            
            objOpeningRow.setValue("LC_OPENER_CODE","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("PARTY_CODE","");
            objOpeningRow.setValue("LC_PARTY_NAME","");
            objOpeningRow.setValue("EXP_DATE","");
            objOpeningRow.setValue("IND","");
            objOpeningRow.setValue("DISC","");
            objOpeningRow.setValue("BNKHUN","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("ADDRESS","");
            objOpeningRow.setValue("AMT","");
            objOpeningRow.setValue("BANK_NAME","");
            objOpeningRow.setValue("BANK_CITY","");
            objOpeningRow.setValue("LOCALBANK","");
            objOpeningRow.setValue("LOCADD2","");
            objOpeningRow.setValue("INST1","");
            objOpeningRow.setValue("PARTY_STATUS","");
                        
            
            //String strSQL = "";
           
          
            String strSQL="SELECT LC_OPENER_CODE,OPENER_NAME,PARTY_CODE,LC_PARTY_NAME,EXP_DATE,IND,DISC,BNKHUN,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1,PARTY_STATUS FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER WHERE LC_OPENER_CODE = "+txtLcOpenerCode.getText().trim()+"";
            
            System.out.println(strSQL);
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
          if(rsTmp.getRow()>0) {
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                   objRow=objReportData.newRow();
                    
                   objRow.setValue("PARTY_STATUS",UtilFunctions.getString(rsTmp,"PARTY_STATUS",""));
                   objRow.setValue("PARTY_CODE",UtilFunctions.getString(rsTmp,"PARTY_CODE",""));
                   objRow.setValue("LC_PARTY_NAME",UtilFunctions.getString(rsTmp,"LC_PARTY_NAME",""));
                   objRow.setValue("EXP_DATE",UtilFunctions.getString(rsTmp,"EXP_DATE",""));
                   objRow.setValue("LC_OPENER_CODE",UtilFunctions.getString(rsTmp,"LC_OPENER_CODE",""));
                   objRow.setValue("IND",UtilFunctions.getString(rsTmp,"IND",""));
                   objRow.setValue("DISC",UtilFunctions.getString(rsTmp,"DISC",""));
                   objRow.setValue("BNKHUN",UtilFunctions.getString(rsTmp,"BNKHUN",""));
                   objRow.setValue("OPENER_NAME",UtilFunctions.getString(rsTmp,"OPENER_NAME",""));
                   objRow.setValue("ADDRESS",UtilFunctions.getString(rsTmp,"ADDRESS",""));
                   objRow.setValue("AMT",UtilFunctions.getString(rsTmp,"AMT",""));
                   objRow.setValue("BANK_NAME",UtilFunctions.getString(rsTmp,"BANK_NAME",""));
                   objRow.setValue("BANK_CITY",UtilFunctions.getString(rsTmp,"BANK_CITY",""));
                   objRow.setValue("LOCALBANK",UtilFunctions.getString(rsTmp,"LOCALBANK",""));
                   objRow.setValue("LOCADD2",UtilFunctions.getString(rsTmp,"LOCADD2",""));
                   objRow.setValue("INST1",UtilFunctions.getString(rsTmp,"INST1",""));                     
                    objReportData.AddRow(objRow);
                    
                    rsTmp.next();
               }
           }
            
            int Comp_ID = EITLERPGLOBAL.gCompanyID;
            HashMap Parameters=new HashMap();
         //   Parameters.put("CND_SUB_ACCOUNT_CODE",Integer.toString(Comp_ID));
           // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            //Parameters.put("FROM_DATE",txtFromDate.getText().trim());
           // Parameters.put("TO_DATE",txtToDate.getText().trim());
            Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
            
            objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objReportData);
            
            
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
    
     
      private void ShowAll() {
        try {
           
          
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
           /* 
            objReportData.AddColumn("LC_OPENER_CODE");
            objReportData.AddColumn("PARTY_CODE");
            objReportData.AddColumn("EXP_DATE");
            objReportData.AddColumn("IND");
            objReportData.AddColumn("DISC");
            objReportData.AddColumn("BNKHUN");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("ADDRESS");
            objReportData.AddColumn("AMT");
            objReportData.AddColumn("BANK_NAME");
            objReportData.AddColumn("BANK_CITY");
            objReportData.AddColumn("LOCALBANK");
            objReportData.AddColumn("LOCADD2");
            objReportData.AddColumn("INST1");
            objReportData.AddColumn("PARTY_STATUS");
            
            
          
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            objOpeningRow.setValue("LC_OPENER_CODE","");
            objOpeningRow.setValue("PARTY_CODE","");
            objOpeningRow.setValue("EXP_DATE","");
            objOpeningRow.setValue("IND","");
            objOpeningRow.setValue("DISC","");
            objOpeningRow.setValue("BNKHUN","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("ADDRESS","");
            objOpeningRow.setValue("AMT","");
            objOpeningRow.setValue("BANK_NAME","");
            objOpeningRow.setValue("BANK_CITY","");
            objOpeningRow.setValue("LOCALBANK","");
            objOpeningRow.setValue("LOCADD2","");
            objOpeningRow.setValue("INST1","");
            objOpeningRow.setValue("PARTY_STATUS","");
                        
            
            //String strSQL = "";
         */   
          
            String strSQL="SELECT PARTY_STATUS,PARTY_CODE,LC_PARTY_NAME,EXP_DATE,LC_OPENER_CODE,OPENER_NAME,IND,DISC,BNKHUN,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1 FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER";
           // String strSQL="SELECT PARTY_STATUS,PARTY_CODE,EXP_DATE,LC_OPENER_CODE,IND,DISC,BNKHUN,OPENER_NAME,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1 FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER WHERE LC_OPENER_CODE = "+txtLcOpenerCode.getText().trim()+"";
           ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();                    
                    Object[] rowData=new Object[17];
                    
                    //objRow=objReportData.newRow();
                    objRow.setValue("PARTY_STATUS",UtilFunctions.getString(rsTmp,"PARTY_STATUS",""));
                    rowData[0]=UtilFunctions.getString(rsTmp,"PARTY_STATUS","");
                    objRow.setValue("PARTY_CODE",UtilFunctions.getString(rsTmp,"PARTY_CODE",""));
                    rowData[1]=UtilFunctions.getString(rsTmp,"PARTY_CODE","");  
                    objRow.setValue("LC_PARTY_NAME",UtilFunctions.getString(rsTmp,"LC_PARTY_NAME",""));
                    rowData[2]=UtilFunctions.getString(rsTmp,"LC_PARTY_NAME","");
                    objRow.setValue("EXP_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"EXP_DATE","")));
                    rowData[3]=EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"EXP_DATE",""));
                    objRow.setValue("LC_OPENER_CODE",UtilFunctions.getString(rsTmp,"LC_OPENER_CODE",""));
                    rowData[4]=UtilFunctions.getString(rsTmp,"LC_OPENER_CODE","");
                    objRow.setValue("OPENER_NAME",UtilFunctions.getString(rsTmp,"OPENER_NAME",""));
                    rowData[5]=UtilFunctions.getString(rsTmp,"OPENER_NAME","");
                    objRow.setValue("IND",UtilFunctions.getString(rsTmp,"IND",""));
                    rowData[6]=UtilFunctions.getString(rsTmp,"IND","");
                    objRow.setValue("DISC",UtilFunctions.getString(rsTmp,"DISC",""));
                    rowData[7]=UtilFunctions.getString(rsTmp,"DISC","");
                    objRow.setValue("BNKHUN",UtilFunctions.getString(rsTmp,"BNKHUN",""));
                    rowData[8]=UtilFunctions.getString(rsTmp,"BNKHUN","");
                    objRow.setValue("ADDRESS",UtilFunctions.getString(rsTmp,"ADDRESS",""));
                    rowData[9]=UtilFunctions.getString(rsTmp,"ADDRESS","");
                    objRow.setValue("AMT",UtilFunctions.getString(rsTmp,"AMT",""));
                    rowData[10]=UtilFunctions.getString(rsTmp,"AMT","");
                    objRow.setValue("BANK_NAME",UtilFunctions.getString(rsTmp,"BANK_NAME",""));
                    rowData[11]=UtilFunctions.getString(rsTmp,"BANK_NAME","");
                    objRow.setValue("BANK_CITY",UtilFunctions.getString(rsTmp,"BANK_CITY",""));
                    rowData[12]=UtilFunctions.getString(rsTmp,"BANK_CITY","");
                    objRow.setValue("LOCALBANK",UtilFunctions.getString(rsTmp,"LOCALBANK",""));
                    rowData[13]=UtilFunctions.getString(rsTmp,"LOCALBANK","");
                    objRow.setValue("LOCADD2",UtilFunctions.getString(rsTmp,"LOCADD2",""));
                    rowData[14]=UtilFunctions.getString(rsTmp,"LOCADD2","");
                    objRow.setValue("INST1",UtilFunctions.getString(rsTmp,"INST1",""));
                    rowData[15]=UtilFunctions.getString(rsTmp,"INST1","");
                    
                    
                    
                    objReportData.AddRow(objRow);
                    DataModel.addRow(rowData);
                    rsTmp.next();
                    
                }
            }
            
   
            
          //  int Comp_ID = EITLERPGLOBAL.gCompanyID;
          //  HashMap Parameters=new HashMap();
           // Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
           // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
          //  Parameters.put("TO_DATE",txtToDate.getText().trim());
          // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
          // objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objData); 
            //objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objReportData);
          // objEngine.PreviewReport("http://200.0.0.227:8080/jmx-console/dinesh/EITLERP/Reports/Sales/rptLCD.rpt",Parameters,objData);
           
           }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
        private void NerestExpDate() {
        try {
           
          
            TReportWriter.SimpleDataProvider.TRow objRow;
            TReportWriter.SimpleDataProvider.TTable objReportData=new TReportWriter.SimpleDataProvider.TTable();
           /* 
            objReportData.AddColumn("LC_OPENER_CODE");
            objReportData.AddColumn("PARTY_CODE");
            objReportData.AddColumn("EXP_DATE");
            objReportData.AddColumn("IND");
            objReportData.AddColumn("DISC");
            objReportData.AddColumn("BNKHUN");
            objReportData.AddColumn("OPENER_NAME");
            objReportData.AddColumn("ADDRESS");
            objReportData.AddColumn("AMT");
            objReportData.AddColumn("BANK_NAME");
            objReportData.AddColumn("BANK_CITY");
            objReportData.AddColumn("LOCALBANK");
            objReportData.AddColumn("LOCADD2");
            objReportData.AddColumn("INST1");
            objReportData.AddColumn("PARTY_STATUS");
            
            
          
            TReportWriter.SimpleDataProvider.TRow objOpeningRow=objReportData.newRow();
            objOpeningRow.setValue("LC_OPENER_CODE","");
            objOpeningRow.setValue("PARTY_CODE","");
            objOpeningRow.setValue("EXP_DATE","");
            objOpeningRow.setValue("IND","");
            objOpeningRow.setValue("DISC","");
            objOpeningRow.setValue("BNKHUN","");
            objOpeningRow.setValue("OPENER_NAME","");
            objOpeningRow.setValue("ADDRESS","");
            objOpeningRow.setValue("AMT","");
            objOpeningRow.setValue("BANK_NAME","");
            objOpeningRow.setValue("BANK_CITY","");
            objOpeningRow.setValue("LOCALBANK","");
            objOpeningRow.setValue("LOCADD2","");
            objOpeningRow.setValue("INST1","");
            objOpeningRow.setValue("PARTY_STATUS","");
                        
            
            //String strSQL = "";
         */   
          
            //String strSQL="SELECT PARTY_STATUS,PARTY_CODE,LC_PARTY_NAME,EXP_DATE,LC_OPENER_CODE,OPENER_NAME,IND,DISC,BNKHUN,ADDRESS,AMT,BANK_NAME,BANK_CITY,LOCALBANK,LOCADD2,INST1 FROM DINESHMILLS.D_SAL_POLICY_LC_MASTER WHERE LC_OPENER_CODE = "+txtLcOpenerCode.getText().trim()+"";
           String strSQL="SELECT * FROM D_SAL_POLICY_LC_MASTER WHERE EXP_DATE>=NOW() AND EXP_DATE<=DATE_ADD(NOW(), INTERVAL 90 DAY) ORDER BY EXP_DATE,LC_OPENER_CODE";
           
            
            ResultSet rsTmp=data.getResult(strSQL);
            rsTmp.first();
            
            int Counter = 0;
            
            if(rsTmp.getRow()>0) {
                
                while(!rsTmp.isAfterLast()) {
                    Counter ++;
                    objRow=objReportData.newRow();                    
                    Object[] rowData=new Object[17];
                    
                    //objRow=objReportData.newRow();
                    objRow.setValue("PARTY_STATUS",UtilFunctions.getString(rsTmp,"PARTY_STATUS",""));
                    rowData[0]=UtilFunctions.getString(rsTmp,"PARTY_STATUS","");
                    objRow.setValue("PARTY_CODE",UtilFunctions.getString(rsTmp,"PARTY_CODE",""));
                    rowData[1]=UtilFunctions.getString(rsTmp,"PARTY_CODE","");  
                    objRow.setValue("LC_PARTY_NAME",UtilFunctions.getString(rsTmp,"LC_PARTY_NAME",""));
                    rowData[2]=UtilFunctions.getString(rsTmp,"LC_PARTY_NAME","");
                    objRow.setValue("EXP_DATE",EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"EXP_DATE","")));
                    rowData[3]=EITLERPGLOBAL.formatDate(UtilFunctions.getString(rsTmp,"EXP_DATE",""));
                    objRow.setValue("LC_OPENER_CODE",UtilFunctions.getString(rsTmp,"LC_OPENER_CODE",""));
                    rowData[4]=UtilFunctions.getString(rsTmp,"LC_OPENER_CODE","");
                    objRow.setValue("OPENER_NAME",UtilFunctions.getString(rsTmp,"OPENER_NAME",""));
                    rowData[5]=UtilFunctions.getString(rsTmp,"OPENER_NAME","");
                    objRow.setValue("IND",UtilFunctions.getString(rsTmp,"IND",""));
                    rowData[6]=UtilFunctions.getString(rsTmp,"IND","");
                    objRow.setValue("DISC",UtilFunctions.getString(rsTmp,"DISC",""));
                    rowData[7]=UtilFunctions.getString(rsTmp,"DISC","");
                    objRow.setValue("BNKHUN",UtilFunctions.getString(rsTmp,"BNKHUN",""));
                    rowData[8]=UtilFunctions.getString(rsTmp,"BNKHUN","");
                    objRow.setValue("ADDRESS",UtilFunctions.getString(rsTmp,"ADDRESS",""));
                    rowData[9]=UtilFunctions.getString(rsTmp,"ADDRESS","");
                    objRow.setValue("AMT",UtilFunctions.getString(rsTmp,"AMT",""));
                    rowData[10]=UtilFunctions.getString(rsTmp,"AMT","");
                    objRow.setValue("BANK_NAME",UtilFunctions.getString(rsTmp,"BANK_NAME",""));
                    rowData[11]=UtilFunctions.getString(rsTmp,"BANK_NAME","");
                    objRow.setValue("BANK_CITY",UtilFunctions.getString(rsTmp,"BANK_CITY",""));
                    rowData[12]=UtilFunctions.getString(rsTmp,"BANK_CITY","");
                    objRow.setValue("LOCALBANK",UtilFunctions.getString(rsTmp,"LOCALBANK",""));
                    rowData[13]=UtilFunctions.getString(rsTmp,"LOCALBANK","");
                    objRow.setValue("LOCADD2",UtilFunctions.getString(rsTmp,"LOCADD2",""));
                    rowData[14]=UtilFunctions.getString(rsTmp,"LOCADD2","");
                    objRow.setValue("INST1",UtilFunctions.getString(rsTmp,"INST1",""));
                    rowData[15]=UtilFunctions.getString(rsTmp,"INST1","");
                    
                    
                    
                    objReportData.AddRow(objRow);
                    DataModel.addRow(rowData);
                    rsTmp.next();
                    
                }
            }
            
   
            
          //  int Comp_ID = EITLERPGLOBAL.gCompanyID;
          //  HashMap Parameters=new HashMap();
           // Parameters.put("COMPANY_ID",Integer.toString(Comp_ID));
           // Parameters.put("FROM_DATE",txtFromDate.getText().trim());
          //  Parameters.put("TO_DATE",txtToDate.getText().trim());
          // Parameters.put("SYS_DATE",EITLERPGLOBAL.getCurrentDate());
            
          // objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objData); 
            //objEngine.PreviewReport("http://"+EITLERPGLOBAL.HostIP+"/EITLERP/Reports/rptLCD.rpt",Parameters,objReportData);
          // objEngine.PreviewReport("http://200.0.0.227:8080/jmx-console/dinesh/EITLERP/Reports/Sales/rptLCD.rpt",Parameters,objData);
           
           }
        catch(Exception e) {
            e.printStackTrace();
        }
        
    }
}